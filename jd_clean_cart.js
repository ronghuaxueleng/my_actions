/*
清空购物车

jd_clean_cart_pin  // 清空定义PIN账号，多个用 & 隔开,不填清空全部账号

cron "1 1 1 1 *" script-path=jd_clean_cart.js, tag=清空购物车

 */
const $ = new Env('清空购物车');
var iｉl='jsjiami.com.v7';const Il1i1I=iii1II;(function(il1lI,IliIIl,I1il1l,lI1l1l,IIliII,iiliI,Ill11I){return il1lI=il1lI>>0x1,iiliI='hs',Ill11I='hs',function(I1il1i,IliIIi,lI1l1i,i1iil,llI11l){const l1l1ii=iii1II;i1iil='tfi',iiliI=i1iil+iiliI,llI11l='up',Ill11I+=llI11l,iiliI=lI1l1i(iiliI),Ill11I=lI1l1i(Ill11I),lI1l1i=0x0;const I1llIl=I1il1i();while(!![]&&--lI1l1l+IliIIi){try{i1iil=parseInt(l1l1ii(0xfa,')3af'))/0x1+parseInt(l1l1ii(0x1d9,'syR!'))/0x2*(-parseInt(l1l1ii(0xff,'2gx1'))/0x3)+parseInt(l1l1ii(0x16f,'n!E)'))/0x4+parseInt(l1l1ii(0x1e4,'RTkJ'))/0x5*(parseInt(l1l1ii(0x194,'aj$L'))/0x6)+parseInt(l1l1ii(0x1db,'jB(2'))/0x7+-parseInt(l1l1ii(0x1e3,'3%Oq'))/0x8+-parseInt(l1l1ii(0x1c3,'[L5K'))/0x9;}catch(i1iii){i1iil=lI1l1i;}finally{llI11l=I1llIl[iiliI]();if(il1lI<=lI1l1l)lI1l1i?IIliII?i1iil=llI11l:IIliII=llI11l:lI1l1i=llI11l;else{if(lI1l1i==IIliII['replace'](/[thIDJulMwSkgWdCfKbP=]/g,'')){if(i1iil===IliIIi){I1llIl['un'+iiliI](llI11l);break;}I1llIl[Ill11I](llI11l);}}}}}(I1il1l,IliIIl,function(I1llIi,IIii1I,llI11i,i1iIi1,l1l1il,I11i1I,iliIi1){return IIii1I='\x73\x70\x6c\x69\x74',I1llIi=arguments[0x0],I1llIi=I1llIi[IIii1I](''),llI11i=`\x72\x65\x76\x65\x72\x73\x65`,I1llIi=I1llIi[llI11i]('\x76'),i1iIi1=`\x6a\x6f\x69\x6e`,(0x159f83,I1llIi[i1iIi1](''));});}(0x17e,0xebdf4,Iii11l,0xc1),Iii11l)&&(iｉl=`\x0ae`);function iii1II(_0x331898,_0x43bb9c){const _0x2d9717=Iii11l();return iii1II=function(_0x21bcc6,_0x38f08f){_0x21bcc6=_0x21bcc6-0xbe;let _0x281376=_0x2d9717[_0x21bcc6];if(iii1II['vOTsHc']===undefined){var _0x1ff540=function(_0xa0fb05){const _0x45793e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x141c3d='',_0x2db2d9='';for(let _0x284207=0x0,_0x1d37e6,_0x4b22e4,_0xf97962=0x0;_0x4b22e4=_0xa0fb05['charAt'](_0xf97962++);~_0x4b22e4&&(_0x1d37e6=_0x284207%0x4?_0x1d37e6*0x40+_0x4b22e4:_0x4b22e4,_0x284207++%0x4)?_0x141c3d+=String['fromCharCode'](0xff&_0x1d37e6>>(-0x2*_0x284207&0x6)):0x0){_0x4b22e4=_0x45793e['indexOf'](_0x4b22e4);}for(let _0x4bd971=0x0,_0x1e0f52=_0x141c3d['length'];_0x4bd971<_0x1e0f52;_0x4bd971++){_0x2db2d9+='%'+('00'+_0x141c3d['charCodeAt'](_0x4bd971)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2db2d9);};const _0x340de=function(_0x5c2ca9,_0x164496){let _0x78b98d=[],_0x363a95=0x0,_0x58cf62,_0x2786e0='';_0x5c2ca9=_0x1ff540(_0x5c2ca9);let _0x398df4;for(_0x398df4=0x0;_0x398df4<0x100;_0x398df4++){_0x78b98d[_0x398df4]=_0x398df4;}for(_0x398df4=0x0;_0x398df4<0x100;_0x398df4++){_0x363a95=(_0x363a95+_0x78b98d[_0x398df4]+_0x164496['charCodeAt'](_0x398df4%_0x164496['length']))%0x100,_0x58cf62=_0x78b98d[_0x398df4],_0x78b98d[_0x398df4]=_0x78b98d[_0x363a95],_0x78b98d[_0x363a95]=_0x58cf62;}_0x398df4=0x0,_0x363a95=0x0;for(let _0x2753db=0x0;_0x2753db<_0x5c2ca9['length'];_0x2753db++){_0x398df4=(_0x398df4+0x1)%0x100,_0x363a95=(_0x363a95+_0x78b98d[_0x398df4])%0x100,_0x58cf62=_0x78b98d[_0x398df4],_0x78b98d[_0x398df4]=_0x78b98d[_0x363a95],_0x78b98d[_0x363a95]=_0x58cf62,_0x2786e0+=String['fromCharCode'](_0x5c2ca9['charCodeAt'](_0x2753db)^_0x78b98d[(_0x78b98d[_0x398df4]+_0x78b98d[_0x363a95])%0x100]);}return _0x2786e0;};iii1II['hQixaM']=_0x340de,_0x331898=arguments,iii1II['vOTsHc']=!![];}const _0x2dcb85=_0x2d9717[0x0],_0x3bea55=_0x21bcc6+_0x2dcb85,_0x2f4b21=_0x331898[_0x3bea55];return!_0x2f4b21?(iii1II['mexEzK']===undefined&&(iii1II['mexEzK']=!![]),_0x281376=iii1II['hQixaM'](_0x281376,_0x38f08f),_0x331898[_0x3bea55]=_0x281376):_0x281376=_0x2f4b21,_0x281376;},iii1II(_0x331898,_0x43bb9c);}const jdCookie=require('./jdCookie'),notify=require('./utils/Rebels_sendJDNotify'),common=require(Il1i1I(0x14c,'zQOq')),NoPinArr=process[Il1i1I(0x155,'x^TD')][Il1i1I(0x1df,'x)5e')]?process[Il1i1I(0x1ec,'GFC2')][Il1i1I(0x1b2,'swC0')]['split']('&'):'',isNotify=![];console[Il1i1I(0x199,'jB(2')](''),console['log']('=========='+$[Il1i1I(0x107,'zQOq')]+Il1i1I(0xcd,'et2F')),console[Il1i1I(0x12d,'B]5z')](Il1i1I(0x1cd,'3%Oq')),console[Il1i1I(0x18c,'u36i')](Il1i1I(0xce,'TPnb')+$['name']+'提示结束=========='),console[Il1i1I(0x164,'M2YM')]('');let cookie='';const cookiesArr=Object['keys'](jdCookie)[Il1i1I(0x1b8,'7!MS')](Ill1l=>jdCookie[Ill1l])[Il1i1I(0xd6,')3af')](llI1Il=>llI1Il);!cookiesArr[0x0]&&($['msg']($[Il1i1I(0x143,'GFC2')],Il1i1I(0xe9,'gzNR')),process['exit'](0x1));!(async()=>{const Ii1iii=Il1i1I,ii1iii={'iJvLH':function(Ill1i,ii1iil){return Ill1i<ii1iil;},'NKMXq':function(lllI1l,i11iii){return lllI1l===i11iii;},'AcgxZ':Ii1iii(0xd1,'3%Oq'),'iduYp':Ii1iii(0x175,'7pBv'),'hezSz':'pt_pin','ZfeCG':function(llI1Ii,lllI1i){return llI1Ii!==lllI1i;},'nDacQ':Ii1iii(0xf4,'T5$m'),'fHhTq':'KiQFw','AwmSt':Ii1iii(0x1d3,')^^Q'),'xDmrW':function(li1i1l){return li1i1l();}};notify[Ii1iii(0xd7,'cT9n')]({'title':$[Ii1iii(0x139,'^PCF')]});for(let II1i1=0x0;ii1iii['iJvLH'](II1i1,cookiesArr['length']);II1i1++){if(ii1iii['NKMXq'](ii1iii['AcgxZ'],ii1iii['iduYp']))iii1Il(lI1IiI[Ii1iii(0x10c,'T5$m')][Ii1iii(0x16a,'J(!6')]);else{$[Ii1iii(0xd2,'zHKi')]=II1i1+0x1,cookie=cookiesArr[II1i1],common[Ii1iii(0xec,'#3VK')](cookie),$[Ii1iii(0x1dc,'x^TD')]=decodeURIComponent(common[Ii1iii(0x12a,'zQOq')](cookie,ii1iii['hezSz'])),$['UA']=common[Ii1iii(0x152,'$O0K')]($[Ii1iii(0xe8,'z1Ug')]),$['UUID']=common[Ii1iii(0x18d,'^PCF')](Ii1iii(0x1b7,'GFC2')),$['message']=notify[Ii1iii(0xfb,'L*PQ')]($['index'],$['UserName']),$['nickName']='';if(NoPinArr){if(ii1iii['ZfeCG'](ii1iii[Ii1iii(0x13f,'5Gvl')],ii1iii[Ii1iii(0x119,'J(!6')])){if(NoPinArr['includes'](encodeURIComponent($['UserName']))){if(ii1iii[Ii1iii(0xd8,'UZ]Q')]!==ii1iii[Ii1iii(0x187,'T5$m')])ll1({'err':iI1llI,'res':llliii,'data':IllI11});else{console[Ii1iii(0xe2,'^PCF')](Ii1iii(0x1e9,'syR!')+$[Ii1iii(0x104,'z7QD')]+'】'+($[Ii1iii(0xf8,'x)5e')]||$['UserName'])+Ii1iii(0x178,'et2F')),await ii1iii[Ii1iii(0x15f,'cT9n')](Main),common['unsetCookie']();if($[Ii1iii(0xe7,'zvbs')])break;await $[Ii1iii(0x165,'TPnb')](0x3e8);}}else continue;}else{i1l1l1['log'](Ii1iii(0x1c7,'nEWl')),IlI1I[Ii1iii(0x168,'UZ]Q')][Ii1iii(0x1bd,'jB(2')]('空购物车');return;}}else{console[Ii1iii(0x131,'syR!')](Ii1iii(0x10f,'7!MS')+$[Ii1iii(0x170,'7pBv')]+'】'+($['nickName']||$[Ii1iii(0x1d4,'L*PQ')])+Ii1iii(0x18b,'J(!6')),await Main(),common['unsetCookie']();if($[Ii1iii(0x1ea,'#pKr')])break;await $['wait'](0x3e8);}}}const i11iil=notify[Ii1iii(0x13a,'Q3Cd')]();i11iil&&(console[Ii1iii(0x1c9,'#pKr')]('\x0a📣\x20运行结果\x0a'+i11iil[Ii1iii(0x1ee,'swC0')](/：/g,Ii1iii(0x120,'UZ]Q'))),isNotify&&await notify[Ii1iii(0x129,'#3VK')]());})()[Il1i1I(0x157,'x^TD')](iiiliI=>$[Il1i1I(0x1c8,'z7QD')](iiiliI))['finally'](()=>$[Il1i1I(0x10d,'[L5K')]());async function Main(){const iIIilI=Il1i1I,li1i1I={'gTyyB':function(ii1il1,lI1llI){return ii1il1(lI1llI);},'FhayZ':function(illIil,Ill1I){return illIil===Ill1I;},'SAHDv':iIIilI(0x1ed,'!DpZ'),'jWXmh':iIIilI(0xe0,'aj$L'),'pjneE':function(i11iiI,lIli11){return i11iiI>lIli11;},'saFdu':iIIilI(0xfd,'aj$L'),'CVZQP':iIIilI(0x150,']]Sn'),'fFeLE':'空购物车','DITbO':'TStJE'},illIii=await common[iIIilI(0xcc,'aTZp')](cookie);if(!illIii&&li1i1I[iIIilI(0xc5,'RTkJ')](typeof illIii,li1i1I[iIIilI(0xe1,'#3VK')])){if(li1i1I[iIIilI(0xf3,'TPnb')](iIIilI(0x145,'IH]6'),li1i1I[iIIilI(0x173,'$O0K')])){console['log'](iIIilI(0x188,'UZ]Q'));return;}else Ii1iII[iIIilI(0xef,'7!MS')]('❓'+l1i11I+'\x20'+II11II['stringify'](Ii1iI1));}try{$['TheSkus']=[],await sendRequest(iIIilI(0x184,'$O0K'));if(li1i1I[iIIilI(0x14a,'u36i')]($['TheSkus']['length'],0x0))console[iIIilI(0x19d,'Xd5D')](iIIilI(0x1b5,'nEWl')+$[iIIilI(0xc3,'B]5z')][iIIilI(0x1dd,'!DpZ')]+iIIilI(0xdb,'jB(2')),$['message'][iIIilI(0x15d,']]Sn')](iIIilI(0x12f,'#3VK')+$[iIIilI(0x182,'iLUd')][iIIilI(0x183,')3af')]+iIIilI(0xf7,'z1Ug')),await li1i1I[iIIilI(0x1b0,'#pKr')](sendRequest,'cartRemove');else{if(li1i1I[iIIilI(0x1e0,'nEWl')]('ZEYZr',li1i1I[iIIilI(0xdc,'jB(2')])){console[iIIilI(0x14b,'zHKi')](li1i1I[iIIilI(0x19b,')^^Q')]),$[iIIilI(0x161,'RTkJ')][iIIilI(0xdf,'u36i')](li1i1I[iIIilI(0x180,'UTKJ')]);return;}else{const IlIlii={'xTiNG':function(i1l1i1,liil11){const il1l1=iIIilI;return li1i1I[il1l1(0x140,'cT9n')](i1l1i1,liil11);}};IiIi[iIIilI(0x1b6,'7SGh')](iI1ll1,(iiillI,l1l111,l1iIII)=>{const Ii1iil=iIIilI;IlIlii[Ii1iil(0x1e8,'2gx1')](l1il1l,{'err':iiillI,'res':l1l111,'data':l1iIII});});}}}catch(llI1I1){if(li1i1I[iIIilI(0x133,'nEWl')]!==li1i1I[iIIilI(0x105,'et2F')]){const lIli1I={'MTaJy':function(II1il,lllI11){return li1i1I['gTyyB'](II1il,lllI11);}};return new IiII(async I1lIll=>{illIlI['post'](liIiI,(I1lIli,II1ii,IIIIII)=>{const Ilil1i=iii1II;lIli1I[Ilil1i(0xc8,'M2YM')](I1lIll,{'err':I1lIli,'res':II1ii,'data':IIIIII});});});}else console['log'](iIIilI(0x1d1,'5Gvl')+llI1I1);}}function traverseItems(lillII){const iili1=Il1i1I,ii1ilI={'HSMKT':function(lI1ll1,iIiI1){return lI1ll1===iIiI1;},'pmRVl':iili1(0x17b,'et2F'),'ufcAb':iili1(0x1a2,'zvbs'),'teLwv':'luxQl','iCENI':function(liil1I,i11ii1){return liil1I>i11ii1;}};for(const IlIliI of lillII){if(ii1ilI['HSMKT'](ii1ilI[iili1(0x1d8,'M2YM')],ii1ilI[iili1(0x11f,'[L5K')]))Iii11I[iili1(0x199,'jB(2')](iili1(0xe5,'nEWl')+Iil1II+'\x20请求响应\x20'+(iIIl1I[iili1(0x149,'jB(2')]||I1iIli));else{if(IlIliI[iili1(0x144,'zHKi')]===0x1){if(IlIliI?.[iili1(0x100,'^PCF')]?.[iili1(0xf2,'L*PQ')]&&IlIliI?.[iili1(0xbe,'7pBv')]?.[iili1(0x1ce,'M2YM')]&&IlIliI?.[iili1(0x126,'et2F')]?.['Id']){if('dLHno'!==ii1ilI['teLwv'])$[iili1(0x190,'z1Ug')][iili1(0xc0,'syR!')]({'num':IlIliI[iili1(0x1a6,'RTkJ')]['Num'],'skuUuid':IlIliI['item'][iili1(0x1c4,'TPnb')],'useUuid':![],'Id':IlIliI[iili1(0x109,'z7QD')]['Id']});else{const lIli1i={'BJrdB':function(IIIII1,I1lIlI){return IIIII1(I1lIlI);}};return new IllI1i(async ii1ill=>{const II11ii=iili1;IllI1l[II11ii(0xdd,'nEWl')](i11I1i,(II1iI,llI1II,lIli1l)=>{const Iil1iI=II11ii;lIli1i[Iil1iI(0xea,'cT9n')](ii1ill,{'err':II1iI,'res':llI1II,'data':lIli1l});});});}}}else{if(ii1ilI[iili1(0x1ca,'n!E)')](IlIliI[iili1(0x123,'UZ]Q')],0x4))continue;else IlIliI?.[iili1(0x135,'syR!')]?.[iili1(0x172,'aTZp')]&&IlIliI?.['item']?.[iili1(0x17f,'#pKr')]?.[iili1(0x17e,']]Sn')]&&ii1ilI[iili1(0xc7,'z1Ug')](IlIliI?.['item']?.['items']?.['length'],0x0)&&traverseItems(IlIliI['item'][iili1(0xfc,'GFC2')]);}}}}async function handleResponse(lillIi,illIi1){const II11il=Il1i1I,ii1ili={'hZgeP':II11il(0x1da,'z1Ug'),'JDLTp':'清空购物车成功','BPXig':function(liil1i,lI1lil){return liil1i(lI1lil);},'iovKU':function(i1l1iI,liil1l){return i1l1iI===liil1l;},'KtNbY':function(lI1lii,Iiili1){return lI1lii>Iiili1;},'ZnfXx':function(Iil1l1,i1i11I){return Iil1l1!==i1i11I;},'unnQM':II11il(0x1ab,'2gx1'),'tZXXA':'DqrIj','ElGNw':function(il1iIl,iii1ii){return il1iIl===iii1ii;},'oCMTt':II11il(0x1c1,'7pBv'),'oXxlk':II11il(0x198,'!DpZ')};try{switch(lillIi){case'cartCheckAll':if(ii1ili['iovKU'](illIi1[II11il(0x124,'zvbs')],'0')){if(illIi1?.[II11il(0x1d5,'2gx1')]?.['vendors']&&ii1ili['KtNbY'](illIi1?.['cartInfo']?.[II11il(0x137,'7pBv')]?.[II11il(0x1d6,'2gx1')],0x0))for(const il1iIi of illIi1[II11il(0x156,'^PCF')][II11il(0x1cf,'$O0K')]){ii1ili[II11il(0x1a1,'syR!')](II11il(0x192,'Q3Cd'),ii1ili['unnQM'])?(Iliill['log'](ii1ili['hZgeP']),IIII11[II11il(0x12c,'#pKr')]['insert'](ii1ili[II11il(0x1e2,'et2F')])):traverseItems(il1iIi[II11il(0x12e,'mH!e')]);}}else{if(illIi1?.['msg']){if(ii1ili[II11il(0x159,')^^Q')](ii1ili[II11il(0x162,'t9c#')],ii1ili[II11il(0x1b1,'RTkJ')]))IlI1iI=Iillil+'\x20请求失败（Response\x20code\x20'+l1lIli+'）';else{console[II11il(0x113,'gzNR')](illIi1[II11il(0x166,')^^Q')]),$[II11il(0x112,']]Sn')][II11il(0x1a4,'et2F')](illIi1['msg']);return;}}else console['log']('❓'+lillIi+'\x20'+JSON[II11il(0x1a5,'B]5z')](illIi1));}break;case'cartRemove':if(illIi1['code']==='0'){if(ii1ili[II11il(0x19f,'UTKJ')](ii1ili[II11il(0xed,'aTZp')],ii1ili[II11il(0x1a8,'Q3Cd')]))console[II11il(0x13d,'IH]6')](ii1ili[II11il(0xfe,'UZ]Q')]),$['message']['insert'](ii1ili[II11il(0x132,'z7QD')]);else for(const iIIiiI of ill111[II11il(0x130,'x)5e')][II11il(0x102,'GFC2')]){ii1ili[II11il(0xcf,'n!E)')](i1III,iIIiiI[II11il(0x141,'Q3Cd')]);}}else console[II11il(0xeb,'UTKJ')](ii1ili['oXxlk']),$['message']['insert'](II11il(0x17c,'x)5e'));break;}}catch(liiI1i){console[II11il(0x110,'n!E)')](II11il(0x1a3,'iLUd')+lillIi+II11il(0x13b,'UTKJ')+(liiI1i[II11il(0x16b,'nEWl')]||liiI1i));}}async function sendRequest(ililIi){const iIIil1=Il1i1I,lilIIl={'IMLsI':'❌\x20清空购物车失败','IVZVG':'清空购物车失败','HxpgW':iIIil1(0x103,'$O0K'),'jPfEj':function(i1i11i,II11l1){return i1i11i(II11l1);},'Jmoal':iIIil1(0xf6,'aj$L'),'tJoAg':'39.786221','EruwN':'049717','MWlxj':iIIil1(0xee,'syR!'),'HsDGM':iIIil1(0x19a,'u36i'),'nsSEb':iIIil1(0x1d0,'[L5K'),'pqXOo':iIIil1(0x1b3,'zvbs'),'evCcT':'application/json,\x20text/plain,\x20*/*','Wccnu':'gzip,\x20deflate,\x20br','jpFix':iIIil1(0x171,'UZ]Q'),'NKwTC':iIIil1(0x1de,'aTZp'),'LXTiW':iIIil1(0x125,'[L5K'),'jYePH':iIIil1(0x101,'z1Ug'),'MOvBg':'cors','yPzed':iIIil1(0x1d2,'7SGh'),'BnQcZ':function(Iil1lI,IiiliI){return Iil1lI===IiiliI;},'odtio':iIIil1(0x16d,'jB(2'),'YAnuI':function(iii1iI,llIll){return iii1iI<llIll;},'QTKRh':function(il1iII,iilli){return il1iII>iilli;},'TDEkK':function(IlllIl,II11lI,lI1IIi){return IlllIl(II11lI,lI1IIi);},'DGJHp':function(I1l11I,Ilil1l){return I1l11I===Ilil1l;},'LjQYE':iIIil1(0x1aa,'zHKi'),'OwBff':function(iIIiii,iilll){return iIIiii===iilll;},'DHsJg':'cwsdY','guEyR':iIIil1(0xf0,'RTkJ'),'pGPwa':function(il1iI1,IlllIi){return il1iI1===IlllIi;},'AGbbt':iIIil1(0x127,'2gx1'),'BnhqY':iIIil1(0x158,'$O0K'),'NOtnb':function(iIIiil,i1l1Ii){return iIIiil||i1l1Ii;},'rUCfs':function(I1iIIi,I1iIIl){return I1iIIi!==I1iIIl;},'PWDpA':iIIil1(0x19e,'zQOq'),'UeXUU':iIIil1(0x179,')3af'),'nXoBi':function(lI1IIl,i1ilI,iii1lI){return lI1IIl(i1ilI,iii1lI);},'xzZoO':function(i1ilI1,Iiilii){return i1ilI1>=Iiilii;},'dlSxA':function(Iil1li,Iiilil){return Iil1li===Iiilil;},'iCvHX':'CiaGR'};if($['runEnd']||$[iIIil1(0x118,'mH!e')])return;let ililIl='',liiI1l='',i1l1II=iIIil1(0x14d,'iLUd'),i1ill={};switch(ililIi){case lilIIl['Jmoal']:ililIl=iIIil1(0x1ef,'TPnb'),i1ill={'euCountry':![],'tabMenuValue':'','cartuuid':$[iIIil1(0xbf,'Xd5D')],'filterTag':iIIil1(0x114,'u36i'),'latitude':lilIIl[iIIil1(0x1ae,'t9c#')],'userType':'1','noResponse':![],'operations':[{'carttype':'7'}],'updateTag':![],'hasSearchParam':![],'openudid':$['UUID'],'cvhv':lilIIl[iIIil1(0x13e,'3%Oq')],'longitude':lilIIl[iIIil1(0xca,'nEWl')],'homeWishListUserFlag':'3','addressId':lilIIl['HsDGM'],'hitNewUIStatus':'1','syntype':'1','configVersion':lilIIl[iIIil1(0xda,'x)5e')],'degradation':0x0,'page':0x1,'adid':''},liiI1l=await common[iIIil1(0x1bf,'J(!6')](lilIIl['Jmoal'],i1ill);break;case lilIIl[iIIil1(0xd0,'aTZp')]:ililIl='https://api.m.jd.com/client.action?functionId=cartRemove',i1ill={'euCountry':![],'tabMenuValue':'','cartuuid':$['UUID'],'filterTag':iIIil1(0xd4,'swC0'),'latitude':lilIIl[iIIil1(0x16e,'2gx1')],'userType':'1','noResponse':![],'operations':[{'TheSkus':$[iIIil1(0x111,'swC0')]}],'updateTag':![],'hasSearchParam':![],'openudid':$['UUID'],'cvhv':lilIIl[iIIil1(0x1cc,'7!MS')],'longitude':iIIil1(0x121,'!DpZ'),'homeWishListUserFlag':'3','addressId':lilIIl[iIIil1(0x1ba,'z7QD')],'hitNewUIStatus':'1','syntype':'1','configVersion':lilIIl['nsSEb'],'degradation':0x0,'page':0x1,'adid':''},liiI1l=await common['getSign']('cartRemove',i1ill);break;default:console['log'](iIIil1(0xcb,'RTkJ')+ililIi);return;}const I1l11l={'url':ililIl,'headers':{'Accept':lilIIl['evCcT'],'Accept-Encoding':lilIIl[iIIil1(0x169,'mH!e')],'Accept-Language':lilIIl[iIIil1(0x1af,'2gx1')],'Connection':iIIil1(0x10e,'swC0'),'Content-Type':lilIIl[iIIil1(0xe3,'RTkJ')],'Cookie':cookie,'Host':lilIIl[iIIil1(0x160,'u36i')],'Origin':iIIil1(0xc9,'7SGh'),'Sec-Fetch-Dest':lilIIl['jYePH'],'Sec-Fetch-Mode':lilIIl[iIIil1(0x1b9,'x)5e')],'Sec-Fetch-Site':lilIIl[iIIil1(0x1a0,'gzNR')],'User-Agent':$['UA'],'x-referer-package':'com.360buy.jdmobile'},'body':liiI1l,'timeout':0x7530};lilIIl['BnQcZ'](i1l1II,lilIIl[iIIil1(0x1cb,'cT9n')])&&(delete I1l11l[iIIil1(0x1ac,'UTKJ')],delete I1l11l[iIIil1(0x191,'aTZp')][lilIIl[iIIil1(0x1a7,'$O0K')]]);const lilIIi=0x1;let i1l1Il=0x0,llIli=null,i1i11l=![];while(lilIIl['YAnuI'](i1l1Il,lilIIi)){lilIIl[iIIil1(0x1a9,'et2F')](i1l1Il,0x0)&&await $[iIIil1(0x19c,'Xd5D')](0x3e8);const {err:Iil1ll,res:iillI,data:lI1III}=await lilIIl[iIIil1(0x185,'nEWl')](handleRequest,I1l11l,i1l1II);if(Iil1ll){if(lilIIl[iIIil1(0x174,'Q3Cd')](typeof Iil1ll,lilIIl[iIIil1(0x15c,'T5$m')])&&Iil1ll[iIIil1(0x11a,'^PCF')](iIIil1(0xd5,'syR!')))llIli=ililIi+'\x20请求超时，请检查网络重试';else{if(lilIIl[iIIil1(0x195,'3%Oq')](lilIIl[iIIil1(0x106,'nEWl')],lilIIl[iIIil1(0xd9,'B]5z')])){const IIliIi=iillI?.[iIIil1(0x18a,'mH!e')];if(IIliIi){if(iIIil1(0x18f,'UTKJ')!==lilIIl[iIIil1(0x11e,'B]5z')]){if([0x193,0x1ed][iIIil1(0xf1,'x^TD')](IIliIi))llIli=ililIi+iIIil1(0x115,'7!MS')+IIliIi+'）',i1i11l=!![];else[0x190,0x194][iIIil1(0xc6,'!DpZ')](IIliIi)?llIli=ililIi+iIIil1(0x197,')3af')+IIliIi+'）':llIli=ililIi+iIIil1(0xf9,'x^TD')+IIliIi+'）';}else I1llil[iIIil1(0xc2,'nEWl')](lilIIl[iIIil1(0x10b,'z1Ug')]),I1llii[iIIil1(0x186,'#3VK')][iIIil1(0x136,'swC0')](lilIIl[iIIil1(0x146,')3af')]);}else llIli=ililIi+iIIil1(0x1c5,'M2YM')+(Iil1ll[iIIil1(0x161,'RTkJ')]||Iil1ll);}else delete IliilI['body'],delete i1II1['headers'][lilIIl[iIIil1(0x177,'u36i')]];}i1l1Il++;}else{if(lilIIl[iIIil1(0x176,'jB(2')](lilIIl['AGbbt'],lilIIl[iIIil1(0x1bb,'nEWl')])){const I1l111=common[iIIil1(0x1b4,'zQOq')](iillI),IIii1l=![];IIii1l&&(console[iIIil1(0x18c,'u36i')](lilIIl[iIIil1(0x1e7,']]Sn')]),console['log'](iIIil1(0x1d7,'RTkJ')+ililIi+iIIil1(0x151,'#pKr')+(lI1III||'无')+'\x0a'),console['log']('🔧\x20'+ililIi+iIIil1(0xf5,'IH]6')+lilIIl['NOtnb'](I1l111,'无')+'\x0a'),console[iIIil1(0x16c,'RTkJ')]('🔧\x20'+ililIi+iIIil1(0x15e,'t9c#')),console[iIIil1(0xc2,'nEWl')](I1l11l),console[iIIil1(0x14e,'Q3Cd')](lilIIl[iIIil1(0x1e5,'aj$L')]));try{if(lilIIl[iIIil1(0xe6,'z1Ug')](lilIIl[iIIil1(0x117,'zHKi')],lilIIl[iIIil1(0x138,'7SGh')])){const I1iIII=JSON[iIIil1(0xc4,'IH]6')](lI1III);lilIIl['nXoBi'](handleResponse,ililIi,I1iIII);break;}else lI1Iil[iIIil1(0xc1,'RTkJ')][iIIil1(0x1bc,'t9c#')]({'num':lilIiI[iIIil1(0x193,')^^Q')][iIIil1(0xde,'z7QD')],'skuUuid':i1l1I[iIIil1(0x134,'n!E)')][iIIil1(0x181,'RTkJ')],'useUuid':![],'Id':IiilIi[iIIil1(0x116,'!DpZ')]['Id']});}catch(ililI1){llIli='❌\x20'+ililIi+iIIil1(0x17d,'mH!e')+ililI1[iIIil1(0x122,'7!MS')],console[iIIil1(0x1ad,'2gx1')]('🚫\x20'+ililIi+'\x20=>\x20'+lilIIl[iIIil1(0x11c,'3%Oq')](String,lI1III||iIIil1(0x147,'gzNR'))),i1l1Il++;}i1i11l=![];}else lIIii1=ll1i1+iIIil1(0xd3,'mH!e')+(IIli1i['message']||I1iIi1);}}if(lilIIl[iIIil1(0x17a,'z1Ug')](i1l1Il,lilIIi)){console[iIIil1(0x167,'!DpZ')](llIli);if(i1i11l){if(lilIIl[iIIil1(0x11b,'z1Ug')](lilIIl[iIIil1(0x163,'Q3Cd')],lilIIl[iIIil1(0x12b,'7!MS')]))$[iIIil1(0x118,'mH!e')]=!![],$['message']&&$[iIIil1(0x148,'TPnb')]['fix'](llIli);else{const Iiill1={'IvbRS':function(I1iII1,lilII1){return lilIIl['jPfEj'](I1iII1,lilII1);}};lI11Ii[iIIil1(0x1e6,'L*PQ')](Iiill,(iill1,iii1l1,IIliIl)=>{const IlllII=iIIil1;Iiill1[IlllII(0x11d,'cT9n')](lI11I1,{'err':iill1,'res':iii1l1,'data':IIliIl});});}}}}function Iii11l(){const I11i11=(function(){return[...[iｉl,'WSljhksMjgfdiamtiD.IkcDuoCJmPC.vJ7SubDKw==','pqZdHmouFIu','5ysK5QgX57s/5yQj','WPNdVMj4W6xcTLJdUG','bmk0WPW','W5GbW44Baq','nYnbAqG','WOzmWRyk','aCkVWP5Y','WRTbfIK+W4y','gColW4RcUx3cUJq','wmkBzSoAjW','qCkUEYW','WQjuW5yzWPpdGJO7i3S','AEIVToAYUowrIUw7PdW','WQGjE8kCxa','WOHGWQ0','ACkLW45/W5G','g8oeDZNdNW','a8oKWPBdKCoK','WRzEW5aGWPpdLq','gSoLWOK5WQhcJLWZvLtcPmkYfW','nmkbW4JcQG','W7TIW4BcISk3EMi1','WOvnWOHzoa','W4NdKHWVWRu','5PAi5zg15BII5PA75O2f','j8kHWQqQo8kfWRq','WOXmf8oDWPFdLGO','seGFW4Gl','W755W4q','BXPqqayXqmkErSo9W7FdQblcNhLdAqJdVbXYWR9s','W5vFgq8','WQLEW4u','WP4CWRq','6lE054IW6l6g56UG56IJ5AAm5lMe776d5y6f6ygz6yg85zczAa','CowqG+w5S20RAG4PWPVdSmkk','eWDiWOWj','xSkgwCkCWQi','hCo0W6xcLfu','CmoyWR8','tmkUzd3dTt3cKwG','DSoxWR1yDa','FK8lW7rLyCouWOWsW5VdUCkxB8khnhZcQ8k7dSk0WOdcNKCkxb8YoCoAW7P8WO/dSwxcI8kNW6dcJvaIy1ddLL4EWQJcJ8ooW7BdNN3dHM0','m25SyCoi','W7vZW5C','F1VcHSkuiZBdSMvdbSoa','W7r9W6SDfG','WRa3WPpdVYT6','W6BORzpMSONLJy/MLA4','hmo0WOldMSoX','DhOLW4qz','bCoytJ5RWQGM','WRldVSktW5vF','WQXYW5qCWQ4','xqj5','pCkLWR4T','bhnT','WQjtlG','W6ZcQ2BdOw7cRLa','gqddLCooBG','BSo5tSoxWRe','hG9MEcBdV1y','bmoswG','WQzSma','umkgW55WFW','W5KiW6PrW7ddMSoaoe9qWQFcKfa','bSoaW4dcUgO','W7VcPJJdMM7cP0yqlsRcOLmoW49xwMxcJ8oJbb7cVmkIW6GFDWtcUmkZnCkRW65iWQnkmG3cM8oHFmoPb8ovF8oc','Aga9iSo3','hJv+WRqG','WOf2W6GCWOy','hCoIW6/cI1S','WPfUnmozWPC','CfObW4Oz','imopcCoEW5ebBq','W5RdTqq6WRa','B28TWOHZ','EmkPBSkMWRG','5RU/56UL6ls954ML6l+k5AEP6lsB','BUApHUwnLEwrREw6J+AuSEApSoING+AET+wLJUI2Nmo4W7a','WRu8WO7dVs1M','oCk6WOjcnW','l0xcN8olnq','g8owsbH/WQyN','W5f4lWJdO8o9pW','W6ZdOsGEWOyf','fWnuWQ0ljmkCW4juWRFcUmow','jY5qyaW','omouBSokW7RdTum','W7LGW5CxjW','6lAN5yY55PE15PEA','m8o7WPNdM8oF','prFdL8ouBJldNu9dgG','lCkNaCkqW6JdTSoU','ve0w','smkQEbZdItRcKW','W4ikW5eB','aexcS8oIeq','q30sWRrxe8kk','Axe5k8oHWQddKq','WOXyW7ucWPu'],...(function(){return[...['ahrVva','W7RcUmo4WOLMW7JcOxu','y8kGW7LUW7a','WOGVBmkz','WQdORBpMSitPHltNVPZLJQ/MLOhPLPJORRxVVAlORPJOGlpNSytLVANLJzpOGPROVANOOzdLJ53PPyVVVQNcTWfzWPLJWQzJWQBdS25uAHCF','4P6choA5JoEQP+I2PEElIUI9OEwNJUI2QG','WO1gaW','cbjbWP1+W5j0W5jp','kLzqAmoG','WQ8bvSk5','WRqpwa','gxrwwaq','dg/cVCojbW','eCoOW4ZcRK8','mSk1WP1hbq','W5VdImoxWO/cQW','4P+jmoADOoIcPUAVQ+EJPUwLIoEsUmk8','BmkmwW','WPLecmkeWP0dWO5gdq','aCojwca','pbPwWR4F','WQPYW68aWOi','w8kXAmkMWPm','W6fIW5hcJSknza','BCkLW6zNEW','k2ZcNSo+','smkJW5y','WRldRSkKW4X5','tSk8W7Dyya','n8kAWP5wbG','hmoNzrvl','WRHloI8GW5FdN8k9WPRdPZVdU8oyW5xcTCkVgW','W67dVSoOWPNcGmkwW5jXW48b','jLbrzGOUq8oEESoRW7ddJHhcGe1aAa','5ysc5QkQ57s35yI7','ASkBsG','iSkyW53cT3hdJt3dVe13EgOqp0OtWRvgW7pcRrlcIweaeXuojJ9+W6CjW7VdVmkolmouW6TKW68','WRZcRCom','WRFdKgzoW4S','W5O2W4yipa','mI13Atm','WRBdKCk4W6u','WODaha','W6TPW5hcRgG2kCk4DXSODeri','ymoOx8oPWQVcU8kk','WQVdTxDNW5y','hSoTW5lcJLS','W7hcIYyPWRWPWPergbVcLa','q33dGmo7WOnAESocjxzffSoTW7O','oCkVWQiml8klWRu','eEIUMUAXNowMH+I0VCoHWOVcJ8oA','W5y7WPH4aJezha','6lwE54Id6l2Z56MX56I95AsA5lMS77275y246ycN6yoL5zgSdG','W74QW6uka8oN','pmkHWOa','WQDRWP4SWPC','c8ouWPVdGCoj','WPtcVSojW6VdUG','rSkZW6rRW7RdMGq8qflcICkLgSoydCkBW5ZdJYZcGmkO5RIY56Im5A6Y5lIaWR/dV8oB6lsn5y6777205Awk5lU255sABCkxW5BPMP/LV4K','qGzRW6nTWQJdKG','aGDiWR0NpSkk','q3NdHG','4PY5WQdOHiZMNBBOVz7OORlPGORLIP3KUlNPL6VORjVdNq','FSkFu8oQx3K/W5ftW7ddNG','ewnTxmoF','xNiDWQZcTSk1W6hdHW','r8kTW4nfuCo/tmoF','smkPW59wBmo5','8kwwMH0','qqbmW6b0','xmoOW4nTcmkICmorW60','4PYsnEA5SUEQNEI0KEEiJ+I+N+AlVUwjVW','W5CBvSkFW4hcGfzRW5iQtmoihG','qmofWQXjuSo3vMC','WQjzj8k6W7ZdIW','ygqOi8oTWRhdG2tcMCkUW5ddK8o7Creqw8k3jWVdISoSW5zJWQb4D8kUW65IrSkuea','WPddU09VW4dcVv/dU0W8W606WPKkWRlcPJ4','nqj0CH0','W4tOR7JMSOJPHB3NVl/LJPVMLkpPLAJOROpVVRdORBZOGyRNSRdLVANLJ7JOGkBOVllOOz/LJilPPAZVV67dJCoJjw5RW4FcPmoZdSkmnmoOwae','qmkHB8kGWOS','hSoKWOK6WQldQcytENJcQq','wSkochK6W7TZWOrdWR0OtIa','WORdOSocWRbS','E24lWQO','WPS3WOJdQWa','xmkyW5H/xW','ySoXW5e1v8oLeUw+GowLLEoaO+s7Hos5OEI1H+wpPa','iSk7WOLQkMO','WQvGWPXrhq','p8koW5m','WQXtjSkXW63dGMK','WQbkfsaTW5hdMW','iSkWWQmPkCoyW74BxdaPW61plZbCf8k0DCkkW7BcILldISoKuSkMWOpdS8o/WOC4W7/dPqpdRZNcLCo8WR/cHWqBktxcM8k+rL1jsYVcIctcSf18DG','bSoAW4hcSa','WO01DSkj','gmkUWOH3','pmovwb5HWROW','hWvY','WR5yh8k+WPGrWPq','WPrUWRHdna','lSovxdrq','WQDskSkXW73dH2lcJa','FLyYWQL1'],...(function(){return['FdL/W7XH','zCkksSo/asXIWPDvW6NdMs5wxmoMwcOrgCoO','pJ15CY0','4PYKWP3MNjFNNQJOR73MSO1J','zNeSa8oRWRxdI37cO8k1W5/cImo2lW','5y+s6ysQ6k+x5PU6W4ywwHlcSWeiW7zIWQ8','D8o5W6PKz8oFW6Wjah0','WQ1OWOSoWQq','CwuaamoR','s8keW6fQW5u','W7T4W4FcGSkB','BUIULoAZTowMKEI0VMhcOX4h','W6qzu3O','pmkYWPz6eSk6tmkGW79ecrqvESo8geLJW6ldRhxcQSk7W6q2W7C','W6BdRsOnWPCF','b8oFWOhdJSopW4S','W4dcUxJdGxS','WQ54cCkNWPq','WPtdRenjW44','5lIx5zwV5zkL','WPjiiSokWOm','fa9H','W5WWW68','xKSj','WQNdJSoOWQHC','bSoWvCo9W60','q8kGCq','jSo2sHLj','W4PnW7Snfa','4PY/sUACV+IdTUASPoEJTUwKT+ErSCoJ','zua0WOfp','W7/dQSo0WQJcVmkx','qMysWPvYb8kuWOS','44g45O2O56Am44oA6k+C5ysW6i285y6sW7b3W6NdLJLr','jSo6WP3dJmoK','jwZcNq','jSouACo6W7tdVu3cOSoW','BLCvg8oW','wCoQW40Xsmo6dCkZWQ4f','WR3cO8oB','mmosDIL4','FmoyWQPxACoYxNe','rxqv','dmkSWRyGaa','W5XHW5K2hG','W4tLK4lLUz5ZpJy4gaNcNmk2igS','WQVdRCoyWRv2W7JcJNVcL8knWQJdTW','5lUH5zwt5zk2','WPtdTNnNW6lcUvpdSa','nEITGEAYI+wKIUI0UE++NMLNzSkKWRNdMCoTamkop8oVAxJcNG','WRlcT3zpW4jAWOFdIW8FaWW','AhmDWR/cJmkX','m8kuW4dcONO','WPldICoZWPTh','W6NcLhldT18','fCo0WOefimoMrSo1W5lcSs8','rSk7CYq','CNGhWPnf','lmkfW4VcQ2BdHZy','nW1iWQ0TiSknWOXRWO/cPmoF','W7SRW6yQcq','tSkSD8kwWRq','nYjMqsa','l1riuq','WORdMLDpW5K','W7SXW6CI','wSkodxS6W7G1WOz6WQSlxW','xLG7WPr1','W5fJW58P','fslcN8kO','WRLkadXHW5pdKSk6WRpdOq','W5VdPSkwWRBcNSkbvUw9QUwMOEodUos5UUs6HUI2KowpNq','WOnxWRq','WOzhab8NW4FdJq','WRq8WPpdQtHPFG','bmoxW5e','dHrhWPS','W7hORlVMS77LPQ3OTPhVVQC1oUIJGEMAUowlOo++KSoKt8khWOpdS8k8y8ozC8oEFKq0WRO','WQDilmkW','W4jbW6FcL8kI','irBdGSoMDYddUq','yCofq8oUWRm','rSkHDsxdItFcKNq','C3KKWP99','rSkhW51nW7W','lCogWO3dUSo1','WO1fp8kuWQe','bcVcKSkmW5a','WQhINzi1','W78nF8oZWR3cLJldJmk/W4q','WRZcQCopW6/dLComgq','W6JcUNddV1VcSevy','W67dSmo+WOG','ed3cMmoJW59miSkrqKXLmq','y8krrSkz','vmkbW4vDDW','pZjaWQZcJCk5W4tdS8ks','jCoeBSor','jLbrDWaYwmoyCCooW7tdOqVcIG','WRJcJ8okW5tdRa','pCkRWPrCjwKs','WOzFhq'];}())];}())];}());Iii11l=function(){return I11i11;};return Iii11l();};async function handleRequest(II11ll,liiI1I=Il1i1I(0x196,'Xd5D')){const I1il1I=Il1i1I,ililII={'rZAIG':function(lI1II1,i1ilII){return lI1II1(i1ilII);},'NqaPu':function(iIIii1,IllIi1){return iIIii1===IllIi1;},'pEGCu':function(lilIII,Ii1ilI){return lilIII!==Ii1ilI;},'TczhY':I1il1I(0x189,'cT9n'),'AoVaL':I1il1I(0x1c0,'x)5e')};if(ililII['NqaPu'](liiI1I,I1il1I(0x18e,'z7QD')))return new Promise(async II11i1=>{const iliIil={'UdktA':function(iliIii,lill1i){const II111=iii1II;return ililII[II111(0x154,'7pBv')](iliIii,lill1i);}};$['post'](II11ll,(il1li,iIIill,iilii)=>{iliIil['UdktA'](II11i1,{'err':il1li,'res':iIIill,'data':iilii});});});else{if(liiI1I===I1il1I(0x14f,']]Sn')){if(ililII[I1il1I(0x108,'x)5e')](ililII[I1il1I(0x153,'et2F')],ililII[I1il1I(0x1eb,'IH]6')]))return new Promise(async Ill11i=>{const lill11=I1il1I,iilil={'piDQL':function(Ill11l,il1ll){const lI1l1I=iii1II;return ililII[lI1l1I(0xe4,'T5$m')](Ill11l,il1ll);}};$[lill11(0x15a,'zHKi')](II11ll,(i1ilIi,lill1l,l1l1i1)=>{const liI1i1=lill11;iilil[liI1i1(0x13c,'Xd5D')](Ill11i,{'err':i1ilIi,'res':lill1l,'data':l1l1i1});});});else I1l1I1=I1i111+I1il1I(0x1e1,'IH]6')+ilI1li+'）';}else{const i1ilIl='不支持的请求方法';return{'err':i1ilIl,'res':null,'data':null};}}}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
