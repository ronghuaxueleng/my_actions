/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认3
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
var iｉl='jsjiami.com.v7';const IIliIl=iii1II;(function(i1ilI1,Iiilii,Iil1li,Iiilil,Iil1ll,iillI,lI1III){return i1ilI1=i1ilI1>>0x8,iillI='hs',lI1III='hs',function(IIliIi,IllIiI,i1il1,I1l111,IIii1l){const iii1l1=iii1II;I1l111='tfi',iillI=I1l111+iillI,IIii1l='up',lI1III+=IIii1l,iillI=i1il1(iillI),lI1III=i1il1(lI1III),i1il1=0x0;const I1iIII=IIliIi();while(!![]&&--Iiilil+IllIiI){try{I1l111=parseInt(iii1l1(0x1ec,']uXY'))/0x1*(-parseInt(iii1l1(0x1a1,'0tMp'))/0x2)+-parseInt(iii1l1(0x134,'9cbW'))/0x3*(parseInt(iii1l1(0x1fa,'I0GW'))/0x4)+parseInt(iii1l1(0x1bc,'ffTT'))/0x5+parseInt(iii1l1(0x1c8,'wRE!'))/0x6+-parseInt(iii1l1(0x176,'9cbW'))/0x7+-parseInt(iii1l1(0x1f4,'4gwC'))/0x8+-parseInt(iii1l1(0x22a,'0]LO'))/0x9*(-parseInt(iii1l1(0x185,'LVV$'))/0xa);}catch(liiI11){I1l111=i1il1;}finally{IIii1l=I1iIII[iillI]();if(i1ilI1<=Iiilil)i1il1?Iil1ll?I1l111=IIii1l:Iil1ll=IIii1l:i1il1=IIii1l;else{if(i1il1==Iil1ll['replace'](/[CHPrNqJuXbISynktldQ=]/g,'')){if(I1l111===IllIiI){I1iIII['un'+iillI](IIii1l);break;}I1iIII[lI1III](IIii1l);}}}}}(Iil1li,Iiilii,function(ililI1,IIii1i,i1ili,Iiill1,I1iII1,lilII1,iill1){return IIii1i='\x73\x70\x6c\x69\x74',ililI1=arguments[0x0],ililI1=ililI1[IIii1i](''),i1ili=`\x72\x65\x76\x65\x72\x73\x65`,ililI1=ililI1[i1ili]('\x76'),Iiill1=`\x6a\x6f\x69\x6e`,(0x15bcb8,ililI1[Iiill1](''));});}(0xcb00,0x7f96d,Iii11l,0xcd),Iii11l)&&(iｉl=`\xdaa`);const jdCookie=require(IIliIl(0x194,'wRE!')),common=require(IIliIl(0x12b,'hApG')),{H5st}=require(IIliIl(0x131,'dZJ9'));console[IIliIl(0x16b,'yhbv')](''),console[IIliIl(0x146,'#g1U')]('=========='+$['name']+'变量说明=========='),console['log'](IIliIl(0x1eb,'*RaI')),console[IIliIl(0x187,'F*@W')]('jd_dpqd_task_threads\x20//\x20控制签到并发，默认1'),console[IIliIl(0x218,'POrC')](IIliIl(0x20a,'JCQE')),console[IIliIl(0x17c,'wxlV')](IIliIl(0x144,'&*JM')),console[IIliIl(0x1c6,'dZJ9')]('=========='+$['name']+IIliIl(0x18d,'BUsU')),console[IIliIl(0x13d,'E1Cg')]('');let tokensList=(process[IIliIl(0x1ba,'$mXZ')]['jd_dpqd_tokens']||'')[IIliIl(0x1ad,'0]LO')](/[,@&|\n]+/g)[IIliIl(0x1f7,'aDe]')](Boolean),taskThreads=process[IIliIl(0x142,'POrC')][IIliIl(0x19a,'I0GW')]||'1',accountThreads=process['env'][IIliIl(0x15d,']o8K')]||'1';const runInterval=process['env'][IIliIl(0x221,'6wlA')]||'',isNotify=process[IIliIl(0x1fc,'4gwC')]['jd_dpqd_prize_notify']===IIliIl(0x1db,'LjTv');let signHotMaxRetryTimes=process[IIliIl(0x1a9,'6wlA')][IIliIl(0x170,'7YVA')]||'0',TokensMap=null;const signStatusMessages={0x1805c007:'今日已签',0x1843da61:'活动未开始',0x1843da62:IIliIl(0x1f8,'E1Cg'),0x184253c7:IIliIl(0x1c1,'E1Cg')},CacheFile=__dirname+IIliIl(0x1e7,'wxlV'),cookiesArr=Object[IIliIl(0x17f,'LjTv')](jdCookie)['map'](lil11l=>jdCookie[lil11l])[IIliIl(0x1b2,'&*JM')](i1i1Il=>i1i1Il);!cookiesArr[0x0]&&($[IIliIl(0x16a,'0TN*')]($[IIliIl(0x180,'dZJ9')],'【提示】请先获取Cookie'),process[IIliIl(0x18c,'K^a0')](0x1));!(async()=>{const II11ll=IIliIl,I1lIl1={'toihP':II11ll(0x1d4,'F*@W'),'QmGGQ':II11ll(0x1c3,'#g1U'),'cETHh':function(lil11i,IlIIl){return lil11i(IlIIl);},'svHhX':function(lI1liI,i1i1Ii){return lI1liI>i1i1Ii;},'WPLWa':function(lllii,iI11Ii){return lllii!==iI11Ii;},'Shewm':function(iIII1l,lllil,iI11Il,iIII1i,iil1i1,il1i11){return iIII1l(lllil,iI11Il,iIII1i,iil1i1,il1i11);},'CCfPH':II11ll(0x1b3,'rhIR'),'rejJs':function(IlIll1,IlIII){return IlIll1>IlIII;},'XiNQa':function(ilil1l,illlIi){return ilil1l<=illlIi;},'RURuD':II11ll(0x219,'BUsU'),'cbmol':'TYBBg','Nnzbq':II11ll(0x192,'3#W1'),'xEmKR':II11ll(0x1b9,'7YVA'),'Ypwrw':function(I1lIii,IiI1I){return I1lIii===IiI1I;},'VkFlC':II11ll(0x1a4,'BUsU'),'UBHYG':II11ll(0x1b0,'4)@Y'),'TOSsQ':II11ll(0x148,'@GL!'),'gRUIM':function(illlIl,i11ill){return illlIl===i11ill;},'ePTYl':II11ll(0x203,'w^ic'),'maqbS':II11ll(0x223,'0TN*'),'mSHnz':function(IIIIIi,IIIIIl){return IIIIIi>IIIIIl;},'ABQeo':function(I1lIil,IIIl1i){return I1lIil!==IIIl1i;}};try{if(I1lIl1[II11ll(0x13b,'#g1U')](I1lIl1[II11ll(0x16d,'rhIR')],I1lIl1[II11ll(0x14d,'EZ0b')])){const IIIl1l=IlI11[II11ll(0x17e,'w^ic')](iIIIIl,I1lIl1[II11ll(0x1a7,'t]2*')]),lllll=II1Il[II11ll(0x215,'K^a0')](IIIl1l);lilIlI=new iIIIIi();for(const i11ili in lllll){i1ii['set'](i11ili,lllll[i11ili]);}}else{notify[II11ll(0x196,'ysYJ')]({'title':$['name']});if(I1lIl1[II11ll(0x1ac,'*RaI')](tokensList[II11ll(0x169,'ysYJ')],0x0))tokensList=[...new Set(tokensList[II11ll(0x164,'0tMp')](lllli=>lllli!==''))];if(I1lIl1[II11ll(0x21d,'yhbv')](tokensList['length'],0x0)){console['log'](II11ll(0x19b,'F*@W'));return;}const iil1l1=I1lIl1[II11ll(0x15c,'k!ar')](require,'fs');if(iil1l1[II11ll(0x1ed,'K^a0')](CacheFile)){const iiili1=iil1l1['readFileSync'](CacheFile,II11ll(0x162,'qVUs')),ill11i=JSON[II11ll(0x1f6,'4gwC')](iiili1);TokensMap=new Map();for(const lllill in ill11i){TokensMap[II11ll(0x21e,'qXXI')](lllill,ill11i[lllill]);}}else{console[II11ll(0x198,'&*JM')](I1lIl1['RURuD']);return;}$[II11ll(0x147,'E1Cg')]=null;if(runInterval){if(I1lIl1['WPLWa'](I1lIl1[II11ll(0x153,'LjTv')],I1lIl1[II11ll(0x13e,'wxlV')]))try{if(I1lIl1[II11ll(0x1cd,'@GL!')]!==I1lIl1[II11ll(0x1e3,'dZJ9')])Iii11I=0x1;else{const I1lIiI=I1lIl1[II11ll(0x139,'E1Cg')](parseInt,runInterval);I1lIiI>0x0&&($[II11ll(0x1ea,'epgp')]=I1lIiI);}}catch{I1lIl1[II11ll(0x1d5,'epgp')](II11ll(0x1f1,'dZJ9'),I1lIl1['VkFlC'])?ll1l1[II11ll(0x15b,'ysYJ')]('❌\x20未能正确处理\x20'+IllIIi+II11ll(0x195,'*RaI')+(IllIIl['message']||IiiIi1)):console[II11ll(0x13f,'#UqQ')](I1lIl1[II11ll(0x152,'ffTT')]);}else{IiilI1[II11ll(0x161,'aNiI')](I1lIl1[II11ll(0x166,'pFl8')]);return;}}try{const Ill11=I1lIl1['cETHh'](parseInt,signHotMaxRetryTimes);signHotMaxRetryTimes=I1lIl1[II11ll(0x199,'0TN*')](Ill11,0x0)?Ill11:0x0;}catch{if(II11ll(0x167,'qXXI')===I1lIl1[II11ll(0x188,'z9l0')])signHotMaxRetryTimes=0x3;else{const li1i11=I1lIl1[II11ll(0x190,'I0GW')](Iliill,IIII11);I1lIl1[II11ll(0x1c2,'qXXI')](li1i11,0x0)&&I1lIl1[II11ll(0x179,'I0GW')](li1i11,0x1)&&(i1illl=li1i11);}}try{const iI11I1=I1lIl1[II11ll(0x1ee,'6wlA')](parseInt,taskThreads);I1lIl1[II11ll(0x15e,'6wlA')](iI11I1,0x0)&&iI11I1!==0x1&&(I1lIl1[II11ll(0x207,'E1Cg')](I1lIl1[II11ll(0x1ce,'K^a0')],II11ll(0x158,'JCQE'))?taskThreads=iI11I1:l1i111=iliII1);}catch{if(II11ll(0x181,'z9l0')!==I1lIl1[II11ll(0x168,'BUsU')])taskThreads=0x1;else{const IIIl1I=I1lIl1[II11ll(0x133,'5NHn')](i1l1ll,I1iIiI);I1lIl1['svHhX'](IIIl1I,0x0)&&(i1ilil[II11ll(0x15f,'wxlV')]=IIIl1I);}}try{const iil1ii=I1lIl1[II11ll(0x208,'0tMp')](parseInt,accountThreads);I1lIl1['mSHnz'](iil1ii,0x0)&&I1lIl1[II11ll(0x130,'z9l0')](iil1ii,0x1)&&(accountThreads=iil1ii);}catch{accountThreads=0x1;}await common[II11ll(0x1b1,'4)@Y')](accountThreads,cookiesArr,async(IlIlli,il1i1i)=>{const liiI1I=II11ll;await I1lIl1['Shewm'](concMain,taskThreads,tokensList,IlIlli,il1i1i,Main);if($[liiI1I(0x1f3,'t]2*')])$['wait']($['waitTime']);}),isNotify&&notify[II11ll(0x193,']uXY')]()&&(notify[II11ll(0x178,'F*@W')](notify[II11ll(0x12f,'LjTv')]),await notify[II11ll(0x212,'qVUs')]());}}catch(lil111){console[II11ll(0x17c,'wxlV')](II11ll(0x19d,'4)@Y')+lil111);}})()[IIliIl(0x210,'w^ic')](i11ilI=>$[IIliIl(0x156,'#g1U')](i11ilI))[IIliIl(0x1e5,'03pr')](()=>$[IIliIl(0x1d8,'hApG')]());async function Main(ii1ii1,llllI){const ililII=IIliIl,lllil1={'SFgSE':ililII(0x1d0,'#g1U'),'lPShV':function(Iliii1,iIiIi,iil1ll){return Iliii1(iIiIi,iil1ll);},'JZtgm':function(iiilil,iil1li){return iiilil===iil1li;},'jrCPs':function(lillIl,iIiIl){return lillIl(iIiIl);},'twIXI':function(iiilii,li1i1i){return iiilii!==li1i1i;},'tphiT':'HzvtK','MRYRf':'wmCpW','RYsoq':function(IlIli1,illIiI){return IlIli1>illIiI;},'CRidO':ililII(0x229,'z9l0'),'sfYCf':function(lI1lli,Ill1l){return lI1lli/Ill1l;},'byUha':function(llI1Il,ii1iii){return llI1Il!==ii1iii;},'EvvWk':'nmIEO','AakLr':ililII(0x214,'3#W1'),'KYSIH':ililII(0x201,']uXY'),'fCnSU':ililII(0x173,'$mXZ'),'kIiQV':'interact_center_shopSign_signCollectGift','umbUh':ililII(0x1f9,'JCQE'),'YwdFg':'4.4','hquZx':'https://api.m.jd.com/api','srMJJ':function(i11iil,Ill1i){return i11iil===Ill1i;},'FqlSt':'zkMkx','dHFSv':ililII(0x1ca,'qXXI'),'xUxID':ililII(0x213,'5NHn'),'IihaQ':'keep-alive','DNWXt':'text/plain','BaoFE':ililII(0x209,'w^ic'),'gcEuY':ililII(0x135,'03pr'),'wNdEg':ililII(0x138,'E1Cg'),'ptlOI':ililII(0x1e8,'EZ0b'),'JrPyw':'same-origin','xGAQa':function(ii1iil,lllI1l){return ii1iil===lllI1l;},'jducL':ililII(0x1de,'@GL!'),'CoXGc':function(i11iii,llI1Ii){return i11iii<llI1Ii;},'VlRFZ':function(lllI1i,li1i1l){return lllI1i!==li1i1l;},'ThXDA':ililII(0x16e,'LjTv'),'rUOVn':function(II1i1,lI1lll,iIiII){return II1i1(lI1lll,iIiII);},'PjBWP':ililII(0x140,'&I#z'),'qGwBR':function(iil1lI,iiiliI){return iil1lI||iiiliI;},'LDWBX':function(li1i1I,illIii){return li1i1I<illIii;},'PaYGM':ililII(0x21c,'0]LO'),'eKMTr':ililII(0x12e,'dZJ9'),'TYcXG':function(ii1il1,lI1llI){return ii1il1(lI1llI);}},{title:iil1il,UA:ilil1I,cookie:i11il1,message:ii1iiI}=llllI,lllilI=TokensMap['get'](ii1ii1);if(!lllilI)return;const ilil11=Math[ililII(0x1a2,'0TN*')](lllil1[ililII(0x143,'#g1U')](Date[ililII(0x171,'#UqQ')](),0x3e8))+ililII(0x18b,'*RaI'),{venderId:illlI1,activityId:IIIl11}=lllilI;if(lllil1['qGwBR'](!illlI1,!IIIl11))return;let I1lIi1=![];await lllil1['jrCPs'](lil11I,ililII(0x141,'4gwC'));if($['waitTime'])$[ililII(0x216,'JCQE')]($[ililII(0x1da,'0TN*')]);if(I1lIi1&&signHotMaxRetryTimes>0x0){if('prJDk'!==ililII(0x1e1,'4gwC'))II11II=0x1;else{let Ill1I=0x0;while(lllil1['LDWBX'](Ill1I,signHotMaxRetryTimes)){if(lllil1[ililII(0x1a6,'dZJ9')](lllil1[ililII(0x217,'BUsU')],lllil1['eKMTr']))lilIl1[ililII(0x1dd,'F*@W')](i1l1ii['name'],lllil1['SFgSE']),i1l1['exit'](0x1);else{await lllil1[ililII(0x19f,'wRE!')](lil11I,lllil1[ililII(0x204,'EZ0b')]);if($['waitTime'])$[ililII(0x1ab,'z9l0')]($[ililII(0x183,'aNiI')]);if(!I1lIi1)break;Ill1I++;}}}}async function liiIIi(lIli11,lllI1I){const iIIii1=ililII,lillI1={'wytyt':function(IlIlii,i1l1i1){const lI1II1=iii1II;return lllil1[lI1II1(0x20b,'yhbv')](IlIlii,i1l1i1);},'eWRzt':function(liil11,iiillI){const i1ilII=iii1II;return lllil1[i1ilII(0x1cc,'4gwC')](liil11,iiillI);}};try{if(lllil1[iIIii1(0x20e,'ffTT')](lllil1[iIIii1(0x149,'w^ic')],iIIii1(0x19c,'*RaI'))){const l1iIII=llIlil[IIlil['code']]||ilI1lI['code']+iIIii1(0x1fb,'4gwC');IiiIll[iIIii1(0x132,'K^a0')](''+IIlii+IlI1il+iIIii1(0x191,'PSNu')+l1iIII+'）');if(!IilliI[IlI1ii[iIIii1(0x1e9,'k!ar')]])lIIiii=!![];}else switch(lIli11){case iIIii1(0x222,'#g1U'):if(lllI1I['code']===0xc8&&lllil1[iIIii1(0x184,'4)@Y')](lllI1I['success'],!![])){if(lllil1[iIIii1(0x14b,'qXXI')](lllil1[iIIii1(0x1f0,'epgp')],lllil1['MRYRf'])){const IlIlil=lllil1['lPShV'](l1l11l,()=>{const IllIi1=iIIii1;lillI1[IllIi1(0x136,'I0GW')](l1iIl,0x0)&&(lillI1['eWRzt'](Iiil1,IlIlil),iiilli());},0x64);}else{const lIli1I=[];if(lllI1I['data']&&lllil1['RYsoq'](lllI1I['data'][iIIii1(0x17a,'LjTv')],0x0))for(const II1il of lllI1I[iIIii1(0x1fe,'z9l0')]){const lllI11=II1il?.[iIIii1(0x21f,'&*JM')]||[];for(const I1lIll of lllI11){const I1lIli=I1lIll?.[iIIii1(0x1b5,'qVUs')],II1ii=I1lIll?.[iIIii1(0x1c7,'7YVA')];let IIIIII='';switch(I1lIli){case 0x1:IIIIII=lllil1[iIIii1(0x1e6,'rhIR')];break;case 0x4:IIIIII=II1ii+iIIii1(0x1c0,'0]LO');break;case 0x6:IIIIII=II1ii+iIIii1(0x228,'PSNu');break;case 0x9:IIIIII=I1lIll?.[iIIii1(0x155,'JCQE')][0x0]?.[iIIii1(0x14f,'5NHn')]+'🎁';break;case 0xa:IIIIII=II1ii+iIIii1(0x177,'BUsU');break;case 0xe:IIIIII=lllil1[iIIii1(0x1cf,'E1Cg')](II1ii,0x64)+iIIii1(0x186,'I0GW');break;default:IIIIII=iIIii1(0x205,'*RaI')+I1lIli+'）';}lIli1I[iIIii1(0x1df,'t]2*')](IIIIII);}}if(lllil1[iIIii1(0x14e,'3#W1')](lIli1I['length'],0x0)){console[iIIii1(0x175,'rhIR')](''+iil1il+ii1ii1+iIIii1(0x1e4,'F*@W')+lIli1I['join']('，'));for(const lillII of lIli1I){ii1iiI[iIIii1(0x1ef,'aNiI')](lillII);}}else console[iIIii1(0x1c9,'*RaI')](''+iil1il+ii1ii1+'\x20➜\x20签到成功');I1lIi1=![];}}else{if(lllil1[iIIii1(0x1be,'JCQE')](lllI1I[iIIii1(0x18a,'#g1U')],0xc8)){const ii1ilI=signStatusMessages[lllI1I['code']]||lllI1I['code']+'|活动太火爆';console[iIIii1(0x218,'POrC')](''+iil1il+ii1ii1+'\x20➜\x20签到失败（'+ii1ilI+'）');if(!signStatusMessages[lllI1I[iIIii1(0x160,'#UqQ')]])I1lIi1=!![];}else{if(lllI1I[iIIii1(0x17b,'qXXI')]){console[iIIii1(0x224,'5NHn')](''+iil1il+ii1ii1+iIIii1(0x137,'wRE!')+lllI1I['msg']+'）');if(!signStatusMessages[lllI1I[iIIii1(0x1d9,'z9l0')]])I1lIi1=!![];}else console[iIIii1(0x224,'5NHn')](''+iil1il+ii1ii1+iIIii1(0x154,'3#W1')+JSON[iIIii1(0x21b,']uXY')](lllI1I));}}break;}}catch(lI1ll1){console[iIIii1(0x18e,'hApG')](iIIii1(0x1d7,'z9l0')+lIli11+iIIii1(0x1d1,'0tMp')+(lI1ll1[iIIii1(0x1b7,'ffTT')]||lI1ll1));}}async function lil11I(iIiI1){const lilIII=ililII;if(lllil1[lilIII(0x226,'BUsU')]==='nmIEO'){let liil1I='',i11ii1=null,IlIliI=null,l1iII1=lllil1[lilIII(0x12c,'LVV$')],iiill1={},lIli1i={};switch(iIiI1){case lllil1['KYSIH']:lIli1i={'appId':lllil1[lilIII(0x189,'yhbv')],'functionId':lllil1['kIiQV'],'appid':lllil1['umbUh'],'body':{'token':ii1ii1,'venderId':lllil1['jrCPs'](parseInt,illlI1)||'','activityId':parseInt(IIIl11)||'','type':0x38,'actionType':0x7},'version':lllil1[lilIII(0x1cb,'5NHn')],'ua':ilil1I},iiill1=await H5st[lilIII(0x1dc,'hApG')](lIli1i),liil1I=lllil1[lilIII(0x1aa,'ysYJ')],IlIliI=Object['assign']({},iiill1[lilIII(0x1f5,'pFl8')],{'jsonp':lilIII(0x1b6,'epgp')});break;}const IIIII1={'t':ilil11,'loginType':'2'};i11ii1&&Object[lilIII(0x182,'9cbW')](i11ii1,IIIII1);if(IlIliI){if(lllil1['srMJJ'](lllil1[lilIII(0x1c5,'t]2*')],'zkMkx'))Object[lilIII(0x20f,'&*JM')](IlIliI,IIIII1);else{I1l1I1[lilIII(0x218,'POrC')](''+I1i111+ilI1li+'\x20➜\x20签到失败（'+IIliI['msg']+'）');if(!ilI1ll[Iillii['code']])IlI1iI=!![];}}const I1lIlI={'url':liil1I,'method':l1iII1,'headers':{'Accept':'*/*','Accept-Encoding':lllil1['dHFSv'],'Accept-Language':lllil1['xUxID'],'Connection':lllil1['IihaQ'],'Content-Type':lllil1['DNWXt'],'Host':lllil1[lilIII(0x13a,'7YVA')],'Referer':lllil1[lilIII(0x1a5,'5NHn')],'Sec-Fetch-Dest':lllil1[lilIII(0x200,']o8K')],'Sec-Fetch-Mode':lllil1['ptlOI'],'Sec-Fetch-Site':lllil1[lilIII(0x15a,'aDe]')],'User-Agent':ilil1I,'Cookie':i11il1},'params':IlIliI,'data':i11ii1,'timeout':0x7530};lllil1[lilIII(0x151,'4gwC')](l1iII1,lllil1[lilIII(0x14c,'qVUs')])&&(delete I1lIlI['data'],delete I1lIlI[lilIII(0x1d6,'03pr')][lllil1[lilIII(0x1c4,'3#W1')]]);const ii1ill=0x3;let II1iI=0x0,llI1II=null,lIli1l=![];while(lllil1[lilIII(0x220,'I0GW')](II1iI,ii1ill)){const illIi1=await common[lilIII(0x13c,'#UqQ')](I1lIlI);if(!illIi1['success']){if(lllil1['VlRFZ'](lllil1['ThXDA'],lllil1[lilIII(0x1bf,'hApG')]))lllil1[lilIII(0x145,'$mXZ')](IilIl1,0x0)&&(lllil1['jrCPs'](l1l11I,lilIl),IilIlI());else{llI1II=''+iil1il+ii1ii1+'\x20➜\x20请求失败（'+illIi1[lilIII(0x206,'epgp')]+lilIII(0x12d,'&I#z'),II1iI++;continue;}}if(!illIi1[lilIII(0x1b4,'w^ic')]){llI1II=''+iil1il+ii1ii1+lilIII(0x1b8,'&*JM'),II1iI++;continue;}lllil1[lilIII(0x165,'#UqQ')](liiIIi,iIiI1,illIi1[lilIII(0x1b4,'w^ic')]),lIli1l=![];break;}II1iI>=ii1ill&&(lllil1[lilIII(0x211,'0tMp')](lllil1['PjBWP'],lilIII(0x16f,'I0GW'))?Illl1l[lilIII(0x1f2,']o8K')](''+Illl1i+lIIiil+lilIII(0x1fd,'0TN*')):(console['log'](llI1II),lIli1l&&($[lilIII(0x14a,'K^a0')]=!![])));}else{I1lliI['log'](''+llIllI+I1ilI1+lilIII(0x1ff,'03pr')+iillll[lilIII(0x1d3,'4)@Y')]('，'));for(const i1l1iI of l1lIlI){lIIil1[lilIII(0x1af,'t]2*')](i1l1iI);}}}}async function concMain(liil1l=0x1,lI1lii,Iiili1,Iil1l1,i1i11I){const Ii1ilI=IIliIl,il1iIl={'ffHGA':function(i1l1II){return i1l1II();},'jXwyR':function(i1ill,I1l11l){return i1ill<I1l11l;},'TjSuC':function(lilIIi,i1l1Il){return lilIIi>i1l1Il;},'MZomJ':function(llIli,i1i11l){return llIli(i1i11l);},'GeUnP':function(i1i11i,II11l1){return i1i11i===II11l1;},'YBAHh':function(Iil1lI,IiiliI,iii1iI){return Iil1lI(IiiliI,iii1iI);},'HtMen':'pt_pin','CzNlW':Ii1ilI(0x202,'$mXZ'),'BWjJG':function(llIll,il1iII){return llIll(il1iII);}},iii1ii=lI1lii[Ii1ilI(0x17d,'wxlV')](iilli=>iilli),il1iIi=decodeURIComponent(common[Ii1ilI(0x1d2,'dZJ9')](Iiili1,il1iIl[Ii1ilI(0x20d,'K^a0')])),iii1il=notify[Ii1ilI(0x1bd,'POrC')](Iil1l1,il1iIi),II11li=Ii1ilI(0x174,'F*@W')+Iil1l1+'】'+il1iIi+'：',I1l11i={'title':II11li,'UA':common[Ii1ilI(0x1e2,'4gwC')](il1iIi),'cookie':Iiili1,'index':Iil1l1,'message':iii1il},iIIiiI=await common[Ii1ilI(0x225,'#UqQ')](Iiili1);if(!iIIiiI&&il1iIl[Ii1ilI(0x172,'&*JM')](typeof iIIiiI,il1iIl[Ii1ilI(0x150,'03pr')])){console[Ii1ilI(0x17c,'wxlV')](II11li+Ii1ilI(0x1bb,'aNiI'));return;}let liiI1i=0x0;async function ililIi(IlllIl){const II11i1=Ii1ilI;await i1i11I(IlllIl,I1l11i),liiI1i--,il1iIl[II11i1(0x1a0,'7YVA')](lilIIl);}async function lilIIl(){const iliIil=Ii1ilI;while(il1iIl['jXwyR'](liiI1i,liil1l)&&il1iIl['TjSuC'](iii1ii['length'],0x0)){const II11lI=iii1ii['shift']();liiI1i++,await il1iIl[iliIil(0x21a,'5NHn')](ililIi,II11lI);}}const ililIl=Math[Ii1ilI(0x159,'03pr')](iii1ii['length'],liil1l),liiI1l=[];for(let lI1IIi=0x0;lI1IIi<ililIl;lI1IIi++){const I1l11I=iii1ii['shift']();liiI1i++,liiI1l['push'](il1iIl[Ii1ilI(0x1a3,'0TN*')](ililIi,I1l11I));}await Promise[Ii1ilI(0x19e,'0tMp')](liiI1l),il1iIl['ffHGA'](lilIIl),await new Promise(Ilil1l=>{const iIIiii=il1iIl['YBAHh'](setInterval,()=>{const iliIii=iii1II;il1iIl[iliIii(0x16c,'5NHn')](liiI1i,0x0)&&(il1iIl[iliIii(0x157,'0]LO')](clearInterval,iIIiii),Ilil1l());},0x64);});}function iii1II(_0x4d59c1,_0x3b54f0){const _0x2c4684=Iii11l();return iii1II=function(_0x1a309f,_0x1b0e16){_0x1a309f=_0x1a309f-0x12b;let _0x55bae4=_0x2c4684[_0x1a309f];if(iii1II['nWlsMv']===undefined){var _0x35b3a2=function(_0x29902f){const _0x24f494='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1c6e31='',_0x277ffe='';for(let _0xc15f69=0x0,_0xfbef97,_0x3f0a8b,_0x1ab211=0x0;_0x3f0a8b=_0x29902f['charAt'](_0x1ab211++);~_0x3f0a8b&&(_0xfbef97=_0xc15f69%0x4?_0xfbef97*0x40+_0x3f0a8b:_0x3f0a8b,_0xc15f69++%0x4)?_0x1c6e31+=String['fromCharCode'](0xff&_0xfbef97>>(-0x2*_0xc15f69&0x6)):0x0){_0x3f0a8b=_0x24f494['indexOf'](_0x3f0a8b);}for(let _0x5b5367=0x0,_0x40fc71=_0x1c6e31['length'];_0x5b5367<_0x40fc71;_0x5b5367++){_0x277ffe+='%'+('00'+_0x1c6e31['charCodeAt'](_0x5b5367)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x277ffe);};const _0x52950d=function(_0x47d9ce,_0x4d9940){let _0x5a6355=[],_0x3bf3ac=0x0,_0x32cc9f,_0x48daf6='';_0x47d9ce=_0x35b3a2(_0x47d9ce);let _0x621aca;for(_0x621aca=0x0;_0x621aca<0x100;_0x621aca++){_0x5a6355[_0x621aca]=_0x621aca;}for(_0x621aca=0x0;_0x621aca<0x100;_0x621aca++){_0x3bf3ac=(_0x3bf3ac+_0x5a6355[_0x621aca]+_0x4d9940['charCodeAt'](_0x621aca%_0x4d9940['length']))%0x100,_0x32cc9f=_0x5a6355[_0x621aca],_0x5a6355[_0x621aca]=_0x5a6355[_0x3bf3ac],_0x5a6355[_0x3bf3ac]=_0x32cc9f;}_0x621aca=0x0,_0x3bf3ac=0x0;for(let _0x1e4b62=0x0;_0x1e4b62<_0x47d9ce['length'];_0x1e4b62++){_0x621aca=(_0x621aca+0x1)%0x100,_0x3bf3ac=(_0x3bf3ac+_0x5a6355[_0x621aca])%0x100,_0x32cc9f=_0x5a6355[_0x621aca],_0x5a6355[_0x621aca]=_0x5a6355[_0x3bf3ac],_0x5a6355[_0x3bf3ac]=_0x32cc9f,_0x48daf6+=String['fromCharCode'](_0x47d9ce['charCodeAt'](_0x1e4b62)^_0x5a6355[(_0x5a6355[_0x621aca]+_0x5a6355[_0x3bf3ac])%0x100]);}return _0x48daf6;};iii1II['FqmAvZ']=_0x52950d,_0x4d59c1=arguments,iii1II['nWlsMv']=!![];}const _0x13a809=_0x2c4684[0x0],_0x114873=_0x1a309f+_0x13a809,_0x4b594e=_0x4d59c1[_0x114873];return!_0x4b594e?(iii1II['ikYMuE']===undefined&&(iii1II['ikYMuE']=!![]),_0x55bae4=iii1II['FqmAvZ'](_0x55bae4,_0x1b0e16),_0x4d59c1[_0x114873]=_0x55bae4):_0x55bae4=_0x4b594e,_0x55bae4;},iii1II(_0x4d59c1,_0x3b54f0);}function Iii11l(){const lill1i=(function(){return[...[iｉl,'CrjdsPXjQXilkNaHJbmSki.qqIcCuyoImt.lkvn7==','tKXW','zXpdUetcIYZcKmkrWRpdQmoVpCo2Eq','q8o5W5f8yq','p8k4mWxdVSkbhG','5BIY6zkb56wX5yIq8lwDTU+7SW','5l2y5Oo65yMx8koLQE+6Rq','WPxcGILSWRZcGSkqW6FdSSoOW7fLEW','WPRcJetdP2z6WReHW6uoW5BdTSomW5NcVCk2bSk5uKK4F8kO','d8k9CCoAWPm','77Yf8kEzMG','zCopdSo9W7O','WRj0lCogW5fyW6S','avG+fSox','hSkTiSoDW704gCkPbY5XW70KW7GGjG','WOlcRd8','qwzdsCk3','mmoUbwC9bmkK','xZfmm8oRgMddObVcUmofWOq9W5ZdPmkuWRrzcSob','mCkOWRpcSSke','tUkDQHJNRy3LIRlLPQxOTiBVVim','W7FdRCo+WQ7cOSok','W6FdI8oyWO/cUG','W7L/awq5','W7ztiKCg','CHpdVx3cGtJcJq','W6JdOCoR','WQKnfwDC','BbNdQW','wJRcQ8oMvW','oSkFv8omWRhcQSoIW5/dRuyhytu7DW','W5iRbW','W5jLn1mb','xs7dM8oapCkvkmowW51YW7NcGurNzmoYWRL1y2DdhCktWRhdKrVdQGZOHAtLR4RKU67OV6BOO57PLzpPMj3ML7dPL4K','WQzrW6VdRwG','W41Scq','W7pdR8oLWRpcHSoxnCoX','b8oxBNxdHq','W63dNCkFW694','WOhcTIZdP8kfW6HX','ECkxca3dVq','WQCMeSoyyq','WP5qvqHr','WOe+W43cKvO','uuHIt8k+WRvz','Dd92l8op','mCkXCCoZWPm','WOjAW7v7W6a','WRj5lSoDW5G','W7pIN7VcNUEUGowiM+wKQUI2M8o+WOOF','WOi/W4ZdINxcMmkNggBcHXPLWOtcKcBcVSotW682cG','W41ScvuvBa','W6hdQ3eZW4i','WQWjW4VdJhi','wIXw','jCkfxwPW','s8oGWQW','WQpdTXH6W5K','AdSTWQRcJCkRyCkmg8k4W6idW69XdSokb8odW5rzWOpdJCo8','qmkUyNpdHG','WPacbNf5iCowW4S','yXNdQg0','WOvCWOm','WPmZh8k5kW','WQyZax0IWQ/dJGGobe5cyW','wCkvW7WQWQPa','CIpdG17cIG','z8oimmk3WPm','v8ktkWldPG','A8oUW5zjwq','s8oQWQxdOXbi','vCkYWO8','WPKgDq','zuzcB8kp','W4BdJ8oHrae','WQDWmSoaW5m','dSkJWO7cISkX','W5f6muymW45DW79awSoKWQmlW7xcK0RdLW','BHNdUW','Cc/dKCokhq','W5HVW77cUty','44oB6lsY5yYx','W6NdO8oG','omkpFc5/sCoVWRRcGHddHrij','5ywfW4RLJ4BWLB6l','WR5KWOr5FX5bamowif3cPmoX'],...(function(){return[...['eCkbWOVcNmkr','WR1+lCovW4bE','ymktjG','WOSmca','WOOchW','W6VdImkwW6jQgmkEWOKlW4XLEW','WRP+oSob','xSoJoSom','b00SfCoG','Amonn38ShW','WP5sWO3dHCokwGS5','W5VdNayTyq','F8oSB8oIWRlcSCoZW5y','5ysf57MZ5y+c8y2uLW','WQD7WOC','ffu8amoP','WPmQFeNcQa','W4jScNu','d8kOlq','WOVcUZhdLq','5O+w56A157M05P20n8kKk8o3WO9OW4jPfmod','W5JdJfy','nmkWactdGSkZmW','jCkuWPpcG8ky','WOxIN6FcVUETQowkMEwNMoI3ME+9GW','WPKrW7JcQ0a','attcPmosySkfWQT4WO4g','qmozuLFdGCo7tgdcJ8kM','h+ITR+AXN+wsQ+w4SCkE','rmoGWQxdOG1h','W7fks2ZdUmoPWQVcRW','wYxdOW','s8k3WQdcQ2C','lmk1WPJcR8kasSk7erldUSo6FZH7WO9dWQKHW6Od','4PMRnoISL+wfKowUKEs4SUw/H+INRUEyVoEpU+wIU+wmKUMfIUwsM+wfGUI+MEIGOUIeNEAEVo+9Va','D8oIAXldRG','4P+DWQBOHAJMNABOV5ZOOARPGQlLI4dKUAhPLzxORk92','xSkqW7W','oSkVw2VdHq','W514jMu9','cmolWQLOW71kWQVcGmogW783','xSkTWOFcRe0','ESkwWOlcIxG','FSohW5DftG','rubsDmkg','ESoyi8ooW7K','W6nRucfb','W4frjYVdIMDWW77cPNGgtmk8','vSk2xa','t8o+WR7dNHW','n3SgbW','tCo9DYZdLG','W5/dGxi3W7W','m21gW77dHCoUmCkukSkUW5iwW7a','W75QsIXJW6O','4PIXWQBOHPJLR5dKUyxOV7BOOQNPLitPMBpMLRRPLR/OR4lNVANPL63ORl8','W7ldQrWPweFcLSkB','uspdQmoqkmkw','W6NdLCoOtcy','W73dJmkdW6C','WPi+cCoX','eXVdSHr9iCkcguG','WRP9W45rW4BdNmkf','f+kFLSkK6k2t5Rcp5AEv6lwP776b5PwC5zoC5BIo5PAE5O2F77Ya8jUyHG','W51eoKyY','WOLLW6K','6lEp5y+e5Pse5PE5WR7WK6Un','W6mGWOGtWPdcJmovwtlcLmkPxu8','W5q3fguppW','WOKOW63dH2y','W6ddI2NdL04','5lIa6lo38jIXQa','6lAI5y255PwS5PAp','FSkwct3dRa','4PIbi+IUMEwfMowVVEs5L+w9MEIMLoEyP+EpMUwGLUwpPUMgLowtMUweQ+I/MUIHLEIgUUADHo+9LW','WRKdW4VcNwC','W5f1vrPL','xmoTma','W593huetW4PxW5q','x8obaaFcSCkLfwJcT8ksW4/cUmkM','u8o3EG','ASkAkcxcMmoMlCoDW7VcUmoSCmotWQFdPCkjBW','E1rZr8k4','i8keC8oYWOe','jCoHAwNdHq','WOVcKWZdUmkf','W7FdQmovWOtcTa'],...(function(){return['44kX5O+t56wu44cb6k6q5yww6iYR5y+dW6aAW7PvmSkX','h+ISI+AZKUwsK+w5MXi','v8oNi8oQW7S7aCoVmb1YW7q9W64','W7VdQrSK','WR5GWOy1mW','ibJdQGH6','xYbzj8o9uJW','4PYmoUADHEIcJUAVM+EJJowKTUEtPM8','W5ddJf/dTG','i3ulfG','t8kGWOhcT2VcTSkNWPy','WQvPnSox','W5pdHKxdMZPLWRy','WQzNWOC','hSolALBdSJb1W7rQW6O2WQC','W6DXsIe','cmkVjfdcL8ogfCkVWQ3cH8od','oCkeESoMWPK','lSktxSo3WRm','smohoSoIW4y','W6VINOJdGoETPUwiU+AjQ+wkNE+9O+ImJ+w/G++8OG','usXwiSo0tdy','W4BdNSoUCay','W4Ghh3rjf8opW4hcU8oXWQiWySoTFJLd','WRn8hJT2s8ki','WQpdNsHx','dGNdTa5zECoFta','vCo8qGldLCopbSk2WPFcVmo6kCoCct3dSJ3cNEA2PUwjUu7dLE+8Q+wMT+s4TUEuGEIiREAxSUMcQowoLUwlIUwiIq','vaNcOSoptCkXWO8','WOVcUZhdKSkDW7PfWQ7cQ8kB','umkDFLpdTG','WObDWPFdLmoSrW','ndRdHcHR','ASoBp8o5W5O','BJav','W6bLud1fW7FcLq4','FCoobSkxW4pdS8k+W7JdRvq8ydq','rSoebCkrWQ/cTCoAW7P8tW','oCkxqSorWPC','cCkEywDIW68','5RA/5yIM5Bw+57Iu5P6n','WOi/W4ZdINxcUSkHaKlcKafaWPlcQYlcU8omW68Iea','D8oJW7pdU8oid8oRctBdRSoABG0','nEA3JEwkMowMIoEcMEElGW','lmkyrG','gokDNCoi56695yIp5OUp5yMv','jhSBeG','f+kFMrJNRl3LIQJMIldLI5dVV4pOJ4tLVjRVV7e','DrewWOVcMG','ftJcT8oXrmkzWRr1WOWat8oWpSo1EG','WO5KW7ddPMaLFa','W57dTCkeW6vz','WPzkybfr','5PYv55295Awl5zkN776T','hbRdRXv/','W6pdNmozWO7cNW','xmk5W4qwWQC','W7JdNCkEWQHbx8kyWOH2W5zKDq','WOe1W6FdI3FcImkGm1FcLHbWWPtcRtNcLmoRW643g8o7rSkXBfjZbEAnREwkMEI2QUwoPEw4VEwmN++9K+M6HoIVGsW','WR8ZzN3cKa','muFcTdddKhpdImkfWONdVCoekSoH','WQBcTXxdHmkh','WQnVW7r6W64','vJNdT8onkSkk','W7RdJmkdW6ve','tmkoW50uWOu','WPyYcSo8','weS6qSkrW7rgfmkNW7NcUSoWbSo4W55KDCkSW70','WPqIW6O','WP7cOIRdKSkm','WPWWW5hdMW','vSoUW75SrW','W5SQfG','4PQMWQ/ORzdLHApOV5ROO5xKUk3OH5dMNP7OJ6lLJkNMTA/LIOhKVj/MGyRNV7NLRlpLK6pLHytOVQ3OOAtMR7ZOHRlMNOtVVBa','B3L4Bmkv','fsxcOSo2ACkrWRf/WPa','W6VdIeCVW7i','WQ0axeVcNa','FSkfnq','rZJdRCoEkmkOjCo6W4G','bCk+WP/cJmkt','wCk8Dx/dRSodWROHWQtcL8kEWRTKCmk4cCoOWQVdGmotgu7cLSkU','W5jQcx4KCCoWECogfSoHEtlcSSos','DmkgWOBcQfm'];}())];}())];}());Iii11l=function(){return lill1i;};return Iii11l();};var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
