/*
活动名称：批量店铺签到（活动查询）
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号分割

查询活动信息主脚本，IP限制严重建议使用代理，请勿频繁运行
自动去重并过滤无效活动，默认过滤垃圾奖品活动
运行后会在本地目录生成缓存文件以用于签到脚本使用

7 7 7 7 *

*/

const $ = new Env('批量店铺签到（活动查询）')
const common = require('./function/jdCommon')
const { H5st } = require('./function/jdCrypto')

var iｉl='jsjiami.com.v7';const llllIilI=i11II11I;(function(l1iII11I,lIill1il,Il1I11li,il11ll1l,iIlIII11,I1Ilill1,iililliI){return l1iII11I=l1iII11I>>0x1,I1Ilill1='hs',iililliI='hs',function(iII11i11,iIlIl1l,iiiiil1l,lllIi1Il,Ii11i1l1){const II1lII1i=i11II11I;lllIi1Il='tfi',I1Ilill1=lllIi1Il+I1Ilill1,Ii11i1l1='up',iililliI+=Ii11i1l1,I1Ilill1=iiiiil1l(I1Ilill1),iililliI=iiiiil1l(iililliI),iiiiil1l=0x0;const ii1IIlII=iII11i11();while(!![]&&--il11ll1l+iIlIl1l){try{lllIi1Il=-parseInt(II1lII1i(0x1c9,'JqFL'))/0x1+-parseInt(II1lII1i(0x21c,'r&&&'))/0x2*(-parseInt(II1lII1i(0x262,'NzOH'))/0x3)+-parseInt(II1lII1i(0x246,'Mo@]'))/0x4*(parseInt(II1lII1i(0x277,'e3D%'))/0x5)+-parseInt(II1lII1i(0x1bf,'7kH('))/0x6*(parseInt(II1lII1i(0x198,'r&&&'))/0x7)+parseInt(II1lII1i(0x2a9,'cBya'))/0x8*(parseInt(II1lII1i(0x26b,'r&&&'))/0x9)+parseInt(II1lII1i(0x26f,'6D*h'))/0xa*(-parseInt(II1lII1i(0x280,'CEI('))/0xb)+parseInt(II1lII1i(0x276,'JqFL'))/0xc;}catch(iI1lIlIi){lllIi1Il=iiiiil1l;}finally{Ii11i1l1=ii1IIlII[I1Ilill1]();if(l1iII11I<=il11ll1l)iiiiil1l?iIlIII11?lllIi1Il=Ii11i1l1:iIlIII11=Ii11i1l1:iiiiil1l=Ii11i1l1;else{if(iiiiil1l==iIlIII11['replace'](/[CJPXGYBNxyVDedkOWuMTQh=]/g,'')){if(lllIi1Il===iIlIl1l){ii1IIlII['un'+I1Ilill1](Ii11i1l1);break;}ii1IIlII[iililliI](Ii11i1l1);}}}}}(Il1I11li,lIill1il,function(Iii1I1Ii,IiiII1ii,illi1iI,lI1l11,ilIII1l1,ll11il11,Iil1IliI){return IiiII1ii='\x73\x70\x6c\x69\x74',Iii1I1Ii=arguments[0x0],Iii1I1Ii=Iii1I1Ii[IiiII1ii](''),illi1iI=`\x72\x65\x76\x65\x72\x73\x65`,Iii1I1Ii=Iii1I1Ii[illi1iI]('\x76'),lI1l11=`\x6a\x6f\x69\x6e`,(0x15b955,Iii1I1Ii[lI1l11](''));});}(0x18a,0xe71fa,ill1lIil,0xc7),ill1lIil)&&(iｉl=llllIilI(0x2a0,'$q7$'));let tokensList=(process[llllIilI(0x18f,'4*PF')][llllIilI(0x1f2,'NzOH')]||'')[llllIilI(0x1c1,'UilC')](',')||[],TokensMap=null;const CacheFile=__dirname+llllIilI(0x1ad,'cBya');!(async()=>{const ill11i11=llllIilI,Ii1I1Ill={'WWEQC':function(iI1i1lIi){return iI1i1lIi();}};await Ii1I1Ill[ill11i11(0x2a8,'3ik6')](Main);})()[llllIilI(0x28d,']OAU')](l1liIl1=>$[llllIilI(0x1a3,'Caoa')](l1liIl1))[llllIilI(0x1d5,'Dg&d')](()=>$[llllIilI(0x1cb,'fwnz')]());function i11II11I(_0x27f233,_0x38b0b1){const _0x3b80af=ill1lIil();return i11II11I=function(_0x43acea,_0x14806f){_0x43acea=_0x43acea-0x174;let _0x2a9dc0=_0x3b80af[_0x43acea];if(i11II11I['SSJpWX']===undefined){var _0x268655=function(_0x511ad3){const _0x1c53ab='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x17f4b7='',_0x5c2958='';for(let _0x1dfb0c=0x0,_0x108fda,_0x292fbf,_0x5df90c=0x0;_0x292fbf=_0x511ad3['charAt'](_0x5df90c++);~_0x292fbf&&(_0x108fda=_0x1dfb0c%0x4?_0x108fda*0x40+_0x292fbf:_0x292fbf,_0x1dfb0c++%0x4)?_0x17f4b7+=String['fromCharCode'](0xff&_0x108fda>>(-0x2*_0x1dfb0c&0x6)):0x0){_0x292fbf=_0x1c53ab['indexOf'](_0x292fbf);}for(let _0x3cc071=0x0,_0x56c27a=_0x17f4b7['length'];_0x3cc071<_0x56c27a;_0x3cc071++){_0x5c2958+='%'+('00'+_0x17f4b7['charCodeAt'](_0x3cc071)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5c2958);};const _0x7b476b=function(_0x4781aa,_0x3a44b0){let _0x1f05b5=[],_0x51cb53=0x0,_0x188733,_0xed7d76='';_0x4781aa=_0x268655(_0x4781aa);let _0x5dbba0;for(_0x5dbba0=0x0;_0x5dbba0<0x100;_0x5dbba0++){_0x1f05b5[_0x5dbba0]=_0x5dbba0;}for(_0x5dbba0=0x0;_0x5dbba0<0x100;_0x5dbba0++){_0x51cb53=(_0x51cb53+_0x1f05b5[_0x5dbba0]+_0x3a44b0['charCodeAt'](_0x5dbba0%_0x3a44b0['length']))%0x100,_0x188733=_0x1f05b5[_0x5dbba0],_0x1f05b5[_0x5dbba0]=_0x1f05b5[_0x51cb53],_0x1f05b5[_0x51cb53]=_0x188733;}_0x5dbba0=0x0,_0x51cb53=0x0;for(let _0x1d71f3=0x0;_0x1d71f3<_0x4781aa['length'];_0x1d71f3++){_0x5dbba0=(_0x5dbba0+0x1)%0x100,_0x51cb53=(_0x51cb53+_0x1f05b5[_0x5dbba0])%0x100,_0x188733=_0x1f05b5[_0x5dbba0],_0x1f05b5[_0x5dbba0]=_0x1f05b5[_0x51cb53],_0x1f05b5[_0x51cb53]=_0x188733,_0xed7d76+=String['fromCharCode'](_0x4781aa['charCodeAt'](_0x1d71f3)^_0x1f05b5[(_0x1f05b5[_0x5dbba0]+_0x1f05b5[_0x51cb53])%0x100]);}return _0xed7d76;};i11II11I['TBlWlP']=_0x7b476b,_0x27f233=arguments,i11II11I['SSJpWX']=!![];}const _0x47b629=_0x3b80af[0x0],_0x4a7f52=_0x43acea+_0x47b629,_0x46168a=_0x27f233[_0x4a7f52];return!_0x46168a?(i11II11I['VBpPQj']===undefined&&(i11II11I['VBpPQj']=!![]),_0x2a9dc0=i11II11I['TBlWlP'](_0x2a9dc0,_0x14806f),_0x27f233[_0x4a7f52]=_0x2a9dc0):_0x2a9dc0=_0x46168a,_0x2a9dc0;},i11II11I(_0x27f233,_0x38b0b1);}async function Main(){const llIill1I=llllIilI,l11l1lli={'BWuFA':llIill1I(0x227,'NzOH'),'GcEFP':function(li1l1l1I,Il1lIIi){return li1l1l1I>Il1lIIi;},'xOXPW':function(I1Iili1i,IIi1ill1){return I1Iili1i<=IIi1ill1;},'raraT':function(ill1il,lI1iiiii){return ill1il!==lI1iiiii;},'rpoyM':llIill1I(0x1d1,'&emV'),'uYnCF':function(iii11iII,l11IIii1){return iii11iII<l11IIii1;},'GEpZz':function(liI1IiI,lII11i1I){return liI1IiI(lII11i1I);},'YwcCg':llIill1I(0x295,'aJp]'),'KRoVx':function(I1II1I11,IliI1I1l){return I1II1I11===IliI1I1l;},'ordRy':function(lIIiiliI,IiIIIIlI){return lIIiiliI===IiIIIIlI;},'JPcLU':llIill1I(0x1a6,'K)oR'),'RciQV':llIill1I(0x203,'gceT'),'tuoFv':llIill1I(0x191,'Gixc'),'uFiuA':llIill1I(0x1f3,'K)oR'),'zwUhZ':function(ililiI1I,iIl1llll){return ililiI1I>iIl1llll;},'uETRh':llIill1I(0x23c,'THyC'),'FWNHu':function(llIiIIi1,lI1lliIi){return llIiIIi1/lI1lliIi;},'aMPUR':llIill1I(0x1d0,'gceT'),'xARUT':function(IIill1l1,i1i11l1I){return IIill1l1>i1i11l1I;},'zQAqs':llIill1I(0x211,'&cWq'),'SmQVE':function(iil1ilI,iIliIi11){return iil1ilI>iIliIi11;},'Lmlkl':llIill1I(0x2a1,'K)oR'),'RgkQO':llIill1I(0x26c,'K)oR'),'yayfM':llIill1I(0x1fa,'zfFE'),'uBGaR':function(I1Iii1,IiIli1iI){return I1Iii1===IiIli1iI;},'ruggc':llIill1I(0x1a9,'3ik6'),'XLhFf':function(II1liIIi,i11IilIi){return II1liIIi(i11IilIi);},'GBRSI':llIill1I(0x239,'a#96')};try{if(l11l1lli[llIill1I(0x195,'Gixc')](tokensList[llIill1I(0x2ac,'Dg&d')],0x0))tokensList=[...new Set(tokensList[llIill1I(0x1c2,'LX5H')](I1i1I1Ii=>I1i1I1Ii!==''))];if(l11l1lli[llIill1I(0x20a,'NzOH')](tokensList[llIill1I(0x17f,'Gixc')],0x0)){console[llIill1I(0x253,'4*PF')](l11l1lli[llIill1I(0x183,'vDMj')]);return;}TokensMap=new Map(tokensList[llIill1I(0x2a6,'CB^J')]((III1111I,iii1il1i)=>[III1111I,{'index':iii1il1i+0x1,'venderId':'','shopName':'','activityId':'','startTime':'','endTime':'','isValid':!![],'rules':[]}]));const Ilii11li=[];console[llIill1I(0x241,'$q7$')]('');for(const Iil1IIii of tokensList){if(l11l1lli[llIill1I(0x2b1,'gG^p')](l11l1lli[llIill1I(0x250,'JqFL')],l11l1lli[llIill1I(0x18b,'LX5H')]))liIIiIli[llIill1I(0x25b,'gG^p')](l1lil11i,ii1I1II);else{let I11iiIil=!![];$[llIill1I(0x18d,'gceT')]=Iil1IIii;let lIi1IiI1=0x0;$[llIill1I(0x1e1,'gG^p')]='',$[llIill1I(0x1de,']OAU')]=![];const IiiIIlil=0xa;while(!$[llIill1I(0x1eb,'#kyF')]&&l11l1lli[llIill1I(0x297,'%egh')](lIi1IiI1,IiiIIlil)&&!$[llIill1I(0x2a3,'gagu')]){$[llIill1I(0x19c,'lsKj')]='',await l11l1lli[llIill1I(0x1f0,'EAlL')](sendRequest,l11l1lli[llIill1I(0x1bb,'a#96')]),await $[llIill1I(0x180,'Caoa')](0x3e8),lIi1IiI1++,l11l1lli[llIill1I(0x1dc,'%egh')](lIi1IiI1,IiiIIlil)&&(l11l1lli[llIill1I(0x24f,'EAlL')](l11l1lli[llIill1I(0x279,'aJp]')],l11l1lli[llIill1I(0x1e3,'Suzj')])?(l11i1i1i[llIill1I(0x1f8,'VLai')](I1iiI1il),liil1Il1=![]):(console[llIill1I(0x199,'Mo@]')]($[llIill1I(0x24e,'JqFL')]||l11l1lli[llIill1I(0x19b,'#hOV')]),$[llIill1I(0x1b1,'zfFE')]=''));}if(!$[llIill1I(0x2b4,'CB^J')])continue;const I1Iil1l=$[llIill1I(0x261,'UilC')][llIill1I(0x181,'h06d')],iIil1lIl=$[llIill1I(0x230,'EAlL')]['id'],IilIl1I1=$[llIill1I(0x1b7,'JqFL')][llIill1I(0x1f7,'VLai')],lil1lil1=$[llIill1I(0x261,'UilC')][llIill1I(0x1a1,'K)oR')]||[],I1llIll1=$[llIill1I(0x1e5,'%egh')][llIill1I(0x21f,']OAU')]||[],l1li1IIl=$[llIill1I(0x19f,'&cWq')][llIill1I(0x23a,'VLai')],ii1111iI=$[llIill1I(0x1d9,'r&&&')][llIill1I(0x289,'Mo@]')],ll1I1Iii=$[llIill1I(0x1df,'&emV')](l11l1lli[llIill1I(0x1e7,'Caoa')],l1li1IIl),i11liii1=$[llIill1I(0x1b0,'gagu')](l11l1lli[llIill1I(0x274,'gceT')],ii1111iI),iiI1l1lI=Date[llIill1I(0x252,'3ik6')]();l1li1IIl&&l11l1lli[llIill1I(0x297,'%egh')](iiI1l1lI,l1li1IIl)&&(console[llIill1I(0x17d,'gXPq')]('['+Iil1IIii+llIill1I(0x25e,']OAU')+ll1I1Iii+llIill1I(0x275,'cP&K')),Ilii11li[llIill1I(0x24d,'XduO')](Iil1IIii),I11iiIil=![]);if(ii1111iI&&l11l1lli[llIill1I(0x1e6,'vKir')](iiI1l1lI,ii1111iI))console[llIill1I(0x196,'Gixc')]('['+Iil1IIii+llIill1I(0x26d,'Suzj')+i11liii1+llIill1I(0x17e,'zfFE')),Ilii11li[llIill1I(0x271,'Gixc')](Iil1IIii),I11iiIil=![];else l11l1lli[llIill1I(0x17a,'vDMj')](IilIl1I1,0x3)&&(console[llIill1I(0x1e4,'THyC')]('['+Iil1IIii+llIill1I(0x251,'UilC')),Ilii11li[llIill1I(0x248,']OAU')](Iil1IIii),I11iiIil=![]);let illl1Ill=![];const l11lIl1i=[],llI11li1=[...I1llIll1,...lil1lil1];for(const IIiIl1 of llI11li1){const ilil1lIi=IIiIl1[llIill1I(0x1d2,'UilC')],l1llII1i=IIiIl1[llIill1I(0x189,'#kyF')]||[],II11IIlI=[];for(const iI1IIil of l1llII1i){let ilIi1Iil='';const IliIIIIl=iI1IIil[llIill1I(0x1b5,'aJp]')],I111liiI=iI1IIil[llIill1I(0x1ff,'4*PF')],IIlI1iII=iI1IIil[llIill1I(0x1f9,'CB^J')],IIliI1ii=iI1IIil[llIill1I(0x204,'3ik6')],I1lIliI1=l11l1lli[llIill1I(0x1bd,'zfFE')](IIliI1ii,0x5);switch(I111liiI){case 0x1:ilIi1Iil=l11l1lli[llIill1I(0x201,'EAlL')];break;case 0x4:ilIi1Iil=IliIIIIl+'京豆';break;case 0x6:ilIi1Iil=IliIIIIl+llIill1I(0x27f,'gG^p');break;case 0x9:ilIi1Iil=''+iI1IIil?.[llIill1I(0x1bc,'Mo@]')][0x0]?.[llIill1I(0x299,'Gixc')];break;case 0xa:ilIi1Iil=IliIIIIl+llIill1I(0x2b5,'gceT');break;case 0xe:ilIi1Iil=l11l1lli[llIill1I(0x23f,'Mo@]')](IliIIIIl,0x64)+llIill1I(0x287,'a#96');break;default:ilIi1Iil=llIill1I(0x228,'f8WQ')+I111liiI+'）';}if(![0x1,0x6][llIill1I(0x25c,'OfS1')](I111liiI)&&!I1lIliI1)illl1Ill=!![];II11IIlI[llIill1I(0x248,']OAU')](ilIi1Iil+'（共'+IIlI1iII+'份'+(I1lIliI1?l11l1lli[llIill1I(0x25d,'vKir')]:'')+'）');}l11lIl1i[llIill1I(0x1d4,'aJp]')]({'days':ilil1lIi,'prize':II11IIlI,'havePrize':illl1Ill});}const ll1l1ll1=await common[llIill1I(0x225,'XduO')]({'venderId':I1Iil1l});console[llIill1I(0x196,'Gixc')]('【'+Iil1IIii+llIill1I(0x266,'r&&&')+ll1l1ll1+llIill1I(0x296,'K)oR')+ll1I1Iii+llIill1I(0x235,'OfS1')+i11liii1);l11l1lli[llIill1I(0x1b2,'&emV')](l11lIl1i[llIill1I(0x1a8,'Caoa')],0x0)&&(l11l1lli[llIill1I(0x27e,'lsKj')](l11l1lli[llIill1I(0x1d6,'lsKj')],l11l1lli[llIill1I(0x208,'gXPq')])?(li1I1ili[llIill1I(0x18c,'a#96')]('['+IiIilIil+llIill1I(0x1cc,'h06d')+ilIii1l+llIill1I(0x1c5,'3ik6')),ilI11Il[llIill1I(0x19e,'K)oR')](Il1Iiii1),Illi11l=![]):console[llIill1I(0x17c,'&emV')](l11lIl1i[llIill1I(0x286,'3]G^')](lI1l1Il=>(lI1l1Il[llIill1I(0x1f5,'f8WQ')]===0x0?llIill1I(0x22a,'#5%G'):'连续'+(lI1l1Il[llIill1I(0x174,'OfS1')]<0xa?'\x20':'')+lI1l1Il[llIill1I(0x1a0,'*dlP')]+'天')+'：'+lI1l1Il[llIill1I(0x243,'UilC')][llIill1I(0x212,'VLai')]('，'))[llIill1I(0x1ed,'JqFL')]('\x0a')+'\x0a'));!illl1Ill&&(Ilii11li[llIill1I(0x245,'h06d')](Iil1IIii),I11iiIil=![]);const liIIill=TokensMap[llIill1I(0x182,'e3D%')](Iil1IIii);liIIill[llIill1I(0x1a4,'THyC')]=I1Iil1l,liIIill[llIill1I(0x28b,'02XI')]=ll1l1ll1,liIIill[llIill1I(0x175,'3ik6')]=iIil1lIl,liIIill[llIill1I(0x224,'#kyF')]=l1li1IIl,liIIill[llIill1I(0x222,'e3D%')]=ii1111iI,liIIill[llIill1I(0x1ba,'6D*h')]=I11iiIil,liIIill[llIill1I(0x197,'02XI')]=l11lIl1i,TokensMap[llIill1I(0x244,'CEI(')](Iil1IIii,liIIill);}}if(l11l1lli[llIill1I(0x28a,']OAU')](Ilii11li[llIill1I(0x1fc,'r&&&')],0x0)){if(l11l1lli[llIill1I(0x1e9,'*dlP')](l11l1lli[llIill1I(0x238,'JqFL')],l11l1lli[llIill1I(0x18e,'gceT')])){console[llIill1I(0x1ea,'cP&K')](l11l1lli[llIill1I(0x234,'Suzj')]);for(const lIi111ll of Ilii11li){l11l1lli[llIill1I(0x1e0,'vKir')](l11l1lli[llIill1I(0x1e2,'7kH(')],l11l1lli[llIill1I(0x20b,'NzOH')])?console[llIill1I(0x21a,'e3D%')](lIi111ll):II1I1iIi[llIill1I(0x194,'EAlL')](lIli1lI1[llIill1I(0x22f,'a#96')](ii1IlII=>(ii1IlII[llIill1I(0x174,'OfS1')]===0x0?llIill1I(0x231,'zfFE'):'连续'+(ii1IlII[llIill1I(0x220,'NzOH')]<0xa?'\x20':'')+ii1IlII[llIill1I(0x205,'h06d')]+'天')+'：'+ii1IlII[llIill1I(0x2b3,'vKir')][llIill1I(0x1f4,'02XI')]('，'))[llIill1I(0x229,'r&&&')]('\x0a')+'\x0a');}}else{Iii11I1[llIill1I(0x1da,'gqcT')](l11l1lli[llIill1I(0x1fd,'gG^p')]);return;}}const il1ll1li=Object[llIill1I(0x29f,'%egh')](TokensMap),I1lliIII=l11l1lli[llIill1I(0x2a5,'EAlL')](require,'fs');I1lliIII[llIill1I(0x1c4,'6D*h')](CacheFile,JSON[llIill1I(0x2ab,'EAlL')](il1ll1li)),console[llIill1I(0x199,'Mo@]')](l11l1lli[llIill1I(0x192,'Caoa')]);}catch(l1i11ili){console[llIill1I(0x1c3,'K)oR')](llIill1I(0x282,'cBya')+l1i11ili);}}async function handleResponse(I1ill,llIilil){const liilili=llllIilI,I1lili1i={'iDfNl':liilili(0x1e8,'VLai'),'nnJyV':function(l1iiI1Ii,i1I1lII1){return l1iiI1Ii===i1I1lII1;},'YzhCe':function(i1lI1iI1,il11lIl1){return i1lI1iI1===il11lIl1;},'QemJQ':function(IIIi111I,lilil1il){return IIIi111I!==lilil1il;},'vKciH':liilili(0x1ec,'6D*h'),'npghZ':function(I1lillI,iiIll111){return I1lillI===iiIll111;},'jBDNU':liilili(0x226,'UilC')};try{switch(I1ill){case I1lili1i[liilili(0x273,'Suzj')]:if(I1lili1i[liilili(0x29a,'cBya')](llIilil[liilili(0x218,'gG^p')],0xc8)&&I1lili1i[liilili(0x29d,'gagu')](llIilil[liilili(0x2b2,'*dlP')],!![])&&llIilil[liilili(0x298,'h06d')])$[liilili(0x27a,'cP&K')]=llIilil[liilili(0x210,'02XI')];else llIilil[liilili(0x187,'NzOH')]?I1lili1i[liilili(0x257,'$q7$')](I1lili1i[liilili(0x223,'#kyF')],I1lili1i[liilili(0x1c8,'cP&K')])?i1Ilii1[liilili(0x1fe,'&emV')]=l1lI1lIl[liilili(0x265,'UilC')]:(console[liilili(0x18c,'a#96')](liilili(0x1ac,'LX5H')+llIilil[liilili(0x256,'&emV')]),$[liilili(0x1ca,'LX5H')]=!![]):I1lili1i[liilili(0x25f,'3ik6')](I1lili1i[liilili(0x1a7,'e3D%')],I1lili1i[liilili(0x1d7,'CB^J')])?(console[liilili(0x23d,'%egh')]('❓'+I1ill+'\x20'+JSON[liilili(0x206,'a#96')](llIilil)),$[liilili(0x1c6,'vKir')]=!![]):(II1i11I1[liilili(0x188,'CB^J')]('['+Ili1ili+liilili(0x2ae,'gG^p')),iII1lIIl[liilili(0x1ab,'CB^J')](i1II11li),liI11li=![]);break;}}catch(lliil1lI){console[liilili(0x1b3,'f8WQ')](liilili(0x27d,'gG^p')+I1ill+liilili(0x22b,'Dg&d')+(lliil1lI[liilili(0x184,'lsKj')]||lliil1lI));}}async function sendRequest(lIi11Ii){const iIIllli=llllIilI,Ii1I1I1l={'asqTU':iIIllli(0x22c,'cBya'),'senGg':iIIllli(0x29e,'Dg&d'),'Ekpgr':iIIllli(0x1b7,'JqFL'),'kDLAZ':iIIllli(0x1b9,'Suzj'),'OBCqP':iIIllli(0x1c0,'NzOH'),'AKtVJ':iIIllli(0x255,'#hOV'),'VaYsp':function(lI111i1l,l1lI1111){return lI111i1l(l1lI1111);},'EziiK':iIIllli(0x1b8,'vDMj'),'chSrq':iIIllli(0x27b,'&cWq'),'JkfgA':iIIllli(0x25a,'Suzj'),'vTszt':function(ll111Iil,II11ll1){return ll111Iil/II11ll1;},'wSrhe':iIIllli(0x294,'Suzj'),'BkxHb':iIIllli(0x292,'Dg&d'),'Ipdai':iIIllli(0x269,'Caoa'),'CMMvX':iIIllli(0x28c,'3]G^'),'xgUSo':iIIllli(0x185,'gG^p'),'LxTiE':iIIllli(0x17b,'Mo@]'),'mQNDE':iIIllli(0x29b,'Gixc'),'Kjqoj':iIIllli(0x2a7,'4*PF'),'zcjNw':iIIllli(0x1aa,'aJp]'),'MwxyP':iIIllli(0x291,'NzOH'),'lSOMe':function(ili1Il1,l1I1iI1l){return ili1Il1===l1I1iI1l;},'XUjNH':iIIllli(0x2ad,'a#96'),'rEWbf':function(ii1i1II1,Il1i1ll){return ii1i1II1<Il1i1ll;},'nqxvE':function(lliiiiiI,liIiIli1){return lliiiiiI!==liIiIli1;},'mTpZK':iIIllli(0x1b4,'LX5H'),'uNkPI':function(liIIl1ll,ll11iIii){return liIIl1ll>ll11iIii;},'dkVXC':function(il1iilIl,liiIIlI1){return il1iilIl!==liiIIlI1;},'TSkFD':iIIllli(0x29c,'#5%G'),'smIdL':iIIllli(0x1d8,'Suzj'),'AOtUF':iIIllli(0x24a,'VLai'),'QgusU':iIIllli(0x207,'lsKj'),'fczGH':function(iI1iiilI,l1lliIll,liI1li1l){return iI1iiilI(l1lliIll,liI1li1l);},'ZBVjh':function(ilIl1lI1,Ii11iii1){return ilIl1lI1>=Ii11iii1;}};if($[iIIllli(0x186,'gceT')])return;let l1lIiI1l='',i1lli1li=null,lllIl1=null,lI1IiIIl=Ii1I1I1l[iIIllli(0x26a,'4*PF')],II1lIl1I={},IlIii={};switch(lIi11Ii){case Ii1I1I1l[iIIllli(0x1ee,'gceT')]:IlIii={'appId':Ii1I1I1l[iIIllli(0x22e,'gXPq')],'functionId':Ii1I1I1l[iIIllli(0x19a,'fwnz')],'appid':Ii1I1I1l[iIIllli(0x2a4,'Dg&d')],'body':{'token':$[iIIllli(0x23e,'vKir')],'venderId':Ii1I1I1l[iIIllli(0x2b0,'6D*h')](parseInt,$[iIIllli(0x1af,'zfFE')])||''},'version':Ii1I1I1l[iIIllli(0x19d,'$q7$')],'ua':$['UA']},II1lIl1I=await H5st[iIIllli(0x20e,'&emV')](IlIii),l1lIiI1l=Ii1I1I1l[iIIllli(0x178,'r&&&')],lllIl1=Object[iIIllli(0x1dd,'UilC')]({},II1lIl1I[iIIllli(0x293,']OAU')],{'jsonp':Ii1I1I1l[iIIllli(0x247,'gG^p')]});break;default:console[iIIllli(0x2aa,'Suzj')](iIIllli(0x1be,'Dg&d')+lIi11Ii);return;}const iIilIlIl={'t':Math[iIIllli(0x237,'Caoa')](Ii1I1I1l[iIIllli(0x216,'Caoa')](Date[iIIllli(0x270,']OAU')](),0x3e8))+iIIllli(0x1cf,'6D*h'),'loginType':'2'};i1lli1li&&Object[iIIllli(0x1ce,'THyC')](i1lli1li,iIilIlIl);lllIl1&&Object[iIIllli(0x22d,'gqcT')](lllIl1,iIilIlIl);const lI1iIII1={'url':l1lIiI1l,'method':lI1IiIIl,'headers':{'Accept':Ii1I1I1l[iIIllli(0x20f,'gqcT')],'Accept-Encoding':Ii1I1I1l[iIIllli(0x213,'&emV')],'Accept-Language':Ii1I1I1l[iIIllli(0x264,'r&&&')],'Connection':Ii1I1I1l[iIIllli(0x1b6,'e3D%')],'Content-Type':Ii1I1I1l[iIIllli(0x20c,'lsKj')],'Host':Ii1I1I1l[iIIllli(0x278,'&cWq')],'Referer':Ii1I1I1l[iIIllli(0x281,'K)oR')],'Sec-Fetch-Dest':Ii1I1I1l[iIIllli(0x288,'&emV')],'Sec-Fetch-Mode':Ii1I1I1l[iIIllli(0x258,'Gixc')],'Sec-Fetch-Site':Ii1I1I1l[iIIllli(0x1f6,'gceT')],'User-Agent':iIIllli(0x232,'zfFE')+Date[iIIllli(0x18a,'$q7$')]()+iIIllli(0x268,'gXPq')},'params':lllIl1,'data':i1lli1li,'timeout':0x7530,'httpsTlsOptions':common[iIIllli(0x221,'Mo@]')]()};Ii1I1I1l[iIIllli(0x24c,'THyC')](lI1IiIIl,Ii1I1I1l[iIIllli(0x1fb,'Mo@]')])&&(delete lI1iIII1[iIIllli(0x260,'#hOV')],delete lI1iIII1[iIIllli(0x24b,'cP&K')][Ii1I1I1l[iIIllli(0x259,'gagu')]]);const iil1I1l=0x1;let ll11iIl1=0x0,ll1lilIl=null,iI11llIi=null;while(Ii1I1I1l[iIIllli(0x21e,'LX5H')](ll11iIl1,iil1I1l)){if(Ii1I1I1l[iIIllli(0x202,'#5%G')](Ii1I1I1l[iIIllli(0x21b,'02XI')],Ii1I1I1l[iIIllli(0x1f1,'EAlL')])){il1liIIl[iIIllli(0x241,'$q7$')](Ii1I1I1l[iIIllli(0x272,'3ik6')]);for(const IIlIIII1 of l1li1iI1){ilI1i1II[iIIllli(0x20d,'#kyF')](IIlIIII1);}}else{Ii1I1I1l[iIIllli(0x1db,'e3D%')](ll11iIl1,0x0)&&(Ii1I1I1l[iIIllli(0x28f,'4*PF')](Ii1I1I1l[iIIllli(0x21d,'K)oR')],Ii1I1I1l[iIIllli(0x283,'VLai')])?await $[iIIllli(0x1a2,'e3D%')](0x7d0):iIi1l1Il[iIIllli(0x1ce,'THyC')](ii1iii11,lI1lII1));const lI1llIiI=await common[iIIllli(0x214,'%egh')](lI1iIII1);if(!lI1llIiI[iIIllli(0x267,'VLai')]){if(Ii1I1I1l[iIIllli(0x240,'Caoa')](Ii1I1I1l[iIIllli(0x217,'02XI')],Ii1I1I1l[iIIllli(0x1cd,'K)oR')]))iIlilill[iIIllli(0x1c7,'lsKj')]('❓'+Iillili1+'\x20'+lii11Iil[iIIllli(0x236,'gXPq')](IliIl1Il)),iIlllilI[iIIllli(0x2af,'Mo@]')]=!![];else{iI11llIi=lI1llIiI[iIIllli(0x215,'CEI(')],ll1lilIl=iIIllli(0x249,'gceT')+lIi11Ii+iIIllli(0x263,'&emV')+lI1llIiI[iIIllli(0x1a5,'vKir')],ll11iIl1++;continue;}}if(!lI1llIiI[iIIllli(0x284,'aJp]')]){ll1lilIl=iIIllli(0x233,'gXPq')+lIi11Ii+iIIllli(0x1d3,'CB^J'),ll11iIl1++;continue;}await Ii1I1I1l[iIIllli(0x209,'fwnz')](handleResponse,lIi11Ii,lI1llIiI[iIIllli(0x2a2,'VLai')]),ipBlack=![];break;}}Ii1I1I1l[iIIllli(0x200,'zfFE')](ll11iIl1,iil1I1l)&&($[iIIllli(0x26e,'aJp]')]=ll1lilIl,Ii1I1I1l[iIIllli(0x290,'cP&K')](iI11llIi,0x193)&&console[iIIllli(0x177,'gagu')](ll1lilIl));}function ill1lIil(){const l1ilil1I=(function(){return[...[iｉl,'QVGjCWsuyjkMiTJaDmdhPi.xecMOoBWmYJX.TvN7==','tSohkISR','nEISGEAWNUwMJEI2PqZINAK35PAq5zcx5BIi5PEs5OYd','W7bryeK','WO7cUCkWeXddGSo9','W5BdPu7cUCkC','F8k0gmoYW5u','WQf/qWxdGa','y8kpfXVcQ8kFd8kfuGPfi8kJW54X','WRjDdW','WOvTW7JdK8kp','W5FdNG3cVSkT','q8orlYCGFa','yN0dWOqxCaFdG2JdQW','W5ZdOMin','e3qQkmk2','wqrWWR8QW4CpWPdcG8kZyISsWRldIG','WRLcWORcUdu','WQzWttZdGq','W7tcUHG','W7VdQrBcQCk2mHZdRKJdHYeixXyZ','hee4iCk+','WROcFbLc','WRldUqm0jY7cLCkkWRJdPWOcfCoxWQG','qahcPMe1','WQrxWPu','cHC2W47dQNzeW7NcPfenW7RcHYRdRa','W6dcOCkzy8k8','WR/dL8o1W5W','WO8YWOxcMSov','y3VcQgFdQg8xhmoK','kaPSed8','aHTSea4','dmohsmoEzmoIymowmaBcMqTZiW','y8kaWPZdTctdOmoVW7/cNSkge8oBW4VcGCkXW60','W5rkt8o7','WR93tSoK','WOCUWO3cHmo3','WRtdVWmCmJpcImkfWOldPXi/dSoc','WQxdQqqD','E8kdmCoEW6vE','W4dLUOZORiRNPPVPMlpNMytMT47LIABVVBO','WQWEW7FcUmk5','Amkpdt3cVmkd','FdzXWRGi','W4/dRNSPW7m+WQP9aXtdTSoiWOhcV8oO','ntxdOei','WPa0W7ikpW','gGPigc0','pZ7dQfpdUa','WPS6WOhcN8oR','mmo0DmoFtSo/','WRzVW5Ly','WQKRW5hdGZyjgWWT','W63dGMJcJCkQ','pLyVCSof','imo+W5ldMCoi','hSoSt8oQqW','fmowCmoDDW','W5tdK1RcM8ka','ar0L','W4/dRNSGWQu5WRC','WQLHgKKE','W5PeuSo0','l8o8W5nsW6a','WR/dSX4B','W6RdOhCGW7i','W67dQrpcNCkWnqe','h33dGG0eW6u','WRKqzHz3','W79QuSoanG','xq5GWPS','W6W1W71YDhddL8oTWR02fmkSW4a3','WPXmW7q','W5nXvSopoW','nSoCuw7dU8oDumkqAZT0c8kB','tSkQWO7dI00','jSkiWRGQWRq','E2eCWP8EsXBdRM7dK3ddUbi','aSocBSoj','WQOiW7ZcVSkUW5CJBrS','WPvnW7FdL8kVW6r2','gZKHW6BdGq','hGyJW73dVvzeW6lcQa','W6eJW6niFxldJSknWR80ha','uCoXpHW2','4PUgWOpOR6dLH7lLRO7KU5RLV4hOPiJNM4dNJ4BLOBhLJRBPH5lLKz7LH63OV6ZOO67OHklMNkRVVkq','5P+X55+Z5AwH5zgw776v','BSkfcJq','5Q6E5PAQ56+U5yIv','W4JORkFMSPZLKR/LU6JcJG','bow4LUIULUEKL+MBN+EBP+A1PEwjS++9Ma','WR9bg0GCvq','l0mIqSoS','WRC+W5m','ccPOcYBcK8kvCqxcKsmSEaNdKW','5QYf5PAt56+A5yMq','WQasW4uqj8o7WPZcNGJcJmooD8kgW71vi8kUb8onDIJcJSo3W6hdVmo9wGdcLmorbCo9W58ffXmYWQNcQ8oJdCk6WP9Tc1ZcKSklxrrfW6dcPMKZWQRcHSooWRRcVeZcJ8k2gcnRjMr+n8o9BCoHkmkCW6FcLZVdJ0tdQKpdHIWGW4NdNCkSktVdMLRcS8olWPGJoCk5WQ7cUSoWWR90W5VdNCkdW5RdSmklqSojWO4OWPesjSkcWO4uWQ0LWRRdPCoZW6RcKIVdT8kZWPfOWOjDvhNcICoQhZFdVCkPW7xdN8oGzSkoW4lcMCkVqSk9hSozESkEWPC+imkxWQ/cVCo9jxTeFf9cW6tdRwtcLmotWO5zW6xdUmkjk8ovsbPeWQ8BW6W3W7K0W4bNWPpcQ2ZdHwSCW6mrWOtcQ8o9veFcKJiUa3mjWP/cHbVcGsVcTZpcKqNdMZ9UwczLpmozWPjCWOhcSmkbW6uIiSkjWOBdMITXcY4KWQeuW78','8k6ARe4','WO1YxqVdMG','y+E4SUACHUAuJEMwI++9Ra','n3mCASoyagNcOca','WQKOEGnX','WPNdLCoWW5NdTa','57+j5AYh5ys65yEp5A+u5Q67Ea','WQBdQbyhma7cLCkrWRq','oIjnW5XokI3dL0xdKfBdIq','5l6a5Oc15yMh'],...(function(){return[...['W7ddOWu','eLKglmkk','WPKSW5FcT8kR','WQmxwIfM','WRHxWRq','z8kPWQOoWOJcPaG','uSoqntqI','h2ZdLW','WQj7W5nd','W61nWQ/dI8oQWPmDEa0GjqW','DaPIWPKi','E2ygWO0','8y27SSov','WPpdTWuqaa','WQbDWPpcTmkiWR9C','W7tcHJapW68','W7yZW6rZ','WRddISoUW7/dQ8og','ad14gdW','WQFdImoZW4VdLq','F+++UoA1P+wlPUw2TEE7GEAFKa','lCoVyG','lspdTW','zh/dL3ZdK3O9pq','mCkmaSkhW6HdWQOfkhldQeiCW5OMr3DEWQLI','W4xdUgG','WOvDWR5MmW','uf7cLv3dPa','iSoFfCk0WO4','WP5GsWpdPWtcNelcHG','xXj3WPCUW50','amkpoSkxcHjwuG','b3S9hmk2','vU+8IEA1JUwjJEwXVEwCSum','lCoWCSodyq','pmkdaSkd','rCohka8KzSoMb8ktWQuZAmojWO3dJq','vCohuSo8tSobCG','WOJORBZMSy3LPzNOTRvQ4P2FkW','tCkAbZVcOq','rSodkc8','44cvW6dLU7tPKQdLK4xNPjVVVBZdKa','WQBdQrqwisNcJW','ytuTjSkevwJcOJa6WPnWlMpcVZFdT2rRW7CwW79xqhldGSknW6D+istcJH3dVItdOIRdGJVcUZpdUCknWQFcLXfqo37dHCoDW7FdT8oruZDXWR9Jw8k3tmo9FedcMCkRWRP0W5bnW5FcPI5vW6hdVSkqz8k3rCo/W5RcOmo6WONdKSo3WQZcRSosnZ0EW6pcNWBdJ3/cL8kcBColW5CWwXBdPMtcQsldJGdcHcVdPCo1BbtdPZtdKCopWRnGW5ddIXeZthKTdXFdSWf0wZtcMSo9WQNdGmoFW4D+WQPZWOrxW4iJr8oaW4fAW481kCkwrmorg8kFa0bzW77cL3XFWQdcP8kBWOpdGHpdT3/dHaJdUcjbBmk+WO7dRmkhcHhdKSkXAYVcUIFdT30+g8onvddcLSkwWOCVW4bXW7iIW6ZcUSobumkElIpcLSk6ECkRqSk7W7xcJIeQW7BcNavuWQTSW5uYxSk4oYKUWQtdS8klBMnRyIb5jbJdQSoCWP/dVsDbW6xdSCkrEhZdOCkra8oRkr7dOmoObSkNW4xdIWGemG9VC8kmEeJcQmoDF8kJWQW','WRuSoc9nqdBcKa7dH1ldVctcSSkOWQJcKCo7BW','mINdVMdcTG','nCoBw2pdVCoykmkMDtfZka','uCkRWRddTeG','WQNVViNMTj/LI4xLTAxKURVcJa','W6vwywWRWOS','WQldMSo/g8oNoSkyWRWNWRWYuWK','zxWc','wKJcJhS','iSoZzmo/BG','WP1xqIpdUW','WR8FWPZcImoM','W6JLVlJLPlNVV5ZMMRFNGBtLHQlMNl7LKPldRW','W6hcICkOWOlcRSksW5TyWPlcLZObjsa','W4utW5tdMSkOW5b+dG','dCoxW4fpW6S','W4P0Cg0n','WQ9DWOBcKCkoWRLglCoCW6v/zSohWQOH','kCoBW6fwW53dSSozed7dOmo0WRxdMSoQFmonW4NdHYOhW6BcTLCP','mYndW5fkksVdLeldT3xdMq','4P2YqEACRUIaG+ASQUEJNEwLOUEtOmok','W57dLx3cQCk7','5BQP6zkB56ER5yU4','xJVdKXyEW4udWOW','D8kOWQVdIuW','4P2cW4ZOHklMN4dOVAVOOk/PGjNLI6VKU4tPL7lORPqy','WQBdSt4rca','W6rfz0a','WRnZWQyIisZcJSk2WQ80d8oWW6e','W73dSqC','5yAz57U95y6M','W6pdOx4hW7O','WROvW73cQ8k3W4Os','wh4KWRm+','W41nsCoLpSkvF8oq','W7VdTrjOWPP0D8kzWRVdGG','AhibWOyt','WQlcOGD3W5HgvCkG','jsFdHN/cKG','WQXtWQtcImkU','fCocESoFoCo8DSoGiWdcNa','WO/cQSk3aLdcJSoGW6FdM1TjWRKRnmkZW4j0','E3ihWOqwAIFdO3/dVG','W548dG','W6Dbz2a7WPJdRmo3l0pcPZtcJ8k/W5O','eow/UEwKRUAvU+MxVE++TW','W6NdLqZcQ8kt','WRzVW5rk','wvBcIL3dSI5O','ymkcCSkvW60','qKNcI2pdOhKIx0DFWRvKW7ddQN1gomokmZm','iJxdTv3dSq','i8oWf8k5WQm','WQ/cLCkk','W7RdVG3cHCkqkahdQKJdLIS','WR5lWRLfa8ocW6dcTKldHSorWPjSWRW','tmk8WOVdUwa','WRhdVqmu','e8oKcCkBWQRdHGeXWQtdSG','WQNcM8kQjdy','nWn0dcm','Emkxla','mI/dOK7cOCk7','fmoxumo6Ea','pmoyamkUW64VgCkDfa'],...(function(){return['WPH8qW','hdTUiYVcGmkvyru','WOtcTCkWfqJdHG','WPKWW43dNJ0abKCaA3BcKW','y++9U+A0V+wjLUw2U+E5OoACUq','WRyvW6/cNSkYW44tqaSr','W4hcJSkxuCkJ','tab2WP8D','qrxcT2meW68T','fKqem8kb','CSktkmo9W6nyWPXHgCkUW6xdQWm1W4G','5yAjhowoLa','dCkaimki','iSoJyCoctCoLW7PAWOq9','DmkRWPRcQSkZW7ZcUcddG8kufmoIWOG','fSoLga','z8kcmcJcUq','osDnW5DcyaRdLwFdMg8','W4mDWPTjba','WR4lW7ddKCkZWOKDzuygpcC','W4tdPgG','kgGj','W6RNUQxMN7VVVAZKUzZMR6hMLjZNGBFMNixLK4tdNG','rLJcKxtdPYS','WRGLFbG','WQrRW45pWRJdNXaY','WPDgW6C','W644WOPDpa','W4hdKxZcU8koWO3cTG','sGr8WOPMW4mkWOFcG8kP','WRGSWPVcUmojfq','c8oqCa','ECkzoW','hqaRW7xdRe5eW7ZcUq','WRPxWQq','jSk9WOaXWP8','WRyWW4q','WR42WP7cMmoj','WPG+WP7cRmoO','jcldPG','WOOueSkLrSohjSknsh7dVCkXWOJdVq','4P2MhEInIowpHEA2QowlQ+s/RoAaN+wKNUI1JW','WOGgrZ9k','smk8sCooW7lcMW8jWQldG8oJW5m','aYb7','Bv7cULxdGW','rLlcMa','W4XqsSoWaW','nSoEw2JdSCksd8kKvZLk','WRmuW74','cCoFW6VdR8oq','lmkxgCkKW6W','W4VdKxVcICkmWP7cUSkvW6VcLSkgW411W5HW','WPfcWRPfkq','ASkmWPBdPq','jSokW6fNW43cVmkFstBdPmoKW5ldMCkIEq','vGhcRxm','ECkwWOVdUwddG8oxWRFcQSkqwSoPW6BdQCkPW6ZdJhtdQmoVWRq','WODcW7RdTW','WQmRCILXhG','W67cSbeMW68cWP0K','a0qFjSkw','smkBWOtdLhG','WPPHW5FdJCkt','WQmHEWT3ba','oCoKqCoouW','W65lpKi3WP7dTG','zCkdl8ou','8kQzPSop5P6T6kYW5REn5yUw5l205OgM5AAB6lwDWOlINknc','iCkismkDW588kSk0kCkofwhdHx7cKrbJ','W7HUW4ZdJCoJcZy5DXu','WRWtW4OemSkYWRZcQG','dSoJeSkF','WQ8eW5yTjmkN','W5ddIL09W4q','WRD5ua','pmklWQKyWOq','W6rnyei3WPNdQ8o1','WRnUW57dTCkE','WRldNCoOW7pdU8ovWOywWOhcKGisjJb/','WPHbW4S','W4b3rv7cPa','W77cNmkyq8k/ySom','WOmOW4ddQt8','WRyvW63cMSkSW4yuDtGxoJddG8k+CSkuo8osWRy5','WOeKW4S2lW','4P6KW7dMN7tNNPFOROVMS6ZcPa','W7KaW5tdRXieW6VdNmkRWRe','d8ony8oFzSoYz8o9gWRcLWbPnrjJW5fqAvv+W4pdHKVcJmomq8opDSkkjtJdKHHMW7VdISkWW73cSa','uCosmcCZ','mSkKWOm8WRFcHa','DSkwWOi','W6dcNCkNvSk2tCobWQuZWOi9tZ0','y+w+GowNNU++P+AzOEEaTEweG+ADHUwtQIC','d1GBkmkiW4FdISoYv0y','W4ddM2G','WR5ZWPhcUCkL','W63cImkQWOBcQCkrWQC2WQhcJHCj','pCkJWPKPWR7cNXRdLgRdNG','iSoYW4BdUW','WO/VVjtMTPVLIOpLS5VLNOv5','s8kEWPddVLW','W7NcPGWRW60E','WQFdN8o+','77+g5BAR5yYK5A2X','W63dV3ySW4a'];}())];}())];}());ill1lIil=function(){return l1ilil1I;};return ill1lIil();};var version_ = 'jsjiami.com.v7';

// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
