/*
活动名称：批量店铺签到（活动查询）
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号分割

查询活动信息主脚本，IP限制严重建议使用代理，请勿频繁运行
自动去重并过滤无效活动，默认过滤垃圾奖品活动
运行后会在本地目录生成缓存文件以用于签到脚本使用

7 7 7 7 *

*/

const $ = new Env('批量店铺签到（活动查询）')
const common = require('./function/jdCommon')
const { H5st, jsTk } = require('./function/jdCrypto')

var iｉl='jsjiami.com.v7';const il11lIii=lIiiiIi;(function(I1illiI,il11l11i,iI1il1II,IiiIl,ii1llI1I,I1i1iIl1,iIIIllli){return I1illiI=I1illiI>>0x1,I1i1iIl1='hs',iIIIllli='hs',function(i11iIiIl,iiIIlIli,iilIi1lI,IIIiIll,i11l1l11){const I1I1IIil=lIiiiIi;IIIiIll='tfi',I1i1iIl1=IIIiIll+I1i1iIl1,i11l1l11='up',iIIIllli+=i11l1l11,I1i1iIl1=iilIi1lI(I1i1iIl1),iIIIllli=iilIi1lI(iIIIllli),iilIi1lI=0x0;const iIl1iiIl=i11iIiIl();while(!![]&&--IiiIl+iiIIlIli){try{IIIiIll=-parseInt(I1I1IIil(0x1e1,'eR2)'))/0x1*(-parseInt(I1I1IIil(0x19c,'xA#I'))/0x2)+parseInt(I1I1IIil(0x23b,'azoe'))/0x3+-parseInt(I1I1IIil(0x15b,'^sRf'))/0x4*(-parseInt(I1I1IIil(0x16d,'[IcY'))/0x5)+parseInt(I1I1IIil(0x21e,'#@mg'))/0x6*(parseInt(I1I1IIil(0x172,'3WWY'))/0x7)+-parseInt(I1I1IIil(0x190,'^sRf'))/0x8+-parseInt(I1I1IIil(0x170,'&zt0'))/0x9*(parseInt(I1I1IIil(0x1c6,'ldfJ'))/0xa)+-parseInt(I1I1IIil(0x21d,'4%zx'))/0xb;}catch(iii1lllI){IIIiIll=iilIi1lI;}finally{i11l1l11=iIl1iiIl[I1i1iIl1]();if(I1illiI<=IiiIl)iilIi1lI?ii1llI1I?IIIiIll=i11l1l11:ii1llI1I=i11l1l11:iilIi1lI=i11l1l11;else{if(iilIi1lI==ii1llI1I['replace'](/[UHCAhbKfYVIuEWBTwpLR=]/g,'')){if(IIIiIll===iiIIlIli){iIl1iiIl['un'+I1i1iIl1](i11l1l11);break;}iIl1iiIl[iIIIllli](i11l1l11);}}}}}(iI1il1II,il11l11i,function(I1lllIi1,IIilI1lI,lliiIi11,Iil11,II11il1i,IliiIIiI,IIi1ii11){return IIilI1lI='\x73\x70\x6c\x69\x74',I1lllIi1=arguments[0x0],I1lllIi1=I1lllIi1[IIilI1lI](''),lliiIi11=`\x72\x65\x76\x65\x72\x73\x65`,I1lllIi1=I1lllIi1[lliiIi11]('\x76'),Iil11=`\x6a\x6f\x69\x6e`,(0x15c2f8,I1lllIi1[Iil11](''));});}(0x17c,0xb465e,illlillI,0xc0),illlillI)&&(iｉl=`\xca6`);let tokensList=(process[il11lIii(0x199,'p[kG')][il11lIii(0x224,'#@mg')]||'')[il11lIii(0x17c,'Shq5')](',')||[],TokensMap=null;function lIiiiIi(_0x53f53f,_0x1c9dfb){const _0x2b0258=illlillI();return lIiiiIi=function(_0x31e2c7,_0x3ad9c6){_0x31e2c7=_0x31e2c7-0x133;let _0x257171=_0x2b0258[_0x31e2c7];if(lIiiiIi['ZIEduJ']===undefined){var _0x2ecd7d=function(_0x255477){const _0x22f557='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x8c6fa4='',_0x51042a='';for(let _0x5735c8=0x0,_0x4ca0d2,_0x3da23a,_0x27a6d9=0x0;_0x3da23a=_0x255477['charAt'](_0x27a6d9++);~_0x3da23a&&(_0x4ca0d2=_0x5735c8%0x4?_0x4ca0d2*0x40+_0x3da23a:_0x3da23a,_0x5735c8++%0x4)?_0x8c6fa4+=String['fromCharCode'](0xff&_0x4ca0d2>>(-0x2*_0x5735c8&0x6)):0x0){_0x3da23a=_0x22f557['indexOf'](_0x3da23a);}for(let _0x279752=0x0,_0x40aa42=_0x8c6fa4['length'];_0x279752<_0x40aa42;_0x279752++){_0x51042a+='%'+('00'+_0x8c6fa4['charCodeAt'](_0x279752)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x51042a);};const _0x86f76=function(_0x2771aa,_0x59fcd5){let _0x442ebb=[],_0x5144e8=0x0,_0x256c22,_0x48bdfd='';_0x2771aa=_0x2ecd7d(_0x2771aa);let _0x2b47dd;for(_0x2b47dd=0x0;_0x2b47dd<0x100;_0x2b47dd++){_0x442ebb[_0x2b47dd]=_0x2b47dd;}for(_0x2b47dd=0x0;_0x2b47dd<0x100;_0x2b47dd++){_0x5144e8=(_0x5144e8+_0x442ebb[_0x2b47dd]+_0x59fcd5['charCodeAt'](_0x2b47dd%_0x59fcd5['length']))%0x100,_0x256c22=_0x442ebb[_0x2b47dd],_0x442ebb[_0x2b47dd]=_0x442ebb[_0x5144e8],_0x442ebb[_0x5144e8]=_0x256c22;}_0x2b47dd=0x0,_0x5144e8=0x0;for(let _0x126c41=0x0;_0x126c41<_0x2771aa['length'];_0x126c41++){_0x2b47dd=(_0x2b47dd+0x1)%0x100,_0x5144e8=(_0x5144e8+_0x442ebb[_0x2b47dd])%0x100,_0x256c22=_0x442ebb[_0x2b47dd],_0x442ebb[_0x2b47dd]=_0x442ebb[_0x5144e8],_0x442ebb[_0x5144e8]=_0x256c22,_0x48bdfd+=String['fromCharCode'](_0x2771aa['charCodeAt'](_0x126c41)^_0x442ebb[(_0x442ebb[_0x2b47dd]+_0x442ebb[_0x5144e8])%0x100]);}return _0x48bdfd;};lIiiiIi['woLKcV']=_0x86f76,_0x53f53f=arguments,lIiiiIi['ZIEduJ']=!![];}const _0x1d53b0=_0x2b0258[0x0],_0x31b796=_0x31e2c7+_0x1d53b0,_0x503844=_0x53f53f[_0x31b796];return!_0x503844?(lIiiiIi['XKIfsk']===undefined&&(lIiiiIi['XKIfsk']=!![]),_0x257171=lIiiiIi['woLKcV'](_0x257171,_0x3ad9c6),_0x53f53f[_0x31b796]=_0x257171):_0x257171=_0x503844,_0x257171;},lIiiiIi(_0x53f53f,_0x1c9dfb);}function illlillI(){const II1IiIl=(function(){return[...[iｉl,'TjfCHsUjRwiauAmBTi.fcIEWofmL.bvY7ACAVhpK==','mKPgEColWOZcTCkshM/dQCk7','W7LpWP4','W6CwW5rBoa','W5b9W5pdUJhdHv/dUG','WQbxWO4dE8oUn24GBqS','WPpcTmkmWPSOW4rwvmobW5uxpqBcNSkwWPVcRCk5sW','tapcQNNcSG','W5JcRwZcJvyP','WO4mhCo0Ca','qCoJW558W7FdJq','W5iqys/dGa','DsJcIgJcJ8kRbSkSxutdItrfy0fcx8keW7VcSG','Feqx','WOxcS8og','emkHWQixW7m','4PIDpoITNowhVUwVJUs7UUw/V+IKL+EAVUEoL+wJPowoTEMfKEwrQ+whToI/UEIJNoIhI+ADL++/Vq','W63cNvy','k8ooW4C','W7euW4P/p8om','W5FdOHVdRHbA','yYVcUW','f0NdPGuS','W7FdSe8+W6FdVCoNW73cVSoXt8k7W7G','CoISJEAWGEwrGEw4Rqy','W7XbW5dcVq','eSkKWRtdKvC','l8oaW53dLCkhjq','4PYlWOhMNOROG7tMRyVNOPZLPkFNKke3','WQpcRHjBWRBcOmkY','b8kKWQ/dHeatoSourCk8WRhdPZK','yXj9j3G','WRPTWQO','l2JdJIpdJmoguW','WPRdMmoX','WPpdPCozg3yLWOddUW','W70OW5RdU8kW','W5BcP8oijKSTWPhdM8kt','W6lcJfdcMvK','W6r2WR8JvW','WONdI8oZtIfkWO93WOlcLhGBvSoKmG','dSoZW4HStq','b0VcOCoKEW','WPW4BhhcKHK','WQRdIslcPZS2pKyxWPP2pCkt','ECkiW67dV8oXasq','s3pcQgRdTSon','hmo/W6CBW6JdLq','8lQkI8oz','WQqQBmoyCCkEjW','5yEA57UO5yY0','WPFdLmoIbKaMW6n9WOBcPW','4P+XpoAEGEEDK+IUO+AZSrO','W5CcW6xdUCkQ','tqFcMwFcQq','WO5hWQZcSd4','WQdNV4VLRzRLHzhLHz3LR4hMRlC','W5ihW5P+iW','yCoUW5a','AsVcOGu','W5ldSbhdTa','WQX3WR3cIs1yganZ','W5xcQ1BdMhO','WOJcOgFdPSow','W68ZW6W','W7JcLN/dSW','WOxcUCopWR8sWOa','rmoNW7/cIXfZFmoauCk7WPRdUsS','BHhcTv8a','g8orW7qYW68','W5RcRxhcOa','WOGSwfVcGq','fSoDkSob','WPOUA1NcLGncsqpdH20qgmoMzW','hmkRWO4+','iu9dmSov','f8o1W7qFW7NdK8kRB8k4WQJcGxxdKZVdTW','k1i7EahdUGNdV8kiW4KVW6q','W7FcLNW','mgRdIbyI','W7qJxXNdTSoBvdm','mSowW4ldNSksiW','FMq6A8ko','bs4Ocra','cfRdQtaj','W4LoW7pcM8kN','btGZcq','WQJcRWe','hmo/W6C','F8kuW50','W7WsW4Xcp8krFW05DJxdRmo+fSo1WPxdHreCxvtcJ8oGoa','WQJcR1TSWRdcV8kK','W7/OR7tMSP7LP4ROTBWS4P+TtG','W5rYW53dLZJdML7dL1Lm','eKldPGeSW7Xgz8kenq','W78NW4ZdUmkq','vglcP3NdT8ow','WOFdQbONW47cSW','b3ZcHa','Fq3cQLGwW7W','rSkUp8kkEw8lhaCiyeXImCoxW7eUBr/dQG','WPbYWPBcGXq','WQGUDmop','zIhcQra7oNxdHW7cTG','rxb1xuNdUMxcLt3dSKa','WRPXWQ7cTIPR','W4X8jYJdHuqEcYxdGMeybSoY','iSkWWP1via','pmk2WRr8aq','WOtdRvJdU0ripSk6ya'],...(function(){return[...['WQuMlCoI','jgDtoq','W7ayAdRdKa','i09CpW','5RAJ5yQh5Bgk5zYUW7G','E8oKW5NdQN/cVxny','W7uvW4TBk8of','rSkxe8kQxG','W7uLvG','W7DBW5TsBa','W5RORlVMSAhLPRtOTRDZ4P+BW4JMLzRLKQ3LU5NMLQpMJj8','hCoXW7a','5yQm5B2C5lQK','W4RcSmopo1Oj','DHFcOq','W4CSW7bMyCoVahmCtMK','W7jfWO0qBSo9W6KlW7hcI1X4WQDxWPq','lSkWWR/dQe8','W7ZcG3ldPI8MANSeWRDNb8kDW4bgWRz3','mJq6jrK','W4tdMtLLWPS','AaBcPZHx','WRiZomo3r8on','WQRcS8opWQWdWOzyeCk4W6qgnG','W74jW5fC','WOikW6pcVSoH','rZTjB1Tz','bmoMW5NdGCkW','BdpcJ2u','emkZWRldV0y1jSoosCkeWQhdNspcJM0','ytbIwM8','gCkPWOmKW5r4W5TiD8kQoK5Sgq','jCoioCoWW5C','bmk/jmoHW64','W7/cPmo3h0G','5ysqF+wnJG','vxGjC8kd','WQS/BxNcLa','iLr9cCo7','BZtcOcr7','dmokW61otG','W6yMW5JdHSkE','n8kFn8onW5PsW4OdzcddLCkhCNWV','sYDytL1AnSog','cmkGWQW','ECoKW4/dUJxcV1zDW50h','W4Ctz8oLWQlcHq','W7nTW5rnxa','W51EW4dcLmki','CcNcMW','e8k3WRldNW','WQSQECo0iCkFia','4P62W6ZOHlNMNQNOVylOOj/PGidLI5JKUlZPLBNORQldMq','WQyfp8o2Ca','e34deHGnzSkbW7pdU8kkjtrp','WP7cQL8pW4tdNCkNcNL/W49/','WOZdQaatW5lcTmoYcCoGBLy','WPCKDNy','5BIm6zcd56E05yQq','uY1bhLq','WRRdHCofzYG','W4pdVZjBWOlcLmkRgebtW7fOrmkg','WQhdSSo9bN4','WOFcJmocWPOh','WRC2z8ovW6BcHMHKW5ZdQf7cPComlaRcHYC','g8koWOtdTeq','AdBcVI1Lpa','pSkFWOJdI2C','WO/dRa0Z','W4eCW6VdUCk3W4DbFMtdG8oOW7WW','WPXho8kYW6ddLuCksmo0yGC','W4alW6ZdQCk3W7nHDG','ndaccX0','W6BLV4dLPR3VVipMMOxNGBtLHzRMN4dLK6ZdJJu','5RsR5yQd5BAc5lQQW7S','EJtcK2dcUmkgf8kWqetdIa','W6HAp24','W6SIE8onW7y','8koyU8kG','FI/cUs53nNW','5B695AEx5PwD6zwc772o','W5OVrmolWR4','kCoXW4nlsq','W7zWW74','WQJdIclcOZC0pwytWPbehSkE','W4dcRgpcNu4','q8oJW7BcIHv0kSoqsmkhWQJdGq','mmoaW4L9','BCkWm8kora','5RAJ5yQh5BA+57Uv5P6hW5e','WP5gCCofWO7cQvCu','WOBdGSoLbW','WP7cRvFdPa','iMTpkCowyvu','W5NcSg3cUhySWO/dHa','BZlcJMtcK8kpcSkKua','DdhcS14R','WPVcNCo1WRO0','gwLqh8od','W7HBW4JcSmkc','W4tcJSkMwWD/W5jXWPBcJaFcHG','rYDFDKftnG','m0qH','BIxcUan+','dmojW7Pasq','W49NkNpcSa','W4CzBG','f0NdVGC0W70','jMNcMCo4Ca','FHBcTgeaW6K','W5L1W5JdLtVdHLtdOG'],...(function(){return['W7aMy8ouW7hdOZmKW5/cUb7cU8omlb3dHIOlWOeTDCkuWQatx8kSW4ijW58HCmoZmHhcKIpcPSkkW79GmvlcQmoNW5HrWRFdLJ9+rXpcV8k1W5hcImorqSkTzmoIWPLZWQJcObFcMZmpWO3dHCoNW58','yxBcN13dPq','W7mdW5zNdq','WP7cRCovWPuw','W7Pmk2xcJW','yJ9ph8owsLfn','aCkZWQJdMKaZbSoC','W7n3W61OFLGdWQ0HW4ZdKSoOWPrrgaLHWPiKsG','WQddPs4jW5S','W4hcSmovhu0vWPhdNSkoWQqml07cPai','g8k5WQe','W5fZW4W','BZpcN27cMmkBea','W7/cN2tcGhS','W7lcV3hcNMe','g8kXc8oOW6W','WQGUECoD','hqm2lWS','WQ7cJ8oxWOGK','W6JcJwNdV21Hz3GB','CsFcHehcMmkEbSkU','W5KEW6FdM8ky','W5WzwcpdGq','k2dcU17dRaTOEmouW5ddQZjWpeDhqCocasNcKW','WOxdGSo1dfm8W6q','oCoZW6BdIN/cT1K','5Q2u5PsC562L5yQM','W6FdSatdKYq','lCoAW5C','772P5BsZ5yYn5A6s','cvJcH0ZdRq','WOiTpCouxa','px/cMN/dQq','W6STW6G','fCozj8oZW6zXWR7dKmowWR5EWR56W5hcGW','D8kAW4pdOW','fCkVWOq+W4n2W4O','bsGUcq','ev/dVW4WWQqsfSou','W5GorZFdMG','W7r3dKZcUq','emkZWRi','WPJdNmo0Acy','W4pcOSoTdKq','8yg5PWpMNAdORBdMTAJLI6/KViNMG5xLPzhOTAJdS+kFRsm','W5/cLSoIqIT2WQXr','W588W6HihW','W6LrW7blDa','W7JdUIT7WQy','WO3cVCozWRi1','uI5np3S','5l+25Ogo5yQ/','lmoCW57dU8khiqRcGa','AW3cGM0F','b+w6VUITOUEMM+MzSUEBN+A0OUwiHU+9OG','x2GKsCk/','W4xdPrRdRHLtzSkGlq','pSo+i8oCW70','EIRcK2lcJW','ohL1m8ob','W4pdOsFdKHS','WRe1mmo5vW','WR/cQuJdGCoz','W7XMW61zBHzfW7qGWO3cHComW5rDeW','5BUG6zcS5zol56wo77Y/yG','ymkEW44','BcFcJMZcKmkBj8kJxua','nKHDgSovW4u','aSkUjCoaW6e','WPJcSSo5WRqq','4PYCW5ROHzNMNQdOVANOOARPG6tLIyxKUOVPLy3ORypdHa','WO/dRaaH','WRHMWQJcUJP4gbH/WONdKry6W5xcHa','W4DtW6xcGSkT','zNiCxCkx','zSkiW5/dKCoQfb7cOmoR','5P6m55YW5AE35zkD77YM','WPdcPCoyWQflWQvHeCkiW7LwgZ3cN8kkW4S','W7lcSIDlWRRcTCk0','wmkHiSkB','nmoaW41SbCkDuu5Wqg4','f0pdTW','wUE7NEADOEAwQUMvH++8Ia','WOBNUiBMN77VVzdKUkxMRydMLjhNGjhMNOlLK7ClBa','Fq3cQe0FW6ldLq','fSoDj8ot','W5GcAmoWWQlcUuyQya','bmoMW4NdOmk6','aezKf8o/','rmoOW4z6W6/dJmoygwtcJW','W7rakW','W59SW7ZdNru','W4xdTaO','aMdcTCopDSklga','4PY9yEIpTowoUUA1HEwiL+s/O+AcTUwLToI2Va','W4/cU8ovovWaWPVdNmk4WRmqcftcPX8PWOumwmkJWR8DW5TlWRZcHmoKW7/dPYNcUIa1dgyqWO7dVSkSWPW','W4L+lYZdHujovWldHgqm','W6ujW7fbga','W57cG0VdMeG','WR0mW4BcMmkfW7ldMSku','zcRcUGf6mN3dRXVcPW','qmkniSoXW6bDWQFdOq','WQ0OpG','WPhdKSoIlLu7W75YWQBcTXZcJrVcTuW','W6fpWPi0y8k0','aSkzWPeRW6S','WOdcLqbOWRa','WOpdOZKvW6S','hCkLWPldKu4Kiq'];}())];}())];}());illlillI=function(){return II1IiIl;};return illlillI();};const CacheFile=__dirname+il11lIii(0x227,'HbHA');!(async()=>{const lIlilii=il11lIii,ll11iI1I={'bcgcW':function(ilIli11i){return ilIli11i();}};await ll11iI1I[lIlilii(0x25a,'Us&h')](Main);})()[il11lIii(0x24e,'CvLN')](iiI1II1i=>$[il11lIii(0x1a8,'VIXG')](iiI1II1i))[il11lIii(0x161,'sv!H')](()=>$[il11lIii(0x1b4,'CvLN')]());async function Main(){const i1Ill111=il11lIii,l1I1IlIl={'PHZKL':i1Ill111(0x16b,'eR2)'),'lXBJa':function(iII11li,lilllII1){return iII11li!==lilllII1;},'ESyWX':function(liII11l1,IiIl1Iil){return liII11l1-IiIl1Iil;},'hnMUQ':function(l111lIII,II111ill){return l111lIII>II111ill;},'GqAKF':function(il11ill,l11i1ll1){return il11ill<=l11i1ll1;},'EekDK':i1Ill111(0x189,'mIC9'),'UGfHC':i1Ill111(0x1f3,'Shq5'),'oUurX':function(li1iI1i,IIl111i,iiIilI1i,Iiilii1l){return li1iI1i(IIl111i,iiIilI1i,Iiilii1l);},'PEVtO':i1Ill111(0x256,'HbHA'),'KgFWA':i1Ill111(0x1f6,'Shq5'),'bpWkA':i1Ill111(0x19a,'6jCx'),'EzPNK':function(ilIilii,IiiilIl){return ilIilii<IiiilIl;},'TEgmW':i1Ill111(0x1e6,'3PgN'),'OCTmd':function(IIIll111,iiIll1l){return IIIll111(iiIll1l);},'kCZdg':i1Ill111(0x1f7,'NT51'),'KZPzS':function(i1II1lI1,iliIIll1){return i1II1lI1===iliIIll1;},'ESivR':i1Ill111(0x15a,'aAE0'),'YqVCf':function(I1111liI,iilIII1i){return I1111liI===iilIII1i;},'CyYxG':i1Ill111(0x1fb,'#@mg'),'rRiSy':i1Ill111(0x275,'El07'),'IRhee':i1Ill111(0x138,'xA#I'),'GSvPB':i1Ill111(0x222,'ldfJ'),'kAtlu':i1Ill111(0x140,'jOKe'),'opeVJ':function(Ii1Iilli,IiiIIlIi){return Ii1Iilli/IiiIIlIi;},'bplDm':i1Ill111(0x273,'m^7I'),'KKHdU':function(lII1iili,IiII1i1l){return lII1iili>IiII1i1l;},'IgnCp':i1Ill111(0x1de,'p[kG'),'wqtMp':i1Ill111(0x146,'3WWY'),'eBkXA':i1Ill111(0x16e,'Shq5'),'jtaUv':i1Ill111(0x1af,'6jCx'),'QjcAd':function(ilii11ll,I11iIII){return ilii11ll>I11iIII;},'OKDwB':function(lliII,I1li1I11){return lliII===I1li1I11;},'rlDcD':i1Ill111(0x240,'Us&h'),'Ywhbg':function(IlI1iIi,II1IIIil){return IlI1iIi>II1IIIil;},'EqAgc':function(illi1ii,li1ilIlI){return illi1ii===li1ilIlI;},'nPcBa':i1Ill111(0x21c,'El07'),'qVFrZ':i1Ill111(0x143,'CvLN'),'hkUZQ':function(IIili11I,liII11iI){return IIili11I===liII11iI;},'XgsVY':i1Ill111(0x207,'3WWY'),'AWRfh':function(l1Il1Iii,IIII111l){return l1Il1Iii(IIII111l);},'daxjS':i1Ill111(0x1b1,'##$^'),'nOJOU':i1Ill111(0x253,'3s2&'),'vYlyL':i1Ill111(0x1cd,'*Tq4')};try{if(l1I1IlIl[i1Ill111(0x216,'IaA3')](tokensList[i1Ill111(0x1bb,'aAE0')],0x0))tokensList=[...new Set(tokensList[i1Ill111(0x1dc,'sv!H')](il1i11Ii=>il1i11Ii!==''))];if(l1I1IlIl[i1Ill111(0x1e4,'m^7I')](tokensList[i1Ill111(0x215,'rplJ')],0x0)){console[i1Ill111(0x261,'mIC9')](l1I1IlIl[i1Ill111(0x14b,'MK2y')]);return;}TokensMap=new Map(tokensList[i1Ill111(0x213,'m^7I')]((Ii1lliIl,lII1IIil)=>[Ii1lliIl,{'index':lII1IIil+0x1,'venderId':'','shopName':'','activityId':'','startTime':'','endTime':'','isValid':!![],'rules':[],'minLevel':null,'maxLevel':null}]));const i1li1ilI=[];console[i1Ill111(0x19b,'POSd')](''),$['UA']=common[i1Ill111(0x258,'Shq5')](l1I1IlIl[i1Ill111(0x263,'##$^')]),{jsToken:$[i1Ill111(0x1a6,'*xjN')]}=await l1I1IlIl[i1Ill111(0x247,'sv!H')](jsTk,$['UA'],l1I1IlIl[i1Ill111(0x180,'6jCx')],{'bizId':l1I1IlIl[i1Ill111(0x156,'&zt0')],'v':l1I1IlIl[i1Ill111(0x168,'mIC9')],'qs':i1Ill111(0x175,'NT51')+tokensList[0x0]});for(const iIlIIIII of tokensList){let iIIllIiI=!![];$[i1Ill111(0x1cc,'eR2)')]=iIlIIIII;let ll11l1Il=0x0;$[i1Ill111(0x204,'Topr')]='',$[i1Ill111(0x171,'CvLN')]=![];const l1ll1l11=0xa;while(!$[i1Ill111(0x278,'3WWY')]&&l1I1IlIl[i1Ill111(0x16f,'azoe')](ll11l1Il,l1ll1l11)&&!$[i1Ill111(0x1d6,'mIC9')]){const ill1lll1=l1I1IlIl[i1Ill111(0x208,'Cbij')][i1Ill111(0x234,'HbHA')]('|');let li1iIlIl=0x0;while(!![]){switch(ill1lll1[li1iIlIl++]){case'0':await l1I1IlIl[i1Ill111(0x144,'ZZJC')](sendRequest,l1I1IlIl[i1Ill111(0x148,'GXZH')]);continue;case'1':ll11l1Il++;continue;case'2':$[i1Ill111(0x14c,'IaA3')]='';continue;case'3':await $[i1Ill111(0x15c,'NomY')](0x3e8);continue;case'4':l1I1IlIl[i1Ill111(0x13b,'Shq5')](ll11l1Il,l1ll1l11)&&(console[i1Ill111(0x1ef,'wX6F')]($[i1Ill111(0x201,'4%zx')]||l1I1IlIl[i1Ill111(0x165,'cGTD')]),$[i1Ill111(0x229,'CvLN')]='');continue;}break;}}if(!$[i1Ill111(0x211,'Cbij')])continue;const illIi1li=$[i1Ill111(0x25f,'xA#I')][i1Ill111(0x25c,'Topr')],iI1lIili=$[i1Ill111(0x1c5,'VIXG')]['id'],ll1iI1Il=$[i1Ill111(0x278,'3WWY')][i1Ill111(0x206,'WYnA')],l11li11i=$[i1Ill111(0x25f,'xA#I')][i1Ill111(0x26d,'VBTk')]||[],iiliII11=$[i1Ill111(0x1c2,'[IcY')][i1Ill111(0x197,'Topr')]||[],liII1iI=$[i1Ill111(0x204,'Topr')][i1Ill111(0x1b6,'p[kG')],iI11lIl=$[i1Ill111(0x1f7,'NT51')][i1Ill111(0x24c,'4%zx')],Il1iil=$[i1Ill111(0x1e8,'cGTD')](l1I1IlIl[i1Ill111(0x202,'vjk1')],liII1iI),lI1iiil1=$[i1Ill111(0x27b,'eR2)')](l1I1IlIl[i1Ill111(0x26c,'wX6F')],iI11lIl);let il1i1Iil=![];const iIIilI1=[],IiI1ilI1=[...iiliII11,...l11li11i];for(const lil1lIII of IiI1ilI1){if(l1I1IlIl[i1Ill111(0x209,'xA#I')](l1I1IlIl[i1Ill111(0x205,'4%zx')],l1I1IlIl[i1Ill111(0x13c,'IaA3')]))l1Il1l1I[i1Ill111(0x173,'El07')](i11ii11i);else{const l11il11I=lil1lIII[i1Ill111(0x18f,'*Tq4')],I1I1iIIl=lil1lIII[i1Ill111(0x19e,'xA#I')]||[],lIIi1l1l=[];for(const l1iiil1I of I1I1iIIl){if(l1I1IlIl[i1Ill111(0x257,'kMwp')](l1I1IlIl[i1Ill111(0x1a2,'FSDC')],l1I1IlIl[i1Ill111(0x268,'aAE0')]))iiIli1l[i1Ill111(0x1c5,'VIXG')]=iIl1l11i[i1Ill111(0x154,'Z2Lc')];else{let l1ilIi='';const I111i111=l1iiil1I[i1Ill111(0x255,'mIC9')],I11I11ii=l1iiil1I[i1Ill111(0x1cf,'eR2)')],l1illi=l1iiil1I[i1Ill111(0x194,'vjk1')],liiliIii=l1iiil1I[i1Ill111(0x1fd,'El07')],iii1ii1=l1I1IlIl[i1Ill111(0x184,'wX6F')](liiliIii,0x5);switch(I11I11ii){case 0x1:l1ilIi=l1I1IlIl[i1Ill111(0x1be,'VIXG')];break;case 0x4:l1ilIi=I111i111+'京豆';break;case 0x6:l1ilIi=I111i111+i1Ill111(0x221,'azoe');break;case 0x9:l1ilIi=''+l1iiil1I?.[i1Ill111(0x1dd,'NomY')][0x0]?.[i1Ill111(0x236,'CvLN')];break;case 0xa:l1ilIi=I111i111+i1Ill111(0x20a,'GXZH');break;case 0xe:l1ilIi=l1I1IlIl[i1Ill111(0x26b,'3q*O')](I111i111,0x64)+i1Ill111(0x1ab,'wX6F');break;default:l1ilIi=i1Ill111(0x159,'xA#I')+I11I11ii+'）';}if(![0x1,0x6][i1Ill111(0x212,'4%zx')](I11I11ii)&&!iii1ii1)il1i1Iil=!![];lIIi1l1l[i1Ill111(0x203,'6jCx')](l1ilIi+'（共'+l1illi+'份'+(iii1ii1?l1I1IlIl[i1Ill111(0x20e,'CvLN')]:'')+'）');}}iIIilI1[i1Ill111(0x192,'&zt0')]({'days':l11il11I,'prize':lIIi1l1l,'havePrize':il1i1Iil});}}const II1IllIi=await common[i1Ill111(0x21f,'Z2Lc')]({'venderId':illIi1li});console[i1Ill111(0x17b,'NT51')]('【'+iIlIIIII+'】\x0a'+(II1IllIi&&i1Ill111(0x14d,'Topr')+II1IllIi+'\x0a')+i1Ill111(0x237,'mIC9')+Il1iil+i1Ill111(0x15f,'cGTD')+lI1iiil1);l1I1IlIl[i1Ill111(0x265,'Cbij')](iIIilI1[i1Ill111(0x1da,'Z2Lc')],0x0)&&(l1I1IlIl[i1Ill111(0x135,'Us&h')](l1I1IlIl[i1Ill111(0x249,'cGTD')],l1I1IlIl[i1Ill111(0x259,'aAE0')])?console[i1Ill111(0x1db,'3s2&')](iIIilI1[i1Ill111(0x1f2,'VIXG')](lii11ii=>(lii11ii[i1Ill111(0x1b5,'3PgN')]===0x0?i1Ill111(0x270,'azoe'):'连续'+(lii11ii[i1Ill111(0x1c3,'WYnA')]<0xa?'\x20':'')+lii11ii[i1Ill111(0x1df,'uEuC')]+'天')+'：'+lii11ii[i1Ill111(0x14a,'El07')][i1Ill111(0x1ff,'Shq5')]('，'))[i1Ill111(0x220,'[IcY')]('\x0a')):(I11lI1i[i1Ill111(0x251,'rplJ')](iI1llIIi[i1Ill111(0x18c,'Shq5')]||l1I1IlIl[i1Ill111(0x210,'3q*O')]),lillliI[i1Ill111(0x1e2,'p[kG')]=''));console[i1Ill111(0x187,'aAE0')]('');const li11l1l1=Date[i1Ill111(0x1d0,'^sRf')]();liII1iI&&l1I1IlIl[i1Ill111(0x1ce,'&zt0')](li11l1l1,liII1iI)&&(l1I1IlIl[i1Ill111(0x228,'Topr')](l1I1IlIl[i1Ill111(0x1fc,'CvLN')],l1I1IlIl[i1Ill111(0x23c,'##$^')])?(console[i1Ill111(0x218,'6jCx')](i1Ill111(0x1eb,'Us&h')+Il1iil+i1Ill111(0x230,'^sRf')),i1li1ilI[i1Ill111(0x1bf,'##$^')](iIlIIIII),iIIllIiI=![]):(il1I111i[i1Ill111(0x1c7,'azoe')]('❓'+IIIl1il1+'\x20'+lli11Il1[i1Ill111(0x269,'azoe')](liI11I1)),i1Iil1iI[i1Ill111(0x1d7,'*Tq4')]=!![]));if(iI11lIl&&l1I1IlIl[i1Ill111(0x217,'&zt0')](li11l1l1,iI11lIl))console[i1Ill111(0x186,'ZZJC')](i1Ill111(0x231,'ZZJC')+lI1iiil1+i1Ill111(0x160,'xA#I')),i1li1ilI[i1Ill111(0x242,'POSd')](iIlIIIII),iIIllIiI=![];else l1I1IlIl[i1Ill111(0x182,'El07')](ll1iI1Il,0x3)&&(console[i1Ill111(0x187,'aAE0')](l1I1IlIl[i1Ill111(0x1b8,'MK2y')]),i1li1ilI[i1Ill111(0x192,'&zt0')](iIlIIIII),iIIllIiI=![]);!il1i1Iil&&(i1li1ilI[i1Ill111(0x233,'Us&h')](iIlIIIII),iIIllIiI=![]);const i1iIIlII=TokensMap[i1Ill111(0x136,'Topr')](iIlIIIII);i1iIIlII[i1Ill111(0x22e,'3q*O')]=illIi1li,i1iIIlII[i1Ill111(0x245,'##$^')]=II1IllIi,i1iIIlII[i1Ill111(0x1ac,'POSd')]=iI1lIili,i1iIIlII[i1Ill111(0x163,'rplJ')]=liII1iI,i1iIIlII[i1Ill111(0x196,'^sRf')]=iI11lIl,i1iIIlII[i1Ill111(0x16a,'3s2&')]=iIIllIiI,i1iIIlII[i1Ill111(0x1c4,'GXZH')]=iIIilI1,l1I1IlIl[i1Ill111(0x178,'Z2Lc')](iIIilI1[i1Ill111(0x252,'*Tq4')],0x0)&&(i1iIIlII[i1Ill111(0x141,'vjk1')]=iIIilI1[0x0][i1Ill111(0x1c1,'3WWY')],i1iIIlII[i1Ill111(0x17d,'mIC9')]=iIIilI1[l1I1IlIl[i1Ill111(0x164,'vjk1')](iIIilI1[i1Ill111(0x1d9,'kMwp')],0x1)][i1Ill111(0x279,'*xjN')]),TokensMap[i1Ill111(0x14e,'*xjN')](iIlIIIII,i1iIIlII);}if(l1I1IlIl[i1Ill111(0x1e5,'m^7I')](i1li1ilI[i1Ill111(0x1f4,'xA#I')],0x0)){if(l1I1IlIl[i1Ill111(0x22f,'eR2)')](l1I1IlIl[i1Ill111(0x226,'aAE0')],l1I1IlIl[i1Ill111(0x239,'FSDC')])){console[i1Ill111(0x1b3,'EM#O')](l1I1IlIl[i1Ill111(0x1a0,'NT51')]);for(const iI11IlIi of i1li1ilI){l1I1IlIl[i1Ill111(0x188,'WYnA')](l1I1IlIl[i1Ill111(0x264,'##$^')],l1I1IlIl[i1Ill111(0x264,'##$^')])?console[i1Ill111(0x18b,'FSDC')](iI11IlIi):(illIli1l[i1Ill111(0x1ea,'GXZH')](IlIlii11),liIIi1iI=![]);}}else l1IIliiI[i1Ill111(0x150,'GXZH')]=lI11ii1i,l1I1IlIl[i1Ill111(0x1a3,'3s2&')](l11lIli1,0x193)&&lliiil11[i1Ill111(0x272,'vjk1')](l1i111ll);}const lIl11I1l=Object[i1Ill111(0x232,'6jCx')](TokensMap),lilI1i1i=l1I1IlIl[i1Ill111(0x274,'VBTk')](require,'fs');lilI1i1i[i1Ill111(0x22c,'3q*O')](CacheFile,JSON[i1Ill111(0x246,'6jCx')](lIl11I1l)),console[i1Ill111(0x1d2,'*xjN')](l1I1IlIl[i1Ill111(0x13e,'aAE0')]);}catch(Ii11IIii){l1I1IlIl[i1Ill111(0x1f0,'IaA3')](l1I1IlIl[i1Ill111(0x1cb,'ZZJC')],l1I1IlIl[i1Ill111(0x157,'ZZJC')])?console[i1Ill111(0x169,'#@mg')](i1Ill111(0x153,'Cbij')+Ii11IIii):(i1III11[i1Ill111(0x1c9,'wX6F')]=l1lIllll[0x0][i1Ill111(0x22b,'Z2Lc')],IIil1l1i[i1Ill111(0x26a,'6jCx')]=liI11l[l1I1IlIl[i1Ill111(0x20b,'ZZJC')](Il1lIIli[i1Ill111(0x183,'vz&g')],0x1)][i1Ill111(0x1b5,'3PgN')]);}}async function handleResponse(l1l1I1l1,lIIillII){const llii1lil=il11lIii,lIii1Iii={'YfyVj':llii1lil(0x1a1,'jOKe'),'KFXvb':function(l11i1IIi,I11IIlll){return l11i1IIi===I11IIlll;},'FUvgo':function(li11iii,illiI111){return li11iii!==illiI111;},'zyvkH':llii1lil(0x20d,'cGTD'),'BpxaO':llii1lil(0x1e9,'wX6F')};try{switch(l1l1I1l1){case lIii1Iii[llii1lil(0x1f8,'Topr')]:if(lIii1Iii[llii1lil(0x1c8,'*Tq4')](lIIillII[llii1lil(0x1ba,'azoe')],0xc8)&&lIii1Iii[llii1lil(0x19d,'3q*O')](lIIillII[llii1lil(0x26e,'POSd')],!![])&&lIIillII[llii1lil(0x219,'Topr')])$[llii1lil(0x174,'POSd')]=lIIillII[llii1lil(0x1e7,'El07')];else lIIillII[llii1lil(0x1f5,'sv!H')]?(console[llii1lil(0x260,'Topr')](llii1lil(0x139,'MK2y')+lIIillII[llii1lil(0x23a,'IaA3')]),$[llii1lil(0x166,'vz&g')]=!![]):(console[llii1lil(0x15e,'*Tq4')]('❓'+l1l1I1l1+'\x20'+JSON[llii1lil(0x145,'3PgN')](lIIillII)),$[llii1lil(0x1d6,'mIC9')]=!![]);break;}}catch(lIlIllll){lIii1Iii[llii1lil(0x177,'^sRf')](lIii1Iii[llii1lil(0x198,'ldfJ')],lIii1Iii[llii1lil(0x23f,'NomY')])?console[llii1lil(0x167,'Us&h')](llii1lil(0x195,'FSDC')+l1l1I1l1+llii1lil(0x191,'Cbij')+(lIlIllll[llii1lil(0x27a,'WYnA')]||lIlIllll)):ilil1I1l[llii1lil(0x1d1,'VIXG')](llii1lil(0x21b,'MK2y')+lliliiIl);}}async function sendRequest(IlllillI){const Il1ilIIl=il11lIii,I1I1ll11={'KhZIa':Il1ilIIl(0x18a,'##$^'),'ADvbI':Il1ilIIl(0x155,'p[kG'),'piDAl':Il1ilIIl(0x200,'3q*O'),'qYMIh':Il1ilIIl(0x16c,'xA#I'),'zSffI':Il1ilIIl(0x185,'6jCx'),'algtx':function(I1il1l1I,iI1iII1){return I1il1l1I(iI1iII1);},'rATbR':Il1ilIIl(0x277,'p[kG'),'QDpKg':Il1ilIIl(0x1d3,'Shq5'),'WEkiH':Il1ilIIl(0x133,'*Tq4'),'vrsgd':function(Iill1Il,Iiiill11){return Iill1Il/Iiiill11;},'HTRQa':Il1ilIIl(0x24d,'ldfJ'),'FabLo':Il1ilIIl(0x1f9,'azoe'),'RTfLX':Il1ilIIl(0x17f,'aAE0'),'KkMGf':Il1ilIIl(0x1e0,'CvLN'),'lBuCu':Il1ilIIl(0x214,'EM#O'),'KEFsK':Il1ilIIl(0x17a,'GXZH'),'Vtraa':Il1ilIIl(0x25d,'IaA3'),'CuyIg':Il1ilIIl(0x1ca,'vjk1'),'qnXlv':Il1ilIIl(0x1d4,'^sRf'),'WHfuh':Il1ilIIl(0x15d,'FSDC'),'QalTS':function(liI1iill,l1iliil){return liI1iill===l1iliil;},'iWXEU':Il1ilIIl(0x1fe,'aAE0'),'uusss':function(lIlll1Il,lil111i1){return lIlll1Il<lil111i1;},'IINuB':function(IiIIIi,iililIii){return IiIIIi!==iililIii;},'upOUl':Il1ilIIl(0x13d,'#@mg'),'TkBhj':function(li111II1,i11li1){return li111II1>i11li1;},'NRMNy':function(lil1i1i,iIii11Ii,illI1I1){return lil1i1i(iIii11Ii,illI1I1);},'ugGCt':function(iilliiil,iIiiIiil){return iilliiil>=iIiiIiil;}};if($[Il1ilIIl(0x181,'##$^')])return;let lIIIiiII='',I1iI1l1i=null,iiIlilII=null,II11II1l=I1I1ll11[Il1ilIIl(0x25e,'Z2Lc')],llIlii11={},iiIil11l={};switch(IlllillI){case I1I1ll11[Il1ilIIl(0x134,'wX6F')]:iiIil11l={'appId':I1I1ll11[Il1ilIIl(0x142,'sv!H')],'functionId':I1I1ll11[Il1ilIIl(0x238,'rplJ')],'appid':I1I1ll11[Il1ilIIl(0x176,'WYnA')],'body':{'token':$[Il1ilIIl(0x24a,'&zt0')],'venderId':I1I1ll11[Il1ilIIl(0x1ae,'3q*O')](parseInt,$[Il1ilIIl(0x1ec,'EM#O')])||''},'version':I1I1ll11[Il1ilIIl(0x248,'aAE0')],'ua':$['UA']},llIlii11=await H5st[Il1ilIIl(0x21a,'uEuC')](iiIil11l),lIIIiiII=I1I1ll11[Il1ilIIl(0x1b0,'p[kG')],iiIlilII=Object[Il1ilIIl(0x1ed,'Shq5')]({},llIlii11[Il1ilIIl(0x14f,'6jCx')],{'jsonp':I1I1ll11[Il1ilIIl(0x225,'POSd')]});break;default:console[Il1ilIIl(0x167,'Us&h')](Il1ilIIl(0x1ad,'mIC9')+IlllillI);return;}const il1I1l1l={'t':Math[Il1ilIIl(0x147,'6jCx')](I1I1ll11[Il1ilIIl(0x137,'jOKe')](Date[Il1ilIIl(0x18e,'CvLN')](),0x3e8))+Il1ilIIl(0x1b9,'p[kG'),'loginType':'2','x-api-eid-token':$[Il1ilIIl(0x179,'Topr')]};I1iI1l1i&&Object[Il1ilIIl(0x1a4,'[IcY')](I1iI1l1i,il1I1l1l);iiIlilII&&Object[Il1ilIIl(0x18d,'3PgN')](iiIlilII,il1I1l1l);const Iil11iiI={'url':lIIIiiII,'method':II11II1l,'headers':{'Accept':I1I1ll11[Il1ilIIl(0x19f,'##$^')],'Accept-Encoding':I1I1ll11[Il1ilIIl(0x1b2,'Shq5')],'Accept-Language':I1I1ll11[Il1ilIIl(0x151,'Cbij')],'Connection':I1I1ll11[Il1ilIIl(0x20f,'FSDC')],'Content-Type':I1I1ll11[Il1ilIIl(0x267,'eR2)')],'Host':I1I1ll11[Il1ilIIl(0x13f,'ldfJ')],'Referer':I1I1ll11[Il1ilIIl(0x20c,'[IcY')],'Sec-Fetch-Dest':I1I1ll11[Il1ilIIl(0x1fa,'eR2)')],'Sec-Fetch-Mode':I1I1ll11[Il1ilIIl(0x152,'aAE0')],'Sec-Fetch-Site':I1I1ll11[Il1ilIIl(0x250,'Us&h')],'User-Agent':$['UA']},'params':iiIlilII,'data':I1iI1l1i,'timeout':0x7530,'httpsTlsOptions':common[Il1ilIIl(0x158,'*xjN')]()};I1I1ll11[Il1ilIIl(0x271,'3PgN')](II11II1l,I1I1ll11[Il1ilIIl(0x24f,'FSDC')])&&(delete Iil11iiI[Il1ilIIl(0x243,'MK2y')],delete Iil11iiI[Il1ilIIl(0x1aa,'uEuC')][I1I1ll11[Il1ilIIl(0x1ee,'NomY')]]);const l1iiiiI=0x1;let iIIlIII1=0x0,liillIIl=null,ii1Iii1I=null;while(I1I1ll11[Il1ilIIl(0x1bd,'sv!H')](iIIlIII1,l1iiiiI)){if(I1I1ll11[Il1ilIIl(0x22a,'Topr')](I1I1ll11[Il1ilIIl(0x149,'3PgN')],I1I1ll11[Il1ilIIl(0x276,'VBTk')]))ll1llI1i[Il1ilIIl(0x17b,'NT51')](IIi1i1iI);else{I1I1ll11[Il1ilIIl(0x223,'jOKe')](iIIlIII1,0x0)&&await $[Il1ilIIl(0x23e,'FSDC')](0x7d0);const liII1Ii=await common[Il1ilIIl(0x244,'cGTD')](Iil11iiI);if(!liII1Ii[Il1ilIIl(0x262,'6jCx')]){ii1Iii1I=liII1Ii[Il1ilIIl(0x1a7,'kMwp')],liillIIl=Il1ilIIl(0x235,'VIXG')+IlllillI+Il1ilIIl(0x1d5,'p[kG')+liII1Ii[Il1ilIIl(0x193,'Topr')],iIIlIII1++;continue;}if(!liII1Ii[Il1ilIIl(0x162,'3WWY')]){liillIIl=Il1ilIIl(0x1a9,'NT51')+IlllillI+Il1ilIIl(0x1f1,'MK2y'),iIIlIII1++;continue;}await I1I1ll11[Il1ilIIl(0x1b7,'azoe')](handleResponse,IlllillI,liII1Ii[Il1ilIIl(0x266,'uEuC')]),ipBlack=![];break;}}I1I1ll11[Il1ilIIl(0x1c0,'[IcY')](iIIlIII1,l1iiiiI)&&($[Il1ilIIl(0x254,'sv!H')]=liillIIl,I1I1ll11[Il1ilIIl(0x1d8,'3q*O')](ii1Iii1I,0x193)&&console[Il1ilIIl(0x1c7,'azoe')](liillIIl));}var version_ = 'jsjiami.com.v7';

// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
