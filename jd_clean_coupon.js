/*
删除优惠券
环境变量：JD_COUPON_PIN_FILTER_GOODS // 需删除优惠券的账号（填入pin，多个用@分割）

cron:1 1 1 1 *

*/

const $ = new Env('删除优惠券')
var iｉl='jsjiami.com.v7';const liIli=iii1II;(function(l1il1l,liIil,IllI1I,liIii,II1ll1,IlI1Ii,i11I1I){return l1il1l=l1il1l>>0x1,IlI1Ii='hs',i11I1I='hs',function(l1il1i,ll1,iI1llI,llliii,IllI11){const lllii1=iii1II;llliii='tfi',IlI1Ii=llliii+IlI1Ii,IllI11='up',i11I1I+=IllI11,IlI1Ii=iI1llI(IlI1Ii),i11I1I=iI1llI(i11I1I),iI1llI=0x0;const l1llIi=l1il1i();while(!![]&&--liIii+ll1){try{llliii=-parseInt(lllii1(0x203,'57bE'))/0x1*(parseInt(lllii1(0x17e,'PJoX'))/0x2)+-parseInt(lllii1(0x17b,'s8dY'))/0x3+parseInt(lllii1(0x202,'Z@0B'))/0x4*(parseInt(lllii1(0x126,'YTm0'))/0x5)+-parseInt(lllii1(0x20a,'%sFE'))/0x6*(-parseInt(lllii1(0x1c0,'52EO'))/0x7)+-parseInt(lllii1(0x193,'#n%1'))/0x8+parseInt(lllii1(0x186,')i9s'))/0x9*(-parseInt(lllii1(0x156,'N[NO'))/0xa)+parseInt(lllii1(0x150,'D[tT'))/0xb;}catch(II1llI){llliii=iI1llI;}finally{IllI11=l1llIi[IlI1Ii]();if(l1il1l<=liIii)iI1llI?II1ll1?llliii=IllI11:II1ll1=IllI11:iI1llI=IllI11;else{if(iI1llI==II1ll1['replace'](/[rxuAQJKWyntLHGwFPISX=]/g,'')){if(llliii===ll1){l1llIi['un'+IlI1Ii](IllI11);break;}l1llIi[i11I1I](IllI11);}}}}}(IllI1I,liIil,function(i11I11,l1llIl,ii1I1l,ii1I1i,llI,llliI,iI1li1){return l1llIl='\x73\x70\x6c\x69\x74',i11I11=arguments[0x0],i11I11=i11I11[l1llIl](''),ii1I1l=`\x72\x65\x76\x65\x72\x73\x65`,i11I11=i11I11[ii1I1l]('\x76'),ii1I1i=`\x6a\x6f\x69\x6e`,(0x16e805,i11I11[ii1I1i](''));});}(0x17a,0x829e4,Iii11l,0xbf),Iii11l)&&(iｉl=0xbf);const jdCookie=require(liIli(0x16f,'0WHM')),notify=require(liIli(0x15d,'Vqoa')),common=require('./utils/Rebels_jdCommon'),{H5st}=require(liIli(0x1cf,'W&nu')),pinFilterGoods=(process[liIli(0x214,'mYtH')][liIli(0x18f,'tNSW')]||'')[liIli(0x17c,'#n%1')]('@'),isNotify=![];let cookie='';const cookiesArr=Object[liIli(0x1ee,'D[tT')](jdCookie)[liIli(0x217,'jNb3')](I11iII=>jdCookie[I11iII])[liIli(0x140,'vZIY')](I1ilIi=>I1ilIi);!cookiesArr[0x0]&&($[liIli(0x1f6,'s8dY')]($[liIli(0x21e,'!5[t')],liIli(0x15c,'YTm0')),process['exit'](0x1));function Iii11l(){const IilIiI=(function(){return[...[iｉl,'AunjHQsrjPwiyuaWmSXiJt.KLAcSoPFm.GrvxFI7==','uSkSumobFr8s','vCkOtCoqqYqjya','W7LlW7CdW7G','iCo5ASklWPm','WPVdLSo5','W5fDWPZcSLy','WOVcQunoW7K','W5ZdHtlcTr3cVgpdPGu','W7BdM8oVW4jyWR7dLCoy','WORcHKbXW4O','lmkmW74lc8oU','W41LW6GvW6e3','wqNcLCkpEu5jaXxdPvxdSrKuja82W7uvWPNcLCkVW6zUW75mW6tcUW','W4lcNmkldW','zaxcH8kCzq','W4NdNabMWO7dOmkKWRT/WPVdJSo5WRldVbKLf8ktkGBcHgS','wvioW4PxWQ4','ouLsW4RdP8kF','DSknpSoDWR3cGGSuefS1emoGr8o4W6xcHrZdKfPADCkIWOnSC8oXW6/dLWf/WRm','hCoBtKNcUYLjhCkJmSo0','WPZdTCkSCCkfdZddQ8k+W5m','qdlcKSkOtG','auFcR30','jSoAFSkFWRddNwOguvrK','Amk8WP3dRq','WO/cRmkEow8C','W4xdNINcSG','WQNdL8k3','ESoviv9/W6JcRYr9W5C','DmkdzuSIWRhcVZ9RWOFdTxhdKmohWOaEwG','kx06i8oudmktW7O','EL7cMeOZ','FCkNcmoDWQ0','bSkyW7OqbW','WQrcrGWmFa3cQfddU8o+W7i','WR7dKmoVsCkCW5RdQgdcLaDLWRy','a0ZcT355','W7lcI8kAh1C','tZRcMCkiCW','WQFcK3fWW7mvtMW','WP3cGhJdQ0tdQLddPWVcGX3dKq','WOfExmofka','AbCeWPVcUCojqrZcRgqPEW','W5BdLMayW45Q','WOZdUSoyFmkE','W5DMWPpcQfi','WQ3cRfi3WQq','gSknW74ymCoQetq','5P6/6kYk57+054YD5Ak05yYi6ywZW7BdQmoLW6VdR8oFnapcP8kUW49IW4ddJq/dVaJdVZ18WRtdH8kbcMGJ77286yk25yEl5OQm6kctnW','WR3cNL4sWPG','5lMG5l2v5OoO5yME','WPVdGmocuYhcRCocemkQxW','huf2W6xdIq','W4BcOfnmiCkGAG','jSkqW78pbW','W5uhW7ldMLddThK','pCo9W64gbCoc','d8oOtmofrGypiSojWRfAW4ikWRBcGYa','fComzSkFWO4','W5BdLMa','W606lfnQ','sSkeBCoKEW','W6JdLxP+W5BdMmoYW7T+W6C','xNpcS08vW4hcN8oPWOOc','W6LuWQlcTgtcGCoN','F0ZdPCkWW7/dRCo1','D8kPoCoIW7nFFs1gWRG','WPVcN3C','n0npW5/dR8kFFG','W4FdNufGWORdRCkdWRf8WO7dJCo4WO7dSbH8oW','W4hdLGS','d0ZdOdGokZldLG03','W4tdGZnpW58pW77LVkJLPjxJGRlKUklKU5hOT5xLJji','W5pcRmktagq','W5FcTLPFnSkI','l1vzW43dRmkuFG','hehcQW','WRnH5yI/6zMV5l2m5Oga5yQs5OQo5yQc','WQ/cH8oAimonWOGsWQC','WPXdFSoZ','5OQ56kcU6lw55y26WRddOIy','zCouWRfavCkHDG','osX6mN4','kfnsW6NdOmkC','W4/cK8kmc27dPa','bG9vWP9bW7CPbSoLcSowW4lcLCkYuWCMW5PBfW/dQ8o2WQFdRmk4xSoUnmk0iSol','AmkJkmoZWRjWzcK','FCk/l8o7WRLq','vmk1W54p','lKLiW43dOSk2BHy','jtH8iedcU8ov','tWJcTNO/nXVdTYmVyZZcRa56W605g1NdPX3cSKBdOcPQkCkR','W5NdLNiTW5n2WQVdImo6cIC','WOFcK3fJW58yrG','CG9sW5lcOtC','5lUy5l+45Oo05yI6','CCk/oW'],...(function(){return[...['W5FcJmkzlg8','WP3cKCkvWRiY','WQ5ABSo2aG','W4RcKSky','W7jOW4qCW47cPW','WQ3cHMSw','uSk1W5qpz8kDW5q','WPnTqSoMnq','5yU+6zIg5l2h5OgT5yQY5AEZ6lwy','W5VdRL8FW5u','W6ldGZ5EW5JcJSkSWQmQWOuAWPpdLmoy','W5/dSmoFCu0+WRRdPKpdRG','AmkUWRPfqmkFrtNdSSk5x8kO','W7mYj0r6','WRdcVmkLo8oB','gmkntLpdNq','d8oashZcTq','qsxcQmkmuq','WRinoa','WOVcJtmlW65HWP7dQmoj','WONdR8kkW7pdKa','4P6BW6hMN4NOGkdMRl7NOPdLPPVNK7bU','kCoABa','dhiGkmoY','hwuyW4W','5yML6zMS5l+N5OoV5yIh5AAI6lEF','x2FcPfWbW7JcV8olWPewW7fmFSk9WPlcH3RdMd9jWP5XFCotWQPJW5qO','coIUI+AYSUwqSow6Lcq','5zkf5Ocn5lQi776e6k6U5OIu5yUm5z28z8keWP7KURpLMyhML6pNQzpMGzxLPABKV4FMG7FLIi3JGOe','W6fFWQC','yLRdOCk1W7JdS8oJhJxdICoFWO/dHG','EmkPmmo3WQPBuITfWQ3dKNNdJfS8W5O0l8k5WO4opq','kmouEW','DW5g','C0JdSmk1','rrNcG8koywni','uSk9ASofwG','WPhdSSkrW73dKW','tqNcOweOgHBdKJu','W4hcP8o1la','W5FcTmkTlgO','kmogBa','AvFcLq','lCobF8kFWQZcIrzDx0LYwSkYfCoVW6tdNrtcMW','W79JW5SlW4NcVq','WPX0WOlcUSoLcmoC','E8k1dmoFWP8','W4tdLWHMWOi','nMpcLN9TW6BcLa','W4ylW5ldLeu','WPhdKmoM','W47dLHLZWPxdQ8koWRPSWOtdJCo+WO3dOq','i3WSp8oobSkLW73dRX3dTq','BCk9fmoyWPK','W7azdKLf','W5yxW6pdI0BdMNJdVSo+i1pcMmotptvPWRJdQ8kPWOhcTgaUWPhdJCodnx4','WQxcImonl8oq','WPdcGmknfmolW77dUSkQWP58dGRcMIDlWPhcTMtcTCoIW6ZdL8oDW7NdOb5GfraUW6VdISk9','W4/dL3q4W4HBWPddJSoLdYC','4P+byEACTEEFRUIUO+AZOSkk','5yQA6zUD5lYF5Ok95yQe5OIi5yMG','jSodALtcGq','ESkiW50tCa','DmkIW4SguG','W7rZW6maW5S+hxW','tx3cTf4xW5W','5y2k5yUq6zQz','FKFdT8kXW6JdQW','W4hcMmkrph3dVSkBqSo6mCkSW5FcQSoEmG','e3CdW4nuWOuyW4xdHa','gKpcQg7cIuC','W6ddTCouW6u7','B+ISIEAZMEwLM+I1MSkR4P+GCEAuMUwrL+w5NUAwO+AoNW','W7RdRZ5kWQi','hsVdTXPaW5JcTmo6WR01W7u','pmkBW68PemoKfZJcNW','WPpcGSo9k8oa','neDrW4K','EhG/xHZdQCkhwxNcK8oRW7hcKNO','laXda2C','hUIUIUAYKEwKUEI1O13IN6pcLa','5PsD5y2q55AP5lYL5Ocz5yQm5OQk5P2N6i235y6O5yIL5l+l5OgZ5yID5yMm6ko+','wfitW55cWQf+','kmklzX9yW5dcLJ9mW58','WOBcJ2bJW5e6vMq','vmk0xmoqtqyz','WP7cTSkfdg4w','W6qVFgCHW4tdJ8oT','W4ZcQCoToCkNlq','kSo5W7aGiG','tx3cTf4xW5ZcJ8oHWOOpW6q','l8oSW4BcQLJcLmoUW4izvW','W7BdIIn+W5i','F8kJkCoIWRfqzt1aWRG','W7RcH1vhgG','W6nCWRJcTge','W6tdRhRdJJu+aW','W4ZcQCoToCkNlrZdOmkEW7O','EHneW5y'],...(function(){return['W5tcTKjHlmkRzNXdW4ddP8kiW7/cPa','FsNcPeqQ','g8ogsvBcPG','WQf9WP7cSSoD','W6pdJYzPW5lcKW','WONdKmo1xmkvW7RdQsa','m0HFW4ddU8kCFGG','WQtdI8kJW7FdRSkx','WO1IWOVcVSoZaCo6W6blySkUW5BdJvZdJsjKpSo2WOJdPJ0','W4JcLmkCbvldSCkssa','WO9UWOVcR8oIfG','W6ddINi+W78','W7DPW5a','jIjV','5P2O6k6J5yIV5yw65P2D','W4JdTMddVdWXehLYWQ3cVSoC','gKNcOq','WOHoCSo1cv1xW4zSECoit8oJwxWHt8oTW54Xtc8sW6f+m8kZWQq','W4NdMcZcQbBcQq','WRSqlCoaW7NcPq','h8oN5yIz6zUv5lY35Okk5yMe5As86lA+W7qfWPLg','W6BdOY5RWO4','lNWU','5yYS6yE554MW5Ogc57I45P+5nSkVW6NdKCkMW6qVr2dcQa','W4n0WOu','WPJdPSo0BSku','dCoLWPbenSojWOtdISoDtmkUWOVcQ2m','WQdcV8k2kCoe','y8oRz37dImk6WOOb','W57dIqbQWO4','WQ0wlCoKW6tcPrqWnW','5PAw5y+j55EU5lYr5OcD5yIx5OIu5P+p6iYt5y2y5yUX5l+L5OcG5yQD5yUb6kk6','W4pdKfveW68TygO','nSouzSkkW7ldNeSBt1fV','W6xdHCoWW6jX','xX3cMCkj','WOhcHSkzWRCC','6lso5y6l5Psq5PA1','44cj5O2Q56wU44c+6k+N5yEo6i2S5y6ltSoDWQmJW53dHa','W5CuySoZgxTaWQPrACoArCoHzKOHxSocW4OlzaqjW5n4j8ka','wWJcGSkuBMnejGm','W5xcICknb3ldT8kws8oU','W4j/WRxcNwS','W5rZW6mtW7CZfuzKo8omimk1','WPHzWQe','W6/cL8o6','WOrIWPtcQmoMa8oC','W5RdGIxcVrhcT28','Emojj0z3W6G','W5hcQZ/dNhW','4P+HWPNOHBBMNk/OVkROO4NPGQdLI6tKUOZPL7lORy7cNq','i8kBW7unc8oJ','EGTaW48','8jMRIGe','W4ZdGowiToMzPUs+PEAcLowiM+AiMEwiQG','r3NdStVcOG','W5ZdKSo7W4Hp','mCoYWP7dVs/dJSk3WP5icW','W5CxW7xdKq','WPDzWRmZWOtdIgldTG','WRruBCoUhhTsWQO2iSkiamkLFeuZx8kxWO4cCb9gW6HcyCoiW7pdJqubwmkdWOhdQ8osFmoZW4WyW7pdK1/dPX7cNHX9WOS4WRNcS3mOW5tdL1HiW65CaSk/WQqiASoAf8oTrmk5cWddT8oblmovW5ldU8o/WPiHmbhdQq7cGsjxzmkeW5HKW4JdRmkUj8klaSkwoYVcRSkNW4FcOXBcTXyAE8odneZcVabaWQKQWQ3dQmoWWQxdSHhcSefCc8oHW6RcUSky','EeRcSxWv','WRtcGtqMWRSjWQ5aW6xdK8kZW73dNCoCW7VdId0pox7cVSo3qCoyWPWWpKhdHmkKjCk/mmkhfs1RW4jeW53dPCoCW49sW4DnWOa','W4JdIX5oWONdOG','W6ahg1XEiZO','WPjFWR4','W7/cRCo2aSkK','W7tcKGZdT3e','WQldSMpcHIVcU0tcPeunhqjI','l8o9BCkKW68mjHbFWRldIL7dGG','W5jWW6OBW6e','5RcU5OEM5lIY6Ac1776I5Rgn5lU86kYJ5yQi6l2G6koX776H5Rg75lIU6kYg5yIu6l2k6kgv44cM','d03cVM40cJZdKq','WQ0wpSo5W7/cSq','WQVcJmokp8ozWOSs','WQlcHN4','WQVcImoj','qW/cO8k5Aa','5yIo6zM25l+z5Ooo5yMa5Q6t5PAR6l2p5AEK772V5AAB5l2655Qu5Q+q5PAl6kYd5yAd5OU+6kcd6isJ5P+EAG','WP3cN8kA','WPJcHNFdR0ddOJpdJINcUWpdUsS','qmk0sSoysaq','W4ugWOCfWRNdV0JdSq','oaXph3G','ih7cTLVcKa','fwSl','WRhcImoqoa','W4FcO8o5lCkTmrS','n8kyW48zca','WP3cHCk8WP4sWQVdJ8k5amoqW41tq0OIWPfiqSoMWOFdULmquCkiW58','W4XLW7ubW7q4fq','rHxcK8kwtMvajq','dh4XlCoR','WPi5WRbgWQ01h2TeaSon','WOPOWOpcVG','BJ7cLMaw'];}())];}())];}());Iii11l=function(){return IilIiI;};return Iii11l();}function iii1II(_0x54f449,_0x41385e){const _0x382574=Iii11l();return iii1II=function(_0x2e654a,_0x2ecef7){_0x2e654a=_0x2e654a-0x122;let _0x2312f8=_0x382574[_0x2e654a];if(iii1II['tDNyQn']===undefined){var _0x296b21=function(_0x5b5745){const _0x4a9f8a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x213794='',_0x243b65='';for(let _0x30ec89=0x0,_0x3909dc,_0x455f6a,_0x54a01f=0x0;_0x455f6a=_0x5b5745['charAt'](_0x54a01f++);~_0x455f6a&&(_0x3909dc=_0x30ec89%0x4?_0x3909dc*0x40+_0x455f6a:_0x455f6a,_0x30ec89++%0x4)?_0x213794+=String['fromCharCode'](0xff&_0x3909dc>>(-0x2*_0x30ec89&0x6)):0x0){_0x455f6a=_0x4a9f8a['indexOf'](_0x455f6a);}for(let _0x2044f3=0x0,_0x5e4fd7=_0x213794['length'];_0x2044f3<_0x5e4fd7;_0x2044f3++){_0x243b65+='%'+('00'+_0x213794['charCodeAt'](_0x2044f3)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x243b65);};const _0x221c9b=function(_0xece2d2,_0x92b174){let _0x5b70a4=[],_0x4ed19f=0x0,_0x35da0f,_0x413fa9='';_0xece2d2=_0x296b21(_0xece2d2);let _0x3d1d19;for(_0x3d1d19=0x0;_0x3d1d19<0x100;_0x3d1d19++){_0x5b70a4[_0x3d1d19]=_0x3d1d19;}for(_0x3d1d19=0x0;_0x3d1d19<0x100;_0x3d1d19++){_0x4ed19f=(_0x4ed19f+_0x5b70a4[_0x3d1d19]+_0x92b174['charCodeAt'](_0x3d1d19%_0x92b174['length']))%0x100,_0x35da0f=_0x5b70a4[_0x3d1d19],_0x5b70a4[_0x3d1d19]=_0x5b70a4[_0x4ed19f],_0x5b70a4[_0x4ed19f]=_0x35da0f;}_0x3d1d19=0x0,_0x4ed19f=0x0;for(let _0x5f2853=0x0;_0x5f2853<_0xece2d2['length'];_0x5f2853++){_0x3d1d19=(_0x3d1d19+0x1)%0x100,_0x4ed19f=(_0x4ed19f+_0x5b70a4[_0x3d1d19])%0x100,_0x35da0f=_0x5b70a4[_0x3d1d19],_0x5b70a4[_0x3d1d19]=_0x5b70a4[_0x4ed19f],_0x5b70a4[_0x4ed19f]=_0x35da0f,_0x413fa9+=String['fromCharCode'](_0xece2d2['charCodeAt'](_0x5f2853)^_0x5b70a4[(_0x5b70a4[_0x3d1d19]+_0x5b70a4[_0x4ed19f])%0x100]);}return _0x413fa9;};iii1II['SAIgpj']=_0x221c9b,_0x54f449=arguments,iii1II['tDNyQn']=!![];}const _0x2eee7e=_0x382574[0x0],_0x33d426=_0x2e654a+_0x2eee7e,_0x4df930=_0x54f449[_0x33d426];return!_0x4df930?(iii1II['IEAPja']===undefined&&(iii1II['IEAPja']=!![]),_0x2312f8=iii1II['SAIgpj'](_0x2312f8,_0x2ecef7),_0x54f449[_0x33d426]=_0x2312f8):_0x2312f8=_0x4df930,_0x2312f8;},iii1II(_0x54f449,_0x41385e);};!(async()=>{const liIll=liIli,IiiiI={'gFius':liIll(0x210,'xbk]'),'CTwLl':liIll(0x236,'D[tT'),'xNRnV':function(llIlli,llIlll){return llIlli+llIlll;},'Ifazx':function(lliii1,Iiii1){return lliii1(Iiii1);},'qEYAg':'pt_pin','uMKco':function(lIIili,IiiIil){return lIIili!==IiiIil;},'lvEah':liIll(0x208,'Hm#W')};console[liIll(0x1b1,'$JF8')](liIll(0x1c9,'6Oas')+$['name']+'变量开启状态=========='),console['log'](liIll(0x17d,'B5D2')),console[liIll(0x146,'4WXf')]('仅保留农场[实物]优惠券，删除其他优惠券。'),console[liIll(0x143,'h4uT')](liIll(0x213,'GKrS')),console['log'](liIll(0x1e6,'w9KG')+pinFilterGoods[liIll(0x1b0,')i9s')](',\x20')+']'),console['log']('=========='+$['name']+liIll(0x14d,'h4UN'));if(pinFilterGoods==''){if(IiiiI[liIll(0x137,'PJoX')]!==liIll(0x1a4,'Hm#W')){console[liIll(0x1fa,'6Oas')](liIll(0x1c6,'UsHX'));return;}else Ii1iIi['assign'](iliIIl,Ii1iIl);}notify[liIll(0x1a7,'52EO')]({'title':$[liIll(0x244,'52EO')]});for(let IIlll=0x0;IIlll<cookiesArr[liIll(0x169,'R0Xn')];IIlll++){$[liIll(0x226,'(R]1')]=IiiiI[liIll(0x1d2,'84X&')](IIlll,0x1),cookie=cookiesArr[IIlll],common[liIll(0x242,'R0Xn')](cookie),$[liIll(0x1bd,'N[NO')]=IiiiI[liIll(0x1b7,'R0Xn')](decodeURIComponent,common[liIll(0x201,'&6SR')](cookie,IiiiI[liIll(0x1c2,'FDQQ')])),$[liIll(0x1da,'52EO')]=notify[liIll(0x1a0,'R0Xn')]($['index'],$['UserName']),$[liIll(0x135,'vI2r')]=liIll(0x16d,'4WXf')+common[liIll(0x23b,'6Oas')](0x4,liIll(0x12e,'0WHM'))+'_0',$[liIll(0x191,'Hm#W')]='';if(pinFilterGoods[liIll(0x1b4,'cQ3R')](IiiiI[liIll(0x16e,'UsHX')](encodeURIComponent,$[liIll(0x1c5,'R0Xn')])))IiiiI['uMKco'](IiiiI['lvEah'],liIll(0x206,'ce7S'))?(console[liIll(0x1dc,'(R]1')](liIll(0x1de,'F*U[')+$[liIll(0x1cc,'R0Xn')]+'】'+($[liIll(0x13f,'6Oas')]||$[liIll(0x237,'#n%1')])+liIll(0x1e7,'R0Xn')),await Main()):(i1ilii[liIll(0x185,'Gu0X')](liIll(0x14a,'W&nu')+(iIIII1?.[liIll(0x149,'w9KG')]||i1l1ll[liIll(0x19d,')i9s')](I1iIiI))),li1I1['message'][liIll(0x1fb,'Bnu*')](IiiiI[liIll(0x1bc,'Hm#W')]));else continue;common[liIll(0x231,'%sFE')]();if($[liIll(0x1e9,'52EO')])break;await $[liIll(0x1ac,'4WXf')](0x7d0);}isNotify&&notify['getMessage']()&&await notify[liIll(0x170,'((Ct')]();})()[liIli(0x22f,'B5D2')](ll1lI=>$[liIli(0x1c1,'%sFE')](ll1lI))['finally'](()=>$['done']());async function Main(){const IilIi1=liIli,l1iii={'pqjPF':function(l1iil,ii1l1){return l1iil(ii1l1);},'rAGyT':function(lIIill,I11iIi){return lIIill===I11iIi;},'JPvoo':'boolean','qtsEa':function(I1ilII,I11iIl){return I1ilII!==I11iIl;},'TTwqI':IilIi1(0x19c,'N[NO'),'cbAMS':IilIi1(0x198,'#n%1'),'KZBht':function(l1l11l,IilIil){return l1l11l!==IilIil;},'akTOs':'pocjt','qqHJG':function(l1iIi,l1l11i){return l1iIi(l1l11i);},'dDByH':function(l1iIl,illIll){return l1iIl>illIll;},'eYuSm':IilIi1(0x1ab,'Hm#W'),'OXHIw':function(iIli1I,Iiil1){return iIli1I>Iiil1;},'EXzov':function(iiilli,l1iIIl){return iiilli===l1iIIl;},'sarTR':IilIi1(0x199,'jNb3'),'fAKeK':IilIi1(0x13e,'vZIY'),'jVUaE':function(iiilll,lI11Il){return iiilll===lI11Il;},'xeKBX':IilIi1(0x141,'%sFE'),'PympQ':IilIi1(0x184,'TDJe'),'FDHqF':function(lIII1i,l11i11){return lIII1i!==l11i11;},'uQlnx':IilIi1(0x200,'%sFE')},IIlli=await common[IilIi1(0x136,'&[Fv')](cookie);if(!IIlli&&l1iii[IilIi1(0x189,'h4uT')](typeof IIlli,l1iii[IilIi1(0x1f8,'tNSW')])){if(l1iii[IilIi1(0x207,'#dFN')](l1iii['TTwqI'],l1iii['cbAMS'])){console[IilIi1(0x18b,'xG4E')](IilIi1(0x15b,'Hm#W'));return;}else delete I1lll1['data'],delete i1IIi[IilIi1(0x18d,'!5[t')][IilIi1(0x145,'GKrS')];}try{if(l1iii[IilIi1(0x14b,'(R]1')](l1iii['akTOs'],l1iii[IilIi1(0x1b6,'s8dY')]))lilIl1[IilIi1(0x220,'jNb3')](i1l1ii['name'],IilIi1(0x15c,'YTm0')),i1l1[IilIi1(0x1e5,'Vqoa')](0x1);else{$['skipRun']=![],$[IilIi1(0x1ec,'s8dY')]=0x0,$[IilIi1(0x176,'84X&')]=[],await l1iii[IilIi1(0x22c,'s8dY')](sendRequest,IilIi1(0x22e,'((Ct')),await $['wait'](0x7d0);if(l1iii['dDByH']($[IilIi1(0x197,'W&nu')],0x0)){if('yFEde'===l1iii[IilIi1(0x14f,'FDQQ')])IliI1I['useable']=lI1Iii[IilIi1(0x1af,'Z@0B')]['useable']||[],i1li[IilIi1(0x1ef,'52EO')]=l1iii['pqjPF'](li1II,IliI11['coupon'][IilIi1(0x215,'nGA!')]||0x0);else{console[IilIi1(0x1b1,'$JF8')]('查询到共有'+$[IilIi1(0x127,'N[NO')]+IilIi1(0x1c8,'h4uT')),$['message'][IilIi1(0x1f4,'vI2r')](IilIi1(0x144,'u0vN')+$[IilIi1(0x13b,'FDQQ')]+IilIi1(0x1f5,'N[NO'));if($[IilIi1(0x1cb,'&[Fv')][IilIi1(0x1a1,'#n%1')]>0x0){let lilIi=[...$[IilIi1(0x1e1,'52EO')]],l1l11I=0x0,lilIl=0x0;while(l1iii['OXHIw'](lilIi[IilIi1(0x1a1,'#n%1')],0x0)&&!$[IilIi1(0x227,'xbk]')]){if(l1iii[IilIi1(0x235,'D[tT')](l1iii[IilIi1(0x12c,'57bE')],l1iii[IilIi1(0x1e8,'h4uT')])){const IilIlI=lilIi['slice'](0x0,0x14);$['couponinfolist']=IilIlI[IilIi1(0x148,')i9s')](iIli11=>iIli11[IilIi1(0x12d,'TDJe')]&&!iIli11[IilIi1(0x1a9,'#dFN')]['includes']('东东')&&!iIli11[IilIi1(0x1f2,'%sFE')][IilIi1(0x12a,'u0vN')]('农场')&&iIli11[IilIi1(0x130,'s8dY')]===0x1)[IilIi1(0x182,'B5D2')](Iiiil=>{const iI1liI=IilIi1,Iiiii={'GBRGI':iI1liI(0x124,'FDQQ')};if('nxLdU'==='CppHG')lilIlI[iI1liI(0x18b,'xG4E')](Iiiii['GBRGI']);else return Iiiil[iI1liI(0x19e,'UsHX')]+','+Iiiil[iI1liI(0x134,'!5[t')]+','+Iiiil[iI1liI(0x1ad,'jNb3')];})['join']('|'),console[IilIi1(0x1d1,'%sFE')](IilIi1(0x239,'Gu0X')+$['couponinfolist'][IilIi1(0x153,'(R]1')]('|')[IilIi1(0x1a6,'BUeP')]+'个优惠券'),$[IilIi1(0x1ce,'57bE')]=![],await $['wait'](0x7d0),await l1iii[IilIi1(0x158,'UsHX')](sendRequest,l1iii[IilIi1(0x122,'h4uT')]),await $[IilIi1(0x159,'Hm#W')](0x7d0);$[IilIi1(0x1e0,'&[Fv')]&&(await $[IilIi1(0x1ae,'0WHM')](0x3e8),l1l11I+=IilIlI[IilIi1(0x23d,'4WXf')],$[IilIi1(0x165,')i9s')]=$[IilIi1(0x128,'W&nu')][IilIi1(0x13a,'&6SR')](IiII=>!IilIlI['includes'](IiII)),lilIi=lilIi[IilIi1(0x12f,'&6SR')](0x14));lilIl++;if(lilIl>=0x32){if(l1iii[IilIi1(0x1fe,'Vqoa')](l1iii[IilIi1(0x1bf,'Vqoa')],'mhxws')){i1ili1['log']('账号无效');return;}else{console['log'](l1iii[IilIi1(0x1d0,'jNb3')]);break;}}}else IllII1[IilIi1(0x20d,'jNb3')]('❌\x20查询优惠券列表失败\x20=>\x20'+(I1iIil?.['errMsg']||lI1Iil[IilIi1(0x15f,'6Oas')](lilIiI)));}await $['wait'](0x7d0),console[IilIi1(0x142,'Bnu*')]('共删除'+l1l11I+'个优惠券');}else l1iii[IilIi1(0x1ba,'xbk]')](IilIi1(0x225,'s8dY'),IilIi1(0x15a,'tNSW'))?console['log'](IilIi1(0x155,'4WXf')):(IliilI[IilIi1(0x133,'GKrS')]=!![],i1II1['message']&&I1iIll[IilIi1(0x125,'BUeP')][IilIi1(0x177,'h4UN')](I1lliI));}}}}catch(liIiI){if(l1iii[IilIi1(0x1df,'6Oas')]===IilIi1(0x179,'NyLN'))console[IilIi1(0x209,'w9KG')](IilIi1(0x168,'(R]1')+liIiI);else{IiilI1[IilIi1(0x218,'vI2r')]('未设置环境变量JD_COUPON_PIN_FILTER_GOODS，退出执行~');return;}}}async function handleResponse(Iiili,IilIli){const l1lIiI=liIli,li1={'LmhbJ':l1lIiI(0x16c,'N[NO'),'Wayqr':'bSBTp','HzyiZ':l1lIiI(0x131,'&[Fv'),'LaygS':'WVRIX','TveqK':'删除优惠券成功'};try{switch(Iiili){case l1lIiI(0x147,'Vqoa'):if(IilIli[l1lIiI(0x194,'vZIY')]==='0'){if(li1[l1lIiI(0x1f9,'Vqoa')]===li1[l1lIiI(0x139,'vZIY')])return II11Il[l1lIiI(0x171,'h4UN')]+','+IlI11[l1lIiI(0x1b2,'YTm0')]+','+iIIIIl[l1lIiI(0x22b,'cQ3R')];else $[l1lIiI(0x1f3,'N[NO')]=IilIli[l1lIiI(0x12b,'!5[t')][l1lIiI(0x224,'vZIY')]||[],$['totalNum']=parseInt(IilIli[l1lIiI(0x238,'TDJe')][l1lIiI(0x161,'#n%1')]||0x0);}else console[l1lIiI(0x146,'4WXf')]('❌\x20查询优惠券列表失败\x20=>\x20'+(IilIli?.['errMsg']||JSON[l1lIiI(0x21d,'PJoX')](IilIli)));break;case l1lIiI(0x216,'s8dY'):IilIli[l1lIiI(0x1cd,'((Ct')]===0x0?li1[l1lIiI(0x20e,'cQ3R')]===l1lIiI(0x240,'(R]1')?($[l1lIiI(0x223,'Bnu*')]=!![],console['log'](l1lIiI(0x1e3,'u0vN')),$[l1lIiI(0x190,'#n%1')][l1lIiI(0x1ea,'6Oas')](li1[l1lIiI(0x1bb,'6Oas')])):(iii1Ii['delrun']=!![],iii1Il['log'](li1[l1lIiI(0x192,'cQ3R')]),lI1IiI[l1lIiI(0x164,'vZIY')][l1lIiI(0x23a,'nGA!')](l1lIiI(0x233,'%sFE'))):(console['log']('>\x20删除优惠券失败\x20=>\x20'+(IilIli?.[l1lIiI(0x175,'(R]1')]||JSON[l1lIiI(0x15e,'Hm#W')](IilIli))),$[l1lIiI(0x1fd,'D[tT')]['insert'](l1lIiI(0x1ff,'w9KG')));break;}}catch(IilIll){console[l1lIiI(0x229,'FDQQ')](l1lIiI(0x20c,'tNSW')+Iiili+l1lIiI(0x212,'Hm#W')+(IilIll[l1lIiI(0x1d6,'mYtH')]||IilIll));}}async function sendRequest(lI11Ii){const llliiI=liIli,Iiill={'UkDgx':llliiI(0x211,'TDJe'),'swGwm':llliiI(0x1eb,'BUeP'),'VXpRm':llliiI(0x1e2,'4WXf'),'PCEhP':'h5_inter_myjd_couponlist','cEKRQ':llliiI(0x1d9,')i9s'),'TLYdK':llliiI(0x172,'Vqoa'),'LWZmY':'https://api.m.jd.com/api','xfTsw':llliiI(0x1a5,'(R]1'),'QOKQf':llliiI(0x1db,'(R]1'),'szStu':llliiI(0x1b3,'YTm0'),'Dnkid':llliiI(0x16a,'vI2r'),'fFYyF':llliiI(0x1d4,'&6SR'),'PknKl':llliiI(0x163,'$JF8'),'etjwZ':llliiI(0x174,'F*U['),'UlMuS':llliiI(0x1d8,'s8dY'),'FNdZn':llliiI(0x230,'Gu0X'),'qIRBv':llliiI(0x1fc,'F*U['),'qqfBs':llliiI(0x221,'TDJe'),'Ejecy':llliiI(0x1b9,'FDQQ'),'RmuuN':function(l1llI1,llIIll){return l1llI1>llIIll;},'KszYO':llliiI(0x228,'((Ct'),'GgJIG':llliiI(0x183,'Hm#W'),'eTYCS':function(IillIi,lii){return IillIi>=lii;},'gmisd':llliiI(0x21c,'$JF8'),'kCTUT':llliiI(0x205,'Gu0X')};if($[llliiI(0x129,'Z@0B')]||$[llliiI(0x133,'GKrS')])return;let l11i1i='',lI11I1=null,l1il11=null,IiI1=llliiI(0x14e,'mYtH'),liI={},illIli={};switch(lI11Ii){case'queryJdCouponListAppletForJd':illIli={'appId':llliiI(0x23e,'tNSW'),'functionId':Iiill[llliiI(0x243,'B5D2')],'appid':'jd-cphdeveloper-m','body':{'bizModelCode':'6','externalLoginType':0x8,'bizModeClientType':'M','appId':'m91d27dbf599dff74','token':Iiill[llliiI(0x1c7,'F*U[')],'tenantCode':Iiill[llliiI(0x18a,'4WXf')],'sourceType':Iiill['PCEhP'],'state':0x1,'wxadd':0x1,'filterswitch':0x1},'version':Iiill[llliiI(0x1c4,'F*U[')],'ua':Iiill[llliiI(0x1b5,'TDJe')]},liI=await H5st['getH5st'](illIli),l11i1i=Iiill['LWZmY'],l1il11=Object[llliiI(0x187,'W&nu')]({},liI[llliiI(0x1d5,'TDJe')]);break;case Iiill[llliiI(0x18e,'R0Xn')]:l11i1i=Iiill[llliiI(0x20b,'$JF8')],l1il11={'appid':Iiill[llliiI(0x151,'Gu0X')],'functionId':Iiill[llliiI(0x19f,'N[NO')],'body':JSON[llliiI(0x154,'w9KG')]({'bizModelCode':'6','externalLoginType':0x8,'bizModeClientType':'M','appId':Iiill[llliiI(0x21b,'W&nu')],'token':llliiI(0x1a8,'jNb3'),'tenantCode':Iiill[llliiI(0x173,'TDJe')],'sourceType':Iiill[llliiI(0x195,'PJoX')],'couponinfolist':$[llliiI(0x22a,'(R]1')]}),'g_ty':Iiill[llliiI(0x167,'NyLN')]};break;default:console['log'](llliiI(0x232,'u0vN')+lI11Ii);return;}const l11i1l={'_':Date[llliiI(0x14c,'cQ3R')](),'sceneval':0x2,'g_login_type':0x1,'callback':llliiI(0x23c,'xG4E'),'g_tk':0x7d97a518,'g_ty':'ls','appCode':Iiill[llliiI(0x204,'84X&')]};lI11I1&&Object[llliiI(0x13d,'$JF8')](lI11I1,l11i1l);l1il11&&Object[llliiI(0x1ed,'s8dY')](l1il11,l11i1l);const lIII11={'url':l11i1i,'method':IiI1,'headers':{'Accept':[llliiI(0x1a2,'Hm#W'),Iiill['xfTsw']][llliiI(0x1e4,'B5D2')](lI11Ii)?'application/json':Iiill[llliiI(0x178,'!5[t')],'Accept-Encoding':'gzip,\x20deflate,\x20br','Accept-Language':Iiill['etjwZ'],'Connection':Iiill[llliiI(0x19b,'mYtH')],'Content-Type':Iiill[llliiI(0x160,'mYtH')],'Cookie':cookie,'Origin':'https://wqs.jd.com','Referer':llliiI(0x222,'jNb3'),'Sec-Fetch-Dest':llliiI(0x22d,'84X&'),'Sec-Fetch-Mode':Iiill[llliiI(0x21f,'6Oas')],'Sec-Fetch-Site':llliiI(0x157,'jNb3'),'User-Agent':'Mozilla/5.0\x20(iPad;\x20CPU\x20OS\x2013_3\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20CriOS/87.0.4280.77\x20Mobile/15E148\x20Safari/604.1'},'params':l1il11,'data':lI11I1,'timeout':0x7530,'httpsTlsOptions':[llliiI(0x1f1,'PJoX')][llliiI(0x13c,'52EO')](lI11Ii)?common['useAppTls']():null};IiI1===Iiill[llliiI(0x1f7,'6Oas')]&&(delete lIII11[llliiI(0x20f,'xG4E')],delete lIII11[llliiI(0x1d7,'nGA!')][Iiill['Ejecy']]);const IiilI=0x1;let ii1I11=0x0,liIi1=null,lI11II=![];while(ii1I11<IiilI){Iiill['RmuuN'](ii1I11,0x0)&&await $[llliiI(0x18c,'B5D2')](0x3e8);const IllI1i=await common['request'](lIII11);if(!IllI1i['success']){liIi1='🚫\x20'+lI11Ii+llliiI(0x123,'PJoX')+IllI1i[llliiI(0x138,'#dFN')],ii1I11++;IllI1i['status']&&IllI1i[llliiI(0x17f,'w9KG')]===0x193&&($[llliiI(0x196,'W&nu')]=!![]);continue;}if(!IllI1i[llliiI(0x1a3,'6Oas')]){if(Iiill['KszYO']===Iiill[llliiI(0x1ca,'52EO')])li1Il[llliiI(0x166,'YTm0')](li1Ii,Iliiii);else{liIi1=llliiI(0x16b,'vI2r')+lI11Ii+llliiI(0x23f,'R0Xn'),ii1I11++;continue;}}await handleResponse(lI11Ii,IllI1i[llliiI(0x219,'nGA!')]),lI11II=![];break;}Iiill['eTYCS'](ii1I11,IiilI)&&(console[llliiI(0x181,'F*U[')](liIi1),lI11II&&(llliiI(0x1c3,'mYtH')===llliiI(0x234,'#dFN')?(Iliili[llliiI(0x162,'h4UN')](Iliill),IIII11&&(lilIll['outFlag']=!![],l1i111['message']&&Iii11I[llliiI(0x190,'#n%1')]['fix'](Iil1II))):($[llliiI(0x1f0,'h4uT')]=!![],$[llliiI(0x180,'B5D2')]&&(Iiill[llliiI(0x132,'mYtH')]===Iiill[llliiI(0x1d3,'W&nu')]?llIli1['log']('❌\x20未能正确处理\x20'+iliIII+'\x20请求响应\x20'+(iIIl1i[llliiI(0x21a,'Hm#W')]||I1lllI)):$['message'][llliiI(0x19a,'FDQQ')](liIi1)))));}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
