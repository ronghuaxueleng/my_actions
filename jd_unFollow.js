/*
取关（收藏的）店铺和商品
环境变量：JD_UNFOLLOW_PIN_FILTER_GOODS // 不取关商品收藏的账号（填入pin，多个用@分割）
          JD_UNFOLLOW_PIN_FILTER_SHOP // 不取关店铺关注的账号（填入pin，多个用@分割）

cron:15 0-23/12 * * *
============Quantumultx===============
[task_local]
#取关（收藏的）店铺和商品
15 0-23/12 * * * jd_unfollow.js, tag=取关（收藏的）店铺和商品, enabled=true

注：系统可能会存在无法被正常取关的异常商品或异常店铺

*/

const $ = new Env('取关店铺关注和商品')
var iｉl='jsjiami.com.v7';const IliiiI=iii1II;(function(ilil1l,illlIi,I1lIii,IiI1I,illlIl,i11ill,IIIIIi){return ilil1l=ilil1l>>0x4,i11ill='hs',IIIIIi='hs',function(IIIIIl,I1lIil,IIIl1i,liiII1,IIIl1l){const lllili=iii1II;liiII1='tfi',i11ill=liiII1+i11ill,IIIl1l='up',IIIIIi+=IIIl1l,i11ill=IIIl1i(i11ill),IIIIIi=IIIl1i(IIIIIi),IIIl1i=0x0;const lllll=IIIIIl();while(!![]&&--IiI1I+I1lIil){try{liiII1=-parseInt(lllili(0x2ae,'BdR#'))/0x1*(-parseInt(lllili(0x1f5,'IPth'))/0x2)+parseInt(lllili(0x24d,'E$r)'))/0x3+-parseInt(lllili(0x1e6,'p$ZM'))/0x4+-parseInt(lllili(0x230,'IPth'))/0x5*(-parseInt(lllili(0x216,'200%'))/0x6)+-parseInt(lllili(0x23b,'iUdY'))/0x7+parseInt(lllili(0x2c7,'7*%d'))/0x8*(parseInt(lllili(0x2e8,'url6'))/0x9)+-parseInt(lllili(0x20a,'p2Qm'))/0xa;}catch(i11ili){liiII1=IIIl1i;}finally{IIIl1l=lllll[i11ill]();if(ilil1l<=IiI1I)IIIl1i?illlIl?liiII1=IIIl1l:illlIl=IIIl1l:IIIl1i=IIIl1l;else{if(IIIl1i==illlIl['replace'](/[kuOfSqtrgURbVnLHNI=]/g,'')){if(liiII1===I1lIil){lllll['un'+i11ill](IIIl1l);break;}lllll[IIIIIi](IIIl1l);}}}}}(I1lIii,illlIi,function(iil1l1,lllli,iiili1,ill11i,lllill,ill11l,I1lIiI){return lllli='\x73\x70\x6c\x69\x74',iil1l1=arguments[0x0],iil1l1=iil1l1[lllli](''),iiili1=`\x72\x65\x76\x65\x72\x73\x65`,iil1l1=iil1l1[iiili1]('\x76'),ill11i=`\x6a\x6f\x69\x6e`,(0x1598c7,iil1l1[ill11i](''));});}(0xcb0,0xcc78a,Iii11l,0xcd),Iii11l)&&(iｉl=`\xce4`);const jdCookie=require(IliiiI(0x2b5,'F*RO')),notify=require(IliiiI(0x1ca,'56RD')),common=require(IliiiI(0x26e,')Din')),{H5st}=require('./utils/Rebels_H');function Iii11l(){const il1i1l=(function(){return[...[iｉl,'LnUjqkusttrjHiaUrmbigR.fcHoNm.gSVv7OUIfb==','WRRdGJ/cLCk3jLjeWPbFCG','vh7cTSk8kSo/WQhdHLmcrG3cS8kWWQKnWRiXuCkuW6tcPmoNWRq4WRaYB0yvAmkw5lM25y2C5ywx5zsm5zgE5PAC6jEG55UQ6lE55y+m776l5Agf5yEefmkBW6FVVO/LPkBKUl7NL4C65yIT5yUN','W43dOmo+W54','fmkGgSod','W6KGWQzsh2PgW7OWwxWu','WOFcJ8o+W7jB','geJdKgW4CW','WR00W7dcNCkozSoBW50','WPddMZRdOHL0WRBLVOlLPRpJG6hKUllKUyVOTipLJkq','ptNdQbdcVqaSyLNdPvJdM8oYuCkkqGDTW6Dr','k8osWO5dcG','jmkzd23dQW','WQW8W6RcSCk3','qSodWP0','r8o3na7cUh4','WPZcJfqXW5K','iSkGW50','W4lcMae','WQreW6HrhSozWPzYW787W5lcTCk9h8ogWQiR','le/cUmkMe8oBWOG','g8kYbmope18','hHqEomkq','WQjuW7SCqa','WRVcNtW3kWXyWRe','W7FcIhat','W43cHMmoyMJdOazYlhTxou/dVSoRdt0JWR4kkvHHW5mSFmoAWP/dO8klWOBdH8ooWQfVWPJcMMBdO8kKAmkAECk3W7KfACk7W5bYqaVdP1ddS8kWW4TrEbT3p8kGWQ1av8oeW4Xuebvrw8kkxeNdOGjhWOnXtCofsLldSrqXWQKlfgpcKSo8W6hdNCoaW5beW7NcLmofW6tcLCoFFSkYWQZdRa0','CrqilK8','sSkRWRBcPIyvpq','lSobWOnakG','otJcP0Katq','W4LfW4BcOvmtbmk2W58','ge7dKhqYDIficIaLkSoWzhtdTrq','t8oGWOW+tmoKg2neW7VcVwGcWQTAemkSCCo0sCoLW4pdSSoJ','fSkKgCobafK','W77ORiFMSyBLP7pOTRdcMUkDMCkd','WO7dNLm','WOO3WQpcSCop','w8oFW78jWP3dRSoArCo0BdPkoMiDnCoMW5hdKgO','WO7ORBlMS5xLPOpOTPNdTEkCICkB5PAp5zoV5BUN5PA85O6U','WQ7dHIBcVmo1lKLdWQrcFshcQ8kY','hCkyW4ldV8kdWPupW6xdJCoKA8k1WOZdLa','W4tdOSo6','qSoMWOOdtmk5','cmokW7q','iCorW5mg','W7LcW6FcOw8','wCkyWR7dMZNcJtON','qmkMWQVcLa','e8kteSos','cdxcVh7dNLK','j8kTW6LaWRu','fZlcTa','sCoQpLldLKfdWPO','dColW7FcSri','lHqunSkbWPq','fCoQW74Bta','qSojWPtcQCofW4u','mSoWWRvyeG','ESo1W6q','j8ouW4VcJqm','aSomW6xcKWm','WQ/dJd7cNmo1pNbFWPHsAtBcQSknWQhcVCkJ','n8o0W6hcJCop','eXRcQvVdKq','a8oqW5tcR8oHW5H2','fJajdvKuAq','W6FcRSogeqC','sCkqWRy','W4TJW5FcOMq','W5hcVfaWxW','lgNdV3aq','s8o7WP8','WP7dGg/cUCkY','WPFcQMxcS8ot','wSodWO7cR8oDW6njWRG','aSokW7/cUavWW5lcMuVcPCoUwmklahf3CW','WRG4W43dU3m','W63cKhNcVa','kW7dM8oDv8kmWRFdVuKAFrm','W404B8kaW77cVW','s8oEWOJcG8ocW4O','WRKCWRpcN8o5','hI/cOupdPfO','mSk0W70','W4nDW47cUvm','W6BcHNulyxpdKvSOzJ4uzvtdVSo2hq','4P6oc+AERUEFMoIUHUAZRmoM','W4C5BSkw','FwVcK8k9fG','sHtcIYfTnaDRisehiq','WRacW6e','WP1mrCoYW4ddGrKKWQRdQW','pSkKg8o1hf5bhuKT','WQBcU8oCWOJcVGboWRrGW7JcL0PWWOqnxSoidG','lSo9yxzq','WRNdGK7cUSkVW7NdLbzrW7FdTqxdMg3cSg0','nmo8WRrhn8kD','WRhdHYLjpG','W55JWQesW43cHc4','WQj3W4CcsW','jCoDW4FcVcG','nctcSW','pmoFW5mC','FCokWPNcMSou','ebFcQx3dGG','WOVcHSo+WQZcPG','W4VcHhxcUKOnW7tdRqJcT8o/iwNcUNNdG8knxWlcMq','W77cSqZdKv8PWRxdHqKaE8kgWQ0','e8krW4FdS8kmWPabW6JcOSkC','kmk9W6vsWP4'],...(function(){return[...['WQLoW6fnxmopWQPPW6y6','W5eOmSk3WPu','msxcP0uvvW','dZlcP2/dU3pdK1G','e8oUw39jFYu','hsldObhcKW','WQZcNsu7dIy','WRGnW6C','h8o5W4BcLSoO','WRVdNxRcMCkE','oSk8W6Hm','W552W65dW6RcRCkBBW','W7qYDCkMW7S','n8oHWQHmnCkQhmouhG','f8kKbmovfvzu','omkYW6i','lXfJW7tcTmkA','kqCsgmkAWOzJovxdOwVcHI0','W6dcRCoCnGhdJdpdRSkSWPXBW4q3W5v3WP3dQcpdUe/cISoEW49gfvTsamoucSo1W6G+W6O6jmoU','W7ZcVvitlq','8kkRVwW','WOtcIbS8dq','W4ZcTuyWgKTgamoSwHPlomo3hdiDyW3cR8ovAcZdPWW5vSkB','amoaW7/cKGvRW67cHfpcKCoPvmkBoxTW','5RcB5PY45yEh5RcG55Q55BUJ6zkx','DSo9WRJcMmoN','WOxcL0mqW7NcUZfrW4e','WOiAWPtcLCo4WOm','W5DOW5dcUuu','lctcOeelBCkYFW','g8kTlZ/cV3BdKgJdVuBdSw0jW6JdHebcCmoWWRFcGCk0W4G','hmkUg8okg0zHkuC/rmkhWQJdP8o+W47dPq','mSk0W6LDWQtcSW','ftZcVMS','wSkXW6W','W43cSuKOya','rSoQntVcN34','uSovWQaBEW','WQJdGaJcUSow','WPrGW5mrzW','WPOqWO7cK8oGWQuKW7m','zCoUW7flhbWcW69Y','t8koWR3cUMG','WRnKW6qvx2yQWP4HEdOFWRFdOqrzW47dIXtcOSkOcg7dJYCtlcRcKmolWPddIMDpeSojWQZcMmo+Ba','W77cRx9KghavW617WQVcRa','WQq+W7FcJ8kdt8ol','WQBdP1NcPrvS','kJ9zW5/cPG','Cty9mgaxySk4','rmolWPC','xCogWOlcM8o5','WP8KW57dMe0','WQ9oW7DoemojWQm','boIUSUAWMUwsJ+w6ULy','cYNdUsRdSsaW','oSoFW50','cCoaW6lcHCop','WOhdMuJcPmkJW47dMqO','DmokWOdcPmoE','W55JWQmhW4tcMG','W6NcH3OlE2ddPfO','W5rLWQG','sCkXWQu','mmkwW6XQWQNdLG4w','4PYhrUAEG+IUMEw5PEMqIEwfVUAYT+wiREIJPEwKTUI3JhRdMCo4hq','mCkwoSoRaG','W4mZAmkMW6pcPmoKzXRcKsL1l0i','kCo9WRndkCkNk8oY','W4fMWRucW48','kaKlfSk7WPC','z8olW6O','5lUX5BQh6zgQ','W4PeW4FcOa','WOmmWP0','CLxcJG','W7BcNNC','WPVdVvVcKH5nW6xdKcOJt8kbWQ/dN3xcOmoIWRn8vq','WPZcSCo/W5hdPSkaW6FdKa','W7ZcMgNcIxS','W6VcLgOwnwPS','W5nFW4FcRu8a','WOxdKLJcU8k3W43dMq','5Bs85PE56jwN','WR3cU8oAWPhcO10iW71U','W7D75y2s5yAp5zAK5zoP5PAy6jw/5AAz6lwUDCkwu8or','rSkXWQBcHq','WO/cIvawW7y','bMNdQuWE','WQW2W7tcImkB','cSkGbCohguj1oLW6','WOVcLYqflY1DWPOJWOi','kGpdM8oyxmkoW5BdSeWOrcpcRq','kCohW7pcU8o6','WQ7cGJG6lIfmWQGRWPVdSJ1EWO3cUCk1','W6/dGdtdTmkTWOpcV8oHwmk8fCkE','xSoNiZG','amkPW7TEWQi','e8kVe8odda','W4dcNNS9ia','v8oTnsFcS3VdJq','l8kYeSouoLbCpG','WQ7dHNmdtwVdRKiUzW','W57cVmo5lcS','5y255y+95yE3','adCLdG','W6PVW6Pj','WRBcPSohW75OWOlcJSk/WQiSWPSA','W7HTW6rbW63cQa','W4RdQSo5W5C','iIq0oCkw','WQdcUSomW7HdWO3cL8o3','iqKpfq'],...(function(){return['oSovW5qvvCk6','c8ohW5xcKCoZW5G','xmonW60JWOG','WQpcVmkyWPVcRanuWQOMWR0','W4bdW4ZcH3q','W4KJhCk7','5y645yEg5BIW6zcM5yEZ5Rgx5OId5yQa','vSkrW7VcTZbsW7dcGa','nmkqW6XQWP7dPaSCWQf2W4FdGCkwq8oTWPa','gdZcP23dVW','W63cJgOuB2pdPa','mbXIW6pcICkw','xmoSks7cPg4','DCkSWPVcUKK','W6X/W6jbWOJdRmksB0WCxCoxWOxdVgulFW','6lAg5y6g5PAy5PAh','W6xcM2SQFwm','fCk0a8oGgfbw','5BAw5yEw5Rg7','WP0lWOJcM8oIWOW4W7JcTW','WQBcQSoHWOJcOa','pIlcOMCo','o8ozuNPR','5lQy5zEz5zcE','WPZdMf/cQCk6W6tdIrq','WPFcJSoUWQNcGG','c8oXWQK','rCowWP0dBa','WQpcNs8','cmoCW58','W6zzWQxcUtyWW4VcOmoZW50zWPBcNG','sSonWO7cRW','WPnYW5vCia','qCo7WPqIumkPzd5kW6/cOsuBW4Lzb8o2','5Rg65PYz5PAM6jAQ55QO5zsA5zoe','WQlcQSogWP/cUvi','ns7cP1mgrmkI','WPP8W5GDwW','i8olWQzshq','W4pdOmoKW4hdNCkYW7a','WRxdHcTszJuWgCoMyI9Jlq','cK7dIhKXtWrx','WQxdJdu','WOZdLL/cQq','WOFcLLqlW67cMJDBW5qYWOldLeNdG8kJW7pdUci','W6RcNN4','bCovW5xcRqu','vw3cPmkKeG','duNdK2Guzq','WQfeW6Lqomok','WRRcINu2W7q','6lAM5yYE5PE55PsV','WRnEW6fpcmoOWQLSW7WWW5dcHSk7pmolWQq8sa','eSoKtW','WRz1W6mwttTG','WPhdM1hcUCk4','xmojWOVcU8ouW55i','gJm/cCkvWOdcLG','e8oJW4pcVX8','W77dPmoWW4xdTq','pmkgg1BdRq','WO/dKL/cHCkZW5NdJXHgW5q','W5NcRmonnaVcPxtcRSkRWQSuW5GFWPjNWOBdGw3dQK8','W7tcMhpcO30/W7hdPW','WOlcJeuyW7VcKI1A','5yYF5ysO5BIt6zcg5yAr5Roa5AAF6lAv','WQ5eW6m','WQFdJcu','lGC9W7dcOColaCkjW5ldGq','gmobW7ayuq','gCkZeSohafq','tCkyW4JdVSoq','sSoXWOS9xSk5uq','W6LKW79sW4ZcUCkyBeuCumomWPC','W7xcGLOPBW','W6VcHhxcUKOyW7pdRHtcNSoPb1FcVg7dGSkQsG','kmk65y2v5ywr5zs05zk65PwD6jwg5OIB5yI2','zSofW70','W4KVDmkCW6i','DSoHWP08rSknxcnvW43cTtaJW6XdamogC8oVrq','5BAm5Psx6jwZ','WPGUW6hcJSkBE8ogW5/dMa00W50HWPGbW7S','W4KFhmkQWOu','eeddKx0','sCksWQBdVdRcRYmLCfVdO8oDESkdnvi','aI3dOaC','W6fHWQzsW5tcPmksB1WvumomWPdcTtDeya','ESoYW7bDWQJcRwLOp8o4W4HdWOldNCo7umkXWO9xf8kyWRhdKMjOo3S','aSkgW7TAWQy','kSoqW4VcJ8oOW5bJwrS6','W4G2aSkAWRS','W5dcG17cG8kdW57dVIa','CSo7W7Dd','44g15OY156AZ44cj6kYq5yE/6i+u5y6LWPjFW4NdNmkZtW','W44EdW','dColW7dcUb9JW6FcMa','c8kkW74','5y+16ys46kY+5PQ0Amo+CNC6nSkSWO8JW4S','emkkW4ruWQ4','mmo6yMzy','WQ/dUKZcJXu','WQBdP1K','WRNdOfhcKcL/W6ddMG','gCouW47cQa','t8kwWR7dMt3cTIeSAgFdVCoDAq','W49RWQyh','WOesWP7cMSok','eJpcOgVdPuK','W6xcVmoBnrpcKxK','W7raW77cOK0','WR8FW7JdOhrlWRdcVSoY'];}())];}())];}());Iii11l=function(){return il1i1l;};return Iii11l();};console[IliiiI(0x2dc,'8TBJ')](''),console[IliiiI(0x29a,'IPth')](IliiiI(0x24e,'p2Qm')+$[IliiiI(0x1e5,'CeBf')]+IliiiI(0x1d4,'apQE')),console[IliiiI(0x2ea,'3u9!')](IliiiI(0x1e3,'IPth')),console[IliiiI(0x21c,'PxQ@')]('JD_UNFOLLOW_PIN_FILTER_SHOP\x20//\x20不取关店铺关注的账号（填入pin，多个用@分割'),console['log'](IliiiI(0x23d,'6MbU')+$[IliiiI(0x271,'u]gZ')]+'提示结束=========='),console[IliiiI(0x28d,'Mm&h')]('');const pinFilterGoods=(process[IliiiI(0x2da,'v2ac')][IliiiI(0x266,'url6')]||'')[IliiiI(0x214,'56RD')]('@'),pinFilterShop=(process[IliiiI(0x23c,'%m)V')]['JD_UNFOLLOW_PIN_FILTER_SHOP']||'')['split']('@'),isNotify=![];let cookie='';const cookiesArr=Object[IliiiI(0x2af,')Din')](jdCookie)[IliiiI(0x296,')uZ)')](Iiili=>jdCookie[Iiili])[IliiiI(0x28b,'Mm&h')](IilIli=>IilIli);!cookiesArr[0x0]&&($[IliiiI(0x299,'u]W5')]($[IliiiI(0x25a,'56RD')],'【提示】请先获取Cookie'),process[IliiiI(0x211,'&@qg')](0x1));function iii1II(_0x5bbe37,_0x3575ab){const _0x8fc63c=Iii11l();return iii1II=function(_0x5e75c3,_0x246568){_0x5e75c3=_0x5e75c3-0x1ba;let _0x4b7b73=_0x8fc63c[_0x5e75c3];if(iii1II['CSsIbk']===undefined){var _0x4b88ce=function(_0x524bc3){const _0x2b61d0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4a16e0='',_0x345a61='';for(let _0x3746bc=0x0,_0x53d98b,_0x2b05c2,_0x5be723=0x0;_0x2b05c2=_0x524bc3['charAt'](_0x5be723++);~_0x2b05c2&&(_0x53d98b=_0x3746bc%0x4?_0x53d98b*0x40+_0x2b05c2:_0x2b05c2,_0x3746bc++%0x4)?_0x4a16e0+=String['fromCharCode'](0xff&_0x53d98b>>(-0x2*_0x3746bc&0x6)):0x0){_0x2b05c2=_0x2b61d0['indexOf'](_0x2b05c2);}for(let _0x2a50cb=0x0,_0x4b4c9c=_0x4a16e0['length'];_0x2a50cb<_0x4b4c9c;_0x2a50cb++){_0x345a61+='%'+('00'+_0x4a16e0['charCodeAt'](_0x2a50cb)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x345a61);};const _0x486839=function(_0x4b1396,_0x3a68dd){let _0x2b7ebd=[],_0x3e2268=0x0,_0x5734b3,_0x44cbab='';_0x4b1396=_0x4b88ce(_0x4b1396);let _0x5e97cc;for(_0x5e97cc=0x0;_0x5e97cc<0x100;_0x5e97cc++){_0x2b7ebd[_0x5e97cc]=_0x5e97cc;}for(_0x5e97cc=0x0;_0x5e97cc<0x100;_0x5e97cc++){_0x3e2268=(_0x3e2268+_0x2b7ebd[_0x5e97cc]+_0x3a68dd['charCodeAt'](_0x5e97cc%_0x3a68dd['length']))%0x100,_0x5734b3=_0x2b7ebd[_0x5e97cc],_0x2b7ebd[_0x5e97cc]=_0x2b7ebd[_0x3e2268],_0x2b7ebd[_0x3e2268]=_0x5734b3;}_0x5e97cc=0x0,_0x3e2268=0x0;for(let _0x354ee5=0x0;_0x354ee5<_0x4b1396['length'];_0x354ee5++){_0x5e97cc=(_0x5e97cc+0x1)%0x100,_0x3e2268=(_0x3e2268+_0x2b7ebd[_0x5e97cc])%0x100,_0x5734b3=_0x2b7ebd[_0x5e97cc],_0x2b7ebd[_0x5e97cc]=_0x2b7ebd[_0x3e2268],_0x2b7ebd[_0x3e2268]=_0x5734b3,_0x44cbab+=String['fromCharCode'](_0x4b1396['charCodeAt'](_0x354ee5)^_0x2b7ebd[(_0x2b7ebd[_0x5e97cc]+_0x2b7ebd[_0x3e2268])%0x100]);}return _0x44cbab;};iii1II['JXmQNj']=_0x486839,_0x5bbe37=arguments,iii1II['CSsIbk']=!![];}const _0x1726bd=_0x8fc63c[0x0],_0x2037c0=_0x5e75c3+_0x1726bd,_0x3acb0f=_0x5bbe37[_0x2037c0];return!_0x3acb0f?(iii1II['ZWWeOH']===undefined&&(iii1II['ZWWeOH']=!![]),_0x4b7b73=iii1II['JXmQNj'](_0x4b7b73,_0x246568),_0x5bbe37[_0x2037c0]=_0x4b7b73):_0x4b7b73=_0x3acb0f,_0x4b7b73;},iii1II(_0x5bbe37,_0x3575ab);}!(async()=>{const Ill11=IliiiI,li1={'ownWu':'>\x20取关店铺关注成功','RHChM':Ill11(0x2c6,'sqh5'),'UiMnH':function(illIl1,l1llII){return illIl1<l1llII;},'LiDOc':function(IilIll,lI11Ii){return IilIll(lI11Ii);},'guEYO':'pt_pin','iadBB':function(Iiill){return Iiill();},'iKTLf':function(l11i1i,lI11I1){return l11i1i===lI11I1;},'cQzTr':Ill11(0x2fb,'B#N^')};notify['config']({'title':$[Ill11(0x1c6,'iUdY')]});for(let l1il11=0x0;li1['UiMnH'](l1il11,cookiesArr[Ill11(0x2c0,'SgO1')]);l1il11++){$[Ill11(0x2b1,'CeBf')]=l1il11+0x1,cookie=cookiesArr[l1il11],common['setCookie'](cookie),$[Ill11(0x25b,'1dap')]=li1[Ill11(0x2f2,'LjV2')](decodeURIComponent,common[Ill11(0x292,'Hy0v')](cookie,li1[Ill11(0x288,'sqh5')])),$[Ill11(0x2a1,'WX9C')]=notify[Ill11(0x306,'CeBf')]($[Ill11(0x1c5,'6MbU')],$['UserName']),$[Ill11(0x2ff,'*OPz')]='',console['log'](Ill11(0x1ea,'*OPz')+$[Ill11(0x217,'7*%d')]+'】'+($['nickName']||$[Ill11(0x2be,'!&c8')])+'******\x0a'),await li1['iadBB'](Main),common['unsetCookie']();if($['runEnd'])break;await $[Ill11(0x20e,'SgO1')](0x7d0);}isNotify&&notify[Ill11(0x2fd,'WX9C')]()&&(li1[Ill11(0x27f,']101')](li1['cQzTr'],li1[Ill11(0x23a,'IPth')])?await notify[Ill11(0x298,'QCLg')]():(i1illI[Ill11(0x25f,'56RD')](li1[Ill11(0x224,'0vcy')]),i1IIl['message']['insert'](li1[Ill11(0x228,'iUdY')])));})()[IliiiI(0x2c9,'u]gZ')](liI=>$[IliiiI(0x27e,'E$r)')](liI))[IliiiI(0x244,'Mm&h')](()=>$[IliiiI(0x2bc,'B#N^')]());async function Main(){const liiIII=IliiiI,illIli={'ylzqn':liiIII(0x268,'QCLg'),'AxThB':'>\x20取关商品收藏成功','qnmsW':'取关商品收藏成功','omdhF':liiIII(0x2b3,')Din'),'EMQfs':function(lIII11,IiilI){return lIII11!==IiilI;},'XQBVV':'hEtev','UGDth':liiIII(0x277,'p$ZM'),'NqJjp':function(ii1I11,liIi1){return ii1I11!==liIi1;},'uAXUD':liiIII(0x291,'CeBf'),'ygWgg':function(lI11II,l1llI1){return lI11II>l1llI1;},'PvIzx':'已设置当前账号不取关商品收藏','hGzUF':function(llIIll,IillIi){return llIIll(IillIi);},'uoMLI':'VdrCP','SfcTe':function(lii,IllI1i){return lii(IllI1i);},'lwDMz':liiIII(0x2f4,'Y(06'),'mTZuw':'CjPmW','YAFQO':liiIII(0x2e2,'p$ZM'),'jqlHO':function(i11I1l,lil){return i11I1l(lil);},'vLalt':function(IllI1l,i11I1i){return IllI1l!==i11I1i;},'myhyn':'nWDHo','MXPOn':function(IillIl,llliil){return IillIl===llliil;},'QYQaQ':'PdiCw','zLKvy':function(liIl1,II1lll){return liIl1/II1lll;},'fiyAH':'RmVnX','tQurD':function(II1lli,ii1I1I){return II1lli>ii1I1I;},'MXlJy':liiIII(0x21b,'u[#t'),'egnMU':liiIII(0x1cc,'sqh5'),'vBzhv':function(IiIl,IiIi){return IiIl(IiIi);},'GAcvq':liiIII(0x1bc,'1dap')},l11i1l=await common[liiIII(0x209,'3u9!')](cookie);if(!l11i1l&&typeof l11i1l===illIli[liiIII(0x1dd,'u]W5')]){if(illIli['EMQfs'](illIli[liiIII(0x269,'p2Qm')],illIli[liiIII(0x1ed,'200%')])){console[liiIII(0x29b,'*OPz')](liiIII(0x2f3,'F*RO'));return;}else i1ili1['log']('已设置当前账号不取关商品收藏');}try{if(illIli[liiIII(0x305,'SgO1')](liiIII(0x2ef,'IPth'),illIli[liiIII(0x275,'p2va')]))IIlii['message']['fix'](IlI1il);else{if(illIli['ygWgg'](pinFilterGoods['length'],0x0)&&(pinFilterGoods[liiIII(0x28c,'F*RO')]($[liiIII(0x2b4,'CeBf')])||pinFilterGoods[liiIII(0x1d2,'7*%d')](encodeURIComponent($[liiIII(0x28f,'6l7L')]))))console[liiIII(0x225,'rpV2')](illIli[liiIII(0x240,'QQAa')]);else{$['totalNum']=0x0,$['followProductList']=[],await illIli[liiIII(0x1cd,'6MbU')](sendRequest,liiIII(0x1be,'*OPz'));if(illIli[liiIII(0x245,'p$ZM')]($['totalNum'],0x0)){if(illIli[liiIII(0x1ec,'v2ac')](liiIII(0x251,'6MbU'),illIli[liiIII(0x1d5,'6l7L')])){console[liiIII(0x2f5,'QQAa')](liiIII(0x1c3,'iUdY')+$[liiIII(0x2d8,'WX9C')]+'件商品'),$[liiIII(0x2e7,'B#N^')]['insert'](liiIII(0x2a2,'eNf9')+$[liiIII(0x22c,'p2Qm')]+liiIII(0x2d7,'v2ac'));const l1il1l=Math[liiIII(0x1e4,'B#N^')]($[liiIII(0x278,'u]W5')]/0x1e);for(let liIil=0x0;liIil<l1il1l;liIil++){await $['wait'](0x3e8),$[liiIII(0x26f,'CeBf')]=$[liiIII(0x201,'iUdY')][liiIII(0x270,'56RD')](IllI1I=>IllI1I?.['commTitle']&&IllI1I?.[liiIII(0x295,'@qV9')]&&IllI1I?.[liiIII(0x2f1,'Y(06')]!=='0');if($[liiIII(0x22d,'7*%d')][liiIII(0x21a,'p2Qm')]>0x0){const liIii=$[liiIII(0x237,'F*RO')]['map'](II1ll1=>II1ll1['commId']);console[liiIII(0x1d8,'E$r)')](liiIII(0x2b7,'Y(06')+liIii[liiIII(0x26b,'u]W5')]+'件商品'),$[liiIII(0x256,'8TBJ')]=liIii[liiIII(0x248,'SgO1')](','),await illIli[liiIII(0x249,'p2Qm')](sendRequest,liiIII(0x1c7,'apQE')),await $[liiIII(0x22f,'*OPz')](0x7d0);}$[liiIII(0x2e1,'p2va')]=[],$['commId']='',await sendRequest(illIli['lwDMz']),await $[liiIII(0x1da,'sqh5')](0x1388);}}else lIIil1['log'](IIli1),II1liI&&(I1l1Il[liiIII(0x2d1,'CeBf')]=!![],llIll1[liiIII(0x222,'sqh5')]&&lIIiil['message'][liiIII(0x205,'WX9C')](l1lIii));}else illIli[liiIII(0x1d6,'QQAa')](illIli[liiIII(0x22e,'%m)V')],liiIII(0x24b,'eNf9'))?(console['log'](illIli[liiIII(0x220,'sqh5')]),$[liiIII(0x1df,'0vcy')][liiIII(0x252,'RLaV')](illIli[liiIII(0x2d9,'eNf9')])):iliIIi['log']('❌\x20查询店铺关注列表失败\x20=>\x20'+(ill11I?.[liiIII(0x2c1,'sqh5')]||Iliiil[liiIII(0x200,'QCLg')](li1Il)));}console[liiIII(0x302,'Y(06')]('');if(pinFilterShop[liiIII(0x260,']101')]>0x0&&(pinFilterShop[liiIII(0x289,'WX9C')]($['UserName'])||pinFilterShop[liiIII(0x289,'WX9C')](illIli[liiIII(0x27a,'rpV2')](encodeURIComponent,$[liiIII(0x280,'qrAZ')]))))illIli['vLalt']('nWDHo',illIli[liiIII(0x1c1,'Hy0v')])?(iIIIIi[liiIII(0x1c0,')uZ)')]('没有关注的店铺'),iii1I1['message'][liiIII(0x2a0,'QCLg')](illIli[liiIII(0x294,'Mm&h')])):console[liiIII(0x28d,'Mm&h')]('已设置当前账号不取关店铺关注');else{if(illIli[liiIII(0x2fc,'200%')](liiIII(0x25c,'Hy0v'),illIli[liiIII(0x2e0,'Y(06')])){$[liiIII(0x2d8,'WX9C')]=0x0,$['QueryShopFavListData']=[],await illIli[liiIII(0x221,'u]gZ')](sendRequest,liiIII(0x241,'WX9C'));if($[liiIII(0x210,'apQE')]>0x0){console[liiIII(0x287,'SgO1')]('已关注'+$[liiIII(0x2e9,'iUdY')]+'个店铺'),$[liiIII(0x1bb,'p2va')][liiIII(0x231,'Hy0v')](liiIII(0x2d2,'7*%d')+$['totalNum']+liiIII(0x297,'p$ZM'));const ll1=Math['ceil'](illIli[liiIII(0x263,'url6')]($[liiIII(0x1e9,'BnnZ')],0xa));for(let iI1llI=0x0;iI1llI<ll1;iI1llI++){if(illIli[liiIII(0x1e0,'QCLg')](illIli[liiIII(0x29e,'*OPz')],illIli['fiyAH']))lI1Iil[liiIII(0x215,'u]gZ')]('❌\x20查询商品关注列表失败\x20=>\x20'+(lilIiI?.[liiIII(0x218,'@qV9')]||i1l1I[liiIII(0x2a3,'eNf9')](IiilIi)));else{await $[liiIII(0x2b8,'#k$Y')](0x3e8),$[liiIII(0x1eb,'!53S')]=$[liiIII(0x207,')uZ)')][liiIII(0x1e8,'iUdY')](IllI11=>IllI11?.[liiIII(0x1d9,'E$r)')]&&IllI11?.['venderId']&&IllI11?.[liiIII(0x274,')Din')]&&IllI11?.['shopId']!=='0');if(illIli['tQurD']($[liiIII(0x29c,'E$r)')]['length'],0x0)){const l1llIi=$[liiIII(0x24c,'*OPz')][liiIII(0x257,'%m)V')](II1llI=>II1llI[liiIII(0x2cb,']101')]);console[liiIII(0x2f5,'QQAa')]('去取关'+l1llIi[liiIII(0x203,'CeBf')]+'个店铺');if(l1llIi[liiIII(0x2e3,'eNf9')]<=0x1){if(illIli[liiIII(0x273,'F*RO')](illIli[liiIII(0x24f,'6l7L')],liiIII(0x24a,'u]gZ'))){IiilI1[liiIII(0x247,'RLaV')](liiIII(0x2cf,'6MbU'));return;}else $[liiIII(0x2bb,'1dap')]=l1llIi[0x0]||'',await sendRequest(illIli[liiIII(0x1ee,'BnnZ')]);}else $['shopId']=l1llIi[liiIII(0x2bf,'@qV9')](','),await illIli['vBzhv'](sendRequest,illIli['GAcvq']);await $[liiIII(0x2b8,'#k$Y')](0x7d0);}$['QueryShopFavListData']=[],$[liiIII(0x2bb,'1dap')]='',await sendRequest(liiIII(0x1c4,'BnnZ')),await $[liiIII(0x1fa,'F*RO')](0x1388);}}}else console[liiIII(0x20d,'7*%d')](illIli[liiIII(0x2f7,'WX9C')]),$[liiIII(0x29f,'url6')][liiIII(0x2a0,'QCLg')](illIli[liiIII(0x236,'QCLg')]);}else iii1Il[liiIII(0x29b,'*OPz')](illIli[liiIII(0x246,'7*%d')]),lI1IiI[liiIII(0x25e,'CeBf')][liiIII(0x2cc,')Din')](illIli[liiIII(0x255,'!53S')]);}}}catch(ii1I1l){console[liiIII(0x229,'p2va')](ii1I1l[liiIII(0x284,'Y(06')]);}}async function handleResponse(ii1I1i,llI){const li1i11=IliiiI,llliI={'sVLMr':li1i11(0x1d0,'6l7L'),'CqXYi':function(iI1li1,lllii1){return iI1li1(lllii1);},'GrTgz':function(liIli,liIll){return liIli!==liIll;},'Zfzjo':li1i11(0x1fc,'qrAZ'),'ukCNa':li1i11(0x1cb,'6l7L'),'WcImu':'delFollowProduct','zrxOI':function(IilIi1,iI1liI){return IilIi1===iI1liI;},'wKLdr':li1i11(0x1bf,'PxQ@'),'acZJL':li1i11(0x2c8,'6l7L'),'QxmSb':function(l1lIiI,llliiI){return l1lIiI===llliiI;},'QUIWQ':li1i11(0x2e6,'v2ac'),'JHIVI':li1i11(0x2e5,'p$ZM'),'fiJnv':li1i11(0x2aa,'8TBJ'),'cciwS':'取关店铺关注成功'};try{switch(ii1I1i){case'queryFollowProduct':llI[li1i11(0x2a5,'&@qg')]==='0'?($[li1i11(0x21f,'3u9!')]=llI[li1i11(0x1f4,'Y(06')]||[],$['totalNum']=llliI[li1i11(0x21d,'7*%d')](parseInt,llI?.[li1i11(0x2e9,'iUdY')]||0x0)):llliI[li1i11(0x2ac,'sqh5')](llliI[li1i11(0x28a,'p2Qm')],llliI[li1i11(0x1bd,'F*RO')])?console[li1i11(0x28e,'&@qg')]('❌\x20查询商品关注列表失败\x20=>\x20'+(llI?.[li1i11(0x2d0,'F*RO')]||JSON[li1i11(0x26a,'LjV2')](llI))):(I1l1Ii[li1i11(0x1fd,'&@qg')]=!![],I1i11i['message']&&llIlil[li1i11(0x2ca,'F*RO')][li1i11(0x2dd,'sqh5')](IIlil));break;case llliI[li1i11(0x233,'u]W5')]:llliI['zrxOI'](llI['code'],'0')?(console['log'](llliI['wKLdr']),$[li1i11(0x2f9,'#k$Y')]['insert']('取关商品收藏成功')):(console['log'](li1i11(0x2a4,'BnnZ')+(llI?.[li1i11(0x232,'p2Qm')]||JSON[li1i11(0x279,'PxQ@')](llI))),$['message'][li1i11(0x242,'u[#t')]('取关商品收藏失败'));break;case llliI[li1i11(0x276,'3u9!')]:llliI['QxmSb'](llI[li1i11(0x212,'CeBf')],'0')?llliI[li1i11(0x227,'F*RO')]!==llliI[li1i11(0x283,'%m)V')]?($[li1i11(0x2fe,'0vcy')]=llI[li1i11(0x2df,'p2Qm')]||[],$[li1i11(0x300,'LjV2')]=parseInt(llI?.[li1i11(0x1f9,'8TBJ')]||0x0)):I1iIl1[li1i11(0x1d8,'E$r)')](i1il[li1i11(0x27d,'BnnZ')]):console['log'](li1i11(0x290,'@qV9')+(llI?.[li1i11(0x20c,'p2va')]||JSON[li1i11(0x2d3,'u]W5')](llI)));break;case llliI['fiJnv']:case li1i11(0x1db,'apQE'):llliI[li1i11(0x2c4,'QCLg')](llI[li1i11(0x2c5,'6MbU')],'0')?'igkHm'!=='ZHuXg'?(console[li1i11(0x2ea,'3u9!')]('>\x20取关店铺关注成功'),$[li1i11(0x2f6,'p$ZM')][li1i11(0x242,'u[#t')](llliI['cciwS'])):(lilIl1['msg'](i1l1ii[li1i11(0x1c8,'!53S')],llliI['sVLMr']),i1l1['exit'](0x1)):(console[li1i11(0x2dc,'8TBJ')]('>\x20取关店铺关注失败\x20=>\x20'+(llI?.[li1i11(0x234,'u]gZ')]||JSON['stringify'](llI))),$[li1i11(0x254,'QQAa')][li1i11(0x1de,'u]gZ')](li1i11(0x301,'BnnZ')));break;}}catch(IiI11){console[li1i11(0x2ed,'url6')]('❌\x20未能正确处理\x20'+ii1I1i+li1i11(0x285,'qrAZ')+(IiI11[li1i11(0x254,'QQAa')]||IiI11));}}async function sendRequest(lli){const iI11I1=IliiiI,liIlI={'CZDim':function(il1i1I,lI1li1){return il1i1I(lI1li1);},'yDkyl':function(iI11II,iIII1I){return iI11II(iIII1I);},'vwDqd':iI11I1(0x1ba,'p2Qm'),'apFyo':'queryFollowProduct','nRkuZ':iI11I1(0x1c9,'1dap'),'qRcjY':iI11I1(0x243,'F*RO'),'joeHN':iI11I1(0x27c,'8TBJ'),'fivGi':iI11I1(0x1fb,'F*RO'),'VgwXl':iI11I1(0x202,'p2va'),'UrxCb':iI11I1(0x2c3,'eNf9'),'sjxUH':'delFollowProduct','IZaqF':'https://wq.jd.com/fav/shop/QueryShopFavList','qLaJh':'jsonpCBKA','ERzvC':iI11I1(0x23e,'CeBf'),'mYdqx':iI11I1(0x1e1,'%m)V'),'xHUTC':iI11I1(0x261,'@qV9'),'bZBIs':iI11I1(0x27b,'p$ZM'),'sSDbo':iI11I1(0x25d,'u[#t'),'yrTeS':iI11I1(0x2ad,'8TBJ'),'CsSiR':iI11I1(0x1f3,'WX9C'),'apHZT':'zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6','heIpm':iI11I1(0x250,'Y(06'),'SoraH':iI11I1(0x23f,'eNf9'),'yjaoa':'https://wqs.jd.com/','dHYCC':iI11I1(0x2a8,'BnnZ'),'SjQQH':iI11I1(0x239,'Hy0v'),'KzSjJ':iI11I1(0x1e2,'3u9!'),'wFPku':function(ilil1i,IlIIi){return ilil1i===IlIIi;},'pvtpM':'GET','FobXt':iI11I1(0x2ba,'!&c8'),'qbGFW':function(IiI1l,illlII){return IiI1l>illlII;},'bBeMS':function(iIII11,IiI1i,llll1){return iIII11(IiI1i,llll1);},'rFWxV':function(lil11l,i1i1Il){return lil11l>=i1i1Il;},'eLrFE':function(I1lIl1,lil11i){return I1lIl1!==lil11i;}};if($[iI11I1(0x1f0,')Din')]||$['outFlag'])return;let lll='',llli1=null,iIli1i=null,iI1lii=iI11I1(0x1f2,'6l7L'),IilIii={},iI1lil={};switch(lli){case'queryFollowProduct':iI1lil={'appId':liIlI[iI11I1(0x22a,'WX9C')],'functionId':liIlI[iI11I1(0x2ee,'7*%d')],'appid':liIlI['nRkuZ'],'clientVersion':liIlI[iI11I1(0x226,'QCLg')],'client':'H5','body':{'cp':0x1,'pageSize':0x1e,'category':'','promote':0x0,'cutPrice':0x0,'coupon':0x0,'stock':0x0,'area':liIlI[iI11I1(0x1f1,'LjV2')],'tenantCode':iI11I1(0x20b,'B#N^'),'bizModelCode':'6','bizModeClientType':'M','externalLoginType':'1'},'version':iI11I1(0x272,'v2ac'),'ua':liIlI[iI11I1(0x21e,'7*%d')],'t':!![]},IilIii=await H5st[iI11I1(0x286,'!53S')](iI1lil),lll=liIlI[iI11I1(0x2c2,')uZ)')],iIli1i=Object[iI11I1(0x1f6,'CeBf')]({},IilIii[iI11I1(0x2a9,'CeBf')],{'sceneval':'2','g_login_type':'1','g_ty':iI11I1(0x2b9,'1dap'),'appCode':liIlI['UrxCb']});break;case liIlI['sjxUH']:lll=liIlI['VgwXl'],llli1={'commId':$['commId'],'tenantCode':iI11I1(0x281,'p2Qm'),'bizModelCode':'6','bizModeClientType':'M','externalLoginType':'1'},iIli1i={'appid':'jd-cphdeveloper-m','functionId':iI11I1(0x267,'7*%d'),'body':JSON['stringify'](llli1),'loginType':'2','sceneval':'2','g_login_type':'1','g_ty':'ajax','appCode':liIlI[iI11I1(0x2bd,'#k$Y')]};break;case'QueryShopFavList':lll=liIlI[iI11I1(0x22b,'BdR#')],iIli1i={'cp':'1','pageSize':'10','_':Date[iI11I1(0x1d3,'6l7L')](),'sceneval':'2','g_login_type':'1','appCode':liIlI[iI11I1(0x1f7,'@qV9')],'callback':liIlI[iI11I1(0x258,'sqh5')],'g_ty':'ls'};break;case liIlI[iI11I1(0x2d6,'QQAa')]:lll=iI11I1(0x262,'0vcy'),iIli1i={'shopId':$[iI11I1(0x2f0,'iUdY')],'_':Date[iI11I1(0x303,'3u9!')](),'sceneval':'2','g_login_type':'1','appCode':iI11I1(0x304,']101'),'callback':liIlI[iI11I1(0x26c,'QCLg')],'g_ty':'ls'};break;case liIlI[iI11I1(0x2a7,'iUdY')]:lll=liIlI['bZBIs'],iIli1i={'shopId':$[iI11I1(0x213,'u]gZ')],'_':Date[iI11I1(0x1d1,'6MbU')](),'sceneval':'2','g_login_type':'1','appCode':'ms0ca95114','callback':liIlI[iI11I1(0x1fe,'u[#t')],'g_ty':'ls'};break;default:console['log'](iI11I1(0x238,'Y(06')+lli);return;}const l1lIi1={};llli1&&Object[iI11I1(0x1ff,'RLaV')](llli1,l1lIi1);iIli1i&&Object['assign'](iIli1i,l1lIi1);const iIli1l={'url':lll,'method':iI1lii,'headers':{'Accept':[iI11I1(0x2ec,'LjV2'),liIlI[iI11I1(0x282,'p2Qm')]]['includes'](lli)?liIlI['yrTeS']:liIlI[iI11I1(0x20f,'QCLg')],'Accept-Encoding':iI11I1(0x2ce,'1dap'),'Accept-Language':liIlI['apHZT'],'Connection':liIlI[iI11I1(0x2d4,'eNf9')],'Content-Type':'application/x-www-form-urlencoded','Cookie':cookie,'Origin':liIlI['SoraH'],'Referer':liIlI[iI11I1(0x2a6,'LjV2')],'Sec-Fetch-Dest':liIlI[iI11I1(0x206,'u]W5')],'Sec-Fetch-Mode':liIlI[iI11I1(0x259,'WX9C')],'Sec-Fetch-Site':liIlI[iI11I1(0x265,'8TBJ')],'User-Agent':liIlI[iI11I1(0x2d5,'RLaV')]},'params':iIli1i,'data':llli1,'timeout':0x7530};liIlI[iI11I1(0x2fa,'7*%d')](iI1lii,liIlI['pvtpM'])&&(delete iIli1l[iI11I1(0x2eb,'WX9C')],delete iIli1l['headers'][liIlI[iI11I1(0x2b2,'url6')]]);const i1i1II=0x1;let liiIIl=0x0,iil1iI=null,IlIllI=![];while(liiIIl<i1i1II){liIlI['qbGFW'](liiIIl,0x0)&&await $[iI11I1(0x1dc,'Mm&h')](0x3e8);const IlIIl=await common[iI11I1(0x2f8,'p2Qm')](iIli1l);if(!IlIIl['success']){iil1iI='🚫\x20'+lli+iI11I1(0x204,'BdR#')+IlIIl[iI11I1(0x1d7,'E$r)')],liiIIl++;continue;}if(!IlIIl[iI11I1(0x2eb,'WX9C')]){iil1iI=iI11I1(0x264,'#k$Y')+lli+iI11I1(0x208,'B#N^'),liiIIl++;continue;}await liIlI[iI11I1(0x2db,'p2va')](handleResponse,lli,IlIIl[iI11I1(0x1cf,'PxQ@')]),IlIllI=![];break;}liIlI[iI11I1(0x1e7,'!&c8')](liiIIl,i1i1II)&&(liIlI[iI11I1(0x2b0,'6l7L')](iI11I1(0x2b6,'0vcy'),'VeQjY')?(i1li['followProductList']=li1II['followProductList']||[],IliI11[iI11I1(0x293,'u[#t')]=liIlI[iI11I1(0x219,'SgO1')](i1ll,i1l1lI?.[iI11I1(0x253,'u]gZ')]||0x0)):(console[iI11I1(0x1ef,'p2Qm')](iil1iI),IlIllI&&($['outFlag']=!![],$[iI11I1(0x2e4,'RLaV')]&&('VPaHl'!==iI11I1(0x2cd,'rpV2')?$['message'][iI11I1(0x235,'56RD')](iil1iI):(iliIII[iI11I1(0x1c2,'p2va')]=iIIl1i['data']||[],I1lllI['totalNum']=liIlI[iI11I1(0x1f8,'p$ZM')](ill111,Iliil1?.[iI11I1(0x26d,'RLaV')]||0x0))))));}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
