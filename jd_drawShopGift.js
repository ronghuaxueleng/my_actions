/*
活动名称：店铺关注有礼
环境变量：jd_drawShopGift_argv // 活动参数，支持三种格式：”<shopId(店铺id)>_<venderId(店主id)>“ 或 ”<venderId(店主id)>“ 或 ”<活动店铺首页链接>“
        jd_drawShopGift_Notify // 是否推送通知（true/false），默认不推送

活动限制IP严重，建议使用代理
黑号领不到奖品

cron:1 1 1 1 *

*/

const $ = new Env('店铺关注有礼')
var iｉl='jsjiami.com.v7';function iii1II(_0x3f23e6,_0x19c4bd){const _0x33cce6=Iii11l();return iii1II=function(_0x2e3c9a,_0x3b456b){_0x2e3c9a=_0x2e3c9a-0x85;let _0x2aa257=_0x33cce6[_0x2e3c9a];if(iii1II['GddXUb']===undefined){var _0x35ba27=function(_0xc5f81d){const _0x20c6eb='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1f9968='',_0x521cda='';for(let _0x2d4418=0x0,_0x314cff,_0x3ad043,_0x110b0c=0x0;_0x3ad043=_0xc5f81d['charAt'](_0x110b0c++);~_0x3ad043&&(_0x314cff=_0x2d4418%0x4?_0x314cff*0x40+_0x3ad043:_0x3ad043,_0x2d4418++%0x4)?_0x1f9968+=String['fromCharCode'](0xff&_0x314cff>>(-0x2*_0x2d4418&0x6)):0x0){_0x3ad043=_0x20c6eb['indexOf'](_0x3ad043);}for(let _0x37d5f1=0x0,_0x5ace26=_0x1f9968['length'];_0x37d5f1<_0x5ace26;_0x37d5f1++){_0x521cda+='%'+('00'+_0x1f9968['charCodeAt'](_0x37d5f1)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x521cda);};const _0x506422=function(_0x7c01ea,_0x54f7d0){let _0x891635=[],_0x540ee0=0x0,_0x53ae5b,_0xa0b988='';_0x7c01ea=_0x35ba27(_0x7c01ea);let _0x99a75a;for(_0x99a75a=0x0;_0x99a75a<0x100;_0x99a75a++){_0x891635[_0x99a75a]=_0x99a75a;}for(_0x99a75a=0x0;_0x99a75a<0x100;_0x99a75a++){_0x540ee0=(_0x540ee0+_0x891635[_0x99a75a]+_0x54f7d0['charCodeAt'](_0x99a75a%_0x54f7d0['length']))%0x100,_0x53ae5b=_0x891635[_0x99a75a],_0x891635[_0x99a75a]=_0x891635[_0x540ee0],_0x891635[_0x540ee0]=_0x53ae5b;}_0x99a75a=0x0,_0x540ee0=0x0;for(let _0x21dc7d=0x0;_0x21dc7d<_0x7c01ea['length'];_0x21dc7d++){_0x99a75a=(_0x99a75a+0x1)%0x100,_0x540ee0=(_0x540ee0+_0x891635[_0x99a75a])%0x100,_0x53ae5b=_0x891635[_0x99a75a],_0x891635[_0x99a75a]=_0x891635[_0x540ee0],_0x891635[_0x540ee0]=_0x53ae5b,_0xa0b988+=String['fromCharCode'](_0x7c01ea['charCodeAt'](_0x21dc7d)^_0x891635[(_0x891635[_0x99a75a]+_0x891635[_0x540ee0])%0x100]);}return _0xa0b988;};iii1II['MylFzu']=_0x506422,_0x3f23e6=arguments,iii1II['GddXUb']=!![];}const _0x207146=_0x33cce6[0x0],_0x56ca7c=_0x2e3c9a+_0x207146,_0x47a2f6=_0x3f23e6[_0x56ca7c];return!_0x47a2f6?(iii1II['rCgQSM']===undefined&&(iii1II['rCgQSM']=!![]),_0x2aa257=iii1II['MylFzu'](_0x2aa257,_0x3b456b),_0x3f23e6[_0x56ca7c]=_0x2aa257):_0x2aa257=_0x47a2f6,_0x2aa257;},iii1II(_0x3f23e6,_0x19c4bd);}const IlIlll=iii1II;(function(IIIIIi,IIIIIl,I1lIil,IIIl1i,liiII1,IIIl1l,lllll){return IIIIIi=IIIIIi>>0x4,IIIl1l='hs',lllll='hs',function(i11ili,iil1l1,lllli,iiili1,ill11i){const il1i1l=iii1II;iiili1='tfi',IIIl1l=iiili1+IIIl1l,ill11i='up',lllll+=ill11i,IIIl1l=lllli(IIIl1l),lllll=lllli(lllll),lllli=0x0;const lllill=i11ili();while(!![]&&--IIIl1i+iil1l1){try{iiili1=parseInt(il1i1l(0x10e,'CT#2'))/0x1*(-parseInt(il1i1l(0x130,'unaq'))/0x2)+parseInt(il1i1l(0xcd,'lYa2'))/0x3*(-parseInt(il1i1l(0xff,'0j^o'))/0x4)+parseInt(il1i1l(0x1cb,'o3zC'))/0x5*(-parseInt(il1i1l(0xdb,'mxPJ'))/0x6)+-parseInt(il1i1l(0x194,'$0Vb'))/0x7+parseInt(il1i1l(0x110,'&lY6'))/0x8*(parseInt(il1i1l(0x156,'&wec'))/0x9)+-parseInt(il1i1l(0x128,'R0tf'))/0xa+parseInt(il1i1l(0x86,'pfKe'))/0xb;}catch(ill11l){iiili1=lllli;}finally{ill11i=lllill[IIIl1l]();if(IIIIIi<=IIIl1i)lllli?liiII1?iiili1=ill11i:liiII1=ill11i:lllli=ill11i;else{if(lllli==liiII1['replace'](/[KESTkygQNtJxwpnheMrG=]/g,'')){if(iiili1===iil1l1){lllill['un'+IIIl1l](ill11i);break;}lllill[lllll](ill11i);}}}}}(I1lIil,IIIIIl,function(I1lIiI,lllili,IliiiI,Ill11,liiIII,li1i11,iI11I1){return lllili='\x73\x70\x6c\x69\x74',I1lIiI=arguments[0x0],I1lIiI=I1lIiI[lllili](''),IliiiI=`\x72\x65\x76\x65\x72\x73\x65`,I1lIiI=I1lIiI[IliiiI]('\x76'),Ill11=`\x6a\x6f\x69\x6e`,(0x15bcbb,I1lIiI[Ill11](''));});}(0xcb0,0x5ae99,Iii11l,0xcd),Iii11l)&&(iｉl=Iii11l);const jdCookie=require(IlIlll(0xc2,'Dfbk')),notify=require('./utils/Rebels_sendJDNotify'),common=require('./utils/Rebels_jdCommon');console[IlIlll(0x14a,'e3fX')](''),console[IlIlll(0x166,'l&VA')](IlIlll(0xf1,'[Too')+$[IlIlll(0x100,'lYa2')]+IlIlll(0x91,'CpPS')),console[IlIlll(0x167,'i8YV')](IlIlll(0x152,'@$J]')),console[IlIlll(0x190,'m!8P')](IlIlll(0x14f,'IN6k')),console['log'](IlIlll(0xa4,'unaq')+$[IlIlll(0x15e,'$0Vb')]+'提示结束=========='),console[IlIlll(0x1c2,'o3zC')]('');const activityArgv=process['env'][IlIlll(0x153,'h)$g')]||'',isNotify=process[IlIlll(0x171,'R0tf')][IlIlll(0xf7,'m!8P')]==='true';let cookie='';function Iii11l(){const lil111=(function(){return[...[iｉl,'yjtMsjJyiKraTmiS.hgceomQ.Mvxk7wNtSpKGnEE==','W5z1WPVcTConCmoXWOPwW5a','4PIMDUISUUwISUwgM+AGMow9NUAVOUEJLUEBQUEpIEwGNEwmUEMeMq','W4BdGSo0W7Hw','sCk/bConW6G','hs/dLMRcGmojt3lcRadcL8oC','W5NdMCk8WQBdT2FcUq','4P6TgUADPUEFSoISGoAYTSkA','8jQKL++6TdG','gf44pCkt','WPhcNSkiWPBdLq','W7pcNCksjCk0bWjI','WOD5juZcNq','AmoHWP7dImkGgrRdUglcMsGejG','W6hcS8oS','vmozWPu','WPFdIqJcLcqp','WOXJvmo8WPG','WOhcR33cUmkw','W5bPW4ZcVHRcQCoSWOJcHW','hwe3d8kg','WRPrW7xcIXi','Cmk8WPeRW4X5','W5bHWPlcQmov','WRtcOSot','8yAxKU+5Qa','cCkylxXHW7FcVmk8','FaBdUGxcRq','WPeUWQNcHdOG','W6ibW7a','a2GunCkg','W5aaWR8','CwNcHIRdUmkEw10','ESkJW4HRsHug','WOGSWQlcPHW','WOqVWR4','W4JcJfGaW6OtBG','WOq/aY15','WQb3zZi','g8kxkffl','WOpdTSoOWOibW6e','bCklW49yFHLCWOCsW6G','WRmCAmoJgq','WR8hWRNcRmobdmk0aa','4PQ0W7ZORA3LHl3LRB7KU73LVRpOPlZNMk7NJkdLO5xLJONPHzdLKyRLHQZOVj7OOBBOHzJMNPK','xIRdNapcQ8oRWRFdVW','W6pcTCoOW4RdH8kiW7Gg','WO5kW4KMW6ZcMSorWOmEbYBdSSkkW7C7W74tlCowW4FcHmkq','WPddKbZcImoV','W5hXH66O77Ut','WOeFFSoKaa','WPmUaHjKW60','WPZdVmo7WOqCW7ZcTmowWQ0','tSomWPBcRbW','uutdICoeD3lcJG','W545WPNcQ8omc8kx','sNVcJJ0','WPBdISoY','5P2755Yu5RAs5yMh54QZ5OcW','WPXdW4dcGG4','wSoAWR4bbq','W50EWQ7dNLS','WRdcM0hcHmkE','WQ85W4pcKSo0WQxcUW','WOTvjxS','WRr+jX/dNt1SW5SwfarcWPVdPrZdRedcMxyIE8kAAIr0t8kiWQBdNX7cLIFcS8oXW7ZdMmkdW6vSWRG1WOC5W43dMG','WPaJWRFcGry3cq','WPZdGXS','WPRdM8oYWOWWkZbI','d2TFWRBcVa','W7KnWRxcGWBdTSofpSol','cCkxW7ZcPa','WPnHvmkxW5y6WQdcNq','WOPKsCoSWOpcSfjd','WQqZW5a','CSk1W6i','W5ZdMCkUWRhdS3lcRW','WP/dGCoTW4VcNG','WRLpW6RcQIRdHW','oCkngNLd','W4v3WOhcUmouDa','WQpdLbpcKsC','W717WRdcNCovca','C8kPW5v9','CCoqWRhcUb3dPq','qwlcIIW','WQ00x8o6aG','A8olWO3cVtFdOSoRW50d','W5eHy8kIW7We','WRFdHtNcU8o1','W5OgWQa','hXSXB10','WP3dIq/cRqaRW7q','W4JcJfGaW6SBCbxcQCkXW7yaog4MeMuAWPbjW60peW','WPlcHmkRWPFdRG','lCoPWQ9hW5lcGG/dT8oUW4Sefq','tSoeCIa8WRxdHCkRFmktW5VcNSkW','ESk1W7KEWQRdLrVdMa','W6TjsmoyW7RcOSkF','lqqmugm','WO1Boa','WRHsW6VcNW3dHW','W7hcUCkdimke','WRVcOSoqoq','W4hcG1JdK8oSW4eciCkPWQ4','W554WOZcSmooFCoGWOa','laeoFhNdNW','tGDaW6fwWPjshbdcLvugWOa','WQxdGCoDWReg','WQzFW7FcNcxdHmoy','e0rQWPhcNq','oLxdOXqqWQLKkW','dSkijMP9W5BcGCkQymkYW57cVSksW7hcNYhdGCk3hq'],...(function(){return[...['WPqJWQJcKby2nmoa','amkKW5ZcPhC','BL/cQW','6lAs5y2l5PsV5PAD','WQDvW6m','WRZJGBNLUzdPKA3LNkNLNllJGjldHmo5erm8jM5GuSk9tCoOhZxcQgddHCkoctXZW6mnWQzGbZlcTJCF','xCohWPDTsq','WRZcG8kRWPtdNG','WQ7dOmo5WP8q','fSktmh12W7e','W6xcM8o4W6JdMG','WOCIcq','4P6vW5hMN7pOGiBMR4/NO5JLPBRNKk5m','dmkvlgHnW6e','W4pORQVMSRRLKlBLU4JdHG','W6u5WQpcUMnq','W7H6WQq','WRxcNSk+','WQHGi8olWRC','zmorWRlcVdhdSW','WQ4AW7VcTmoL','8jk2J++6P1m','W67dLSoUW65Pjg3cJCkuh8o5bCk0AmoiWOKPmvfNimk0WQfOymkC5PQ35zcH6ygQ552O776BFSoEWR/dNxBcPxNcJ8k3WPJVV6dVVRBPUB/ORBNKU6JPGi/NN5K','dL95WOVcKq','CCkVW4m','zmkSlmo6W73cRSoMW4qlWRjPWPWRcGBcOCkVDmoxWQddUfH8dUA1SUwkIUwoR+AwI++8JUAJS+w9To+8VokaHJSat8o1dSkqWRFdMmoHzsbZEWCKtmohDGxIG5O','W6FcUmouW4xdU8kiW6iWh8k8edvCtxZcQ8ogw8orAq','W7eLWPFcOeK','WRaTWRhcN8od','gfegWOypW4PgothcS04x','xb/dUapcIW','5y+M5lIu5REy5yUW5OQM5yMG5l2W5PYs6AgU5y6s5yU15AEo5zkA','zSkpamoxW5W','W7WcW7ZdM8oW','WR/cQmoafSowna','4PI6W5pORiBLHihLRzVKUkRLVQlOPPdNM53NJ4BLOPtLJRdPH4pLKl7LH67OVONOOAlOHR7MNAG','WPFdHmoL','lmoIWOFdKa','W6PjvComW6/cRq','FmkJW55ObHmpWOZdH8kj','pvTDWQRcNG','lbetthVdJW','qa1hW60kW5msDKu','W4mVFCkEW6C','W7uIWR/cSgXdomoNW4e','W5JdK8kO','egbk','WQVcLmkQWO7dGmoc','nmk9W5ZcG8o5tK8','tvNdKSoYuNC','WRxdGGhcOCoY','DmovWRyYda','WP7dMbH9','W53cQ8k/W78yW7tcR8olWOik','DEw5QUMsUEwCQowDHo++N8kDWQX9WQZdISoqW5lcKCkoi8olWQrhW4BcPSkpDaCfWPLIoKT9WQpdGmkPWRVcRJa','WOmTW7hcG8on','gSktnq','W4r+WOdcRmoYFq','WORdRsVcUc4','WPxdMba','W7FcLSkcoSkGbai','WRNdQtRcNCoY','pXCuughdKG/cPNriCI0','WOldVmo8WRqsW7tcUG','W4dcQfu6W6S','W7SbDmkRW4m','WOKJWR/cHW','W6i6uSkMW7aeWQddSSotWQJcLK4','WPRdGJVcNSoKW4uxjSkq','WOvnW6iRW6JcKSosWQK/bJddMG','zmkYW4LXrrukWOpdIa','lSoSWO0','WPFdVSosW48M','W5xdJmk/WRNdV2pcVCoLA8kdh8kxW7NcKqdcTc3dQSkhq103W5/cRr99W6lcQSkVzxudWOO','ov7dVHubWPHcic/dIb0','WP3dGSo6','eNSKlSk/','W6FdNCoFW6L6mq','soocK+w5VEMrJ+wsSEEKV+ocIE+/IG','p1JdOGaQWRPDpXVdIrCfW5FcQsraW5GZ','WRe7vComceZcLCkg','WQuXWRdcPXq','W5HJWPVcMSoxEmoI','CCoqWRhcUaVdOmo+W54VWPeEW5XwWQCJrSkVW7BcS8kx','8kcPLMm','noISQ+AZMowsUow5Smku','jem5kSkLdLxdHW','WOHbW7e','W7b0WRFcMq','8yg8To+6Jq','WOWNWQVcKq','Cmk7W5/cGSkeW73dVCkCWORdR8oIW5G','j8oUWPRdGCof','pSo2WRbFW47cNNW','D8o1WRKIfW','WPZcH0tcR8kCp1W','WQbyWOBcJCoKgSkk','FColWQ1YyW','W5VdHCkxWQtdVG','W53cRSk+WQSXW4BcP8oZWQ4','4PU5W7JORzJLOPVLHihMOjxLVkxMR6JNOBNNMzlNJ6xLO7pLJRpPHAa','vthdHHdcUCkL','W4pcIfG','kSkSW53cMCo2tKpdRw4','WQJdH8kzdmkcmXnt','WP3cJva','W5pcNCkApmkR','W6a/WRu','WQyTW7BdJ8kFtSkHW40nDCojDa','WPa9WPxcNNhcICotWQtcKsa3','tqnaW5m','WOLWaa','bJSMFNe','W4ddKaBdPmotAaK2W4X7WR0'],...(function(){return['WQRcRmoAomo8eq','WOrUW5tcQGi','nmk2W5pcN3a','WObclvVcUW','WRHYwmotWQJcOKXhWOpcUW','W7VcLmoKW7hdKW','WR84WQxcPSok','gmkyn0TSW6RcHCkqzSkXW5ZcQ8kEW4RcLd3dJCkGemoIW6BcG38','aM7cNupdQmoHWQJdOmkc','pLxdVGuzWQ8','W6PcFCoeW64','WQVdSa/cN8oX','8yERT8oy','utVdHIBcMq','WOpdHbpcRIGO','WO8DWR7cTmo1','l8oSWPVdRmog','4P+4WPZOH5xMN7NOVyBOOyZPGPVLIQhKUOtPL7xORP7cSG','noISQ+AZMowLHoI3GCku4P+QWP3MLyRLKylLU4lMLkhMJ7e','ttWFW5FdPmkMdtVdRSkiWOPz','WQxdNmom','WPi7hq58','vmoyWPu','W7BcNmkw','WPRdImo2W4G1kITRWO3dNG','5REr5yUC5lUr5A6g5z6N5OM75BsR6AoJ6l+X','5P+K55+Z5BQD6zkT','WQP3W6NcUay','WQldTcpcGSoJ','W7tcN8kEpCkl','z3RdQSoHAa','B8owWQHzxLBcSv0','WQ/dH8oeFCo0jZfxfarF','44oy5O6m56An44oq6k2Q5yAk6i2I5yYZcCkijaVdL8ka','a1uVlCkhgW','W4yiWRxdPhWNCCoaW50ees5XjdTeWQC','WO8ZWP8','W7GlW7NdJmoqWOPeW7a','W4pcHKS','WQaeWRNcSWK','WQGyW7ldHSorWP1/W53cUmkQ','WOHSaa','W4DHWRVcMSoY','W7q9W7tdISoZ','WOtdKahcNW','y8obWPNdMZyiDab4qvhdJJT5','v3lcJcJdV8kB','B8kRb8o3W7NcPSoLW64QWRn/WRq','5BQo6zgj5zol56En77YHbW','W5mWwmkfW7OyWRa','W6bQD8oEW6m','l1/dOXmuWQ8','WPddNGBcJCoUW4e','WONcHSo7k8oz','WO93uYtdRW','W6RcRMSxW5a','5y+b6yw86kYY5PIZbHNdHqtcHCo/EXKYW5S','E8kqoCoKW4K','WPNdGHJcUXK','bhCDk8kb','tmkDW70bWPi','W5xcIMu3W4W','WQpdOSoyW6WR','mHSh','WR1gW5SMW4O','CSoZWRO','zCkRWPOUW51UfGm','shxcHa','5y+a5lQ25REL5yMG5OMe5yIE5l+i5P6e6Ao25yYV5yMb5AEN5zoY','hMCXn8kz','W5f/WOhcVCoxDCo8','W61eWPtcQ8oS','4P6hgUAERUIaKUASP+EJJEwMUEErTmkn','WRrCbe/cJG','WRTLtCoPWP7cUvbwWQpcT8o2WOm','W47cJfxdLSk6WPTpAmoEW7y','WOLlW6uXW7/cNmod','WP9dFXZdJG','tCkEiCokW4y','W7LWWRdcI8ogg8kH','44o/5O2j56A144ow6k6e5yEB6i2O5y2PWOSaWP0SW5T9','ECk5W6KgWOxdKXm','WRtcLmkQWOJdJCorgW','mCo3WPJdNmosWQJdSCk2WOm','WPhdJWJcTXCLW6xcUrqC','W7VcUCoLW4xdRmkBW5Wh','r3xcJNBcHCojbLRcNt3dQ8oYp8k9WPjSaNnQ','WRO5W4tcTmoXWRy','WOxdHGy','amk0W6lcHMe','W7jtWQpcJ8o1','e18ZnmkodLy','WPDRcmoSWRfj','WQXJxSo3WQpcTLzaWP0','WOZcGSk8WONdOSoxe00','W7vevmoBW5NcPmkjWQHwfCo4W6S','s1lcHdpdRa','WP7cGmkwWR7dLq','nSkuW53cO2Pwjf9jELxdMqn5','WO81WQe','WPzBjwe','WRz5x8o7WR/cPq','pCkQW47cH8olquxdU1dcVYWe','W6RdHmoTWR7dQSo5m20D','WOVdQ8oUWRaGW7VcSmopWO8gWPqZ','W49KgWnlW7zaorBcMq','W7v2WRFcKCorfCkWW7G0wa','WQiZW7NcICoB','jSoIWP7dLa','WO1vkW','WQLYqSo6WQJcO3zc','lNzhWOhcOa'];}())];}())];}());Iii11l=function(){return lil111;};return Iii11l();};const cookiesArr=Object[IlIlll(0x17b,'RRFS')](jdCookie)[IlIlll(0x101,'Nnb0')](li1=>jdCookie[li1])[IlIlll(0x14c,'JI8F')](illIl1=>illIl1);!cookiesArr[0x0]&&($[IlIlll(0x1a8,'E]V6')]($['name'],IlIlll(0xa9,'!Vn$')),process['exit'](0x1));!(async()=>{const IIIl1I=IlIlll,l1llII={'dxkOX':IIIl1I(0xf4,'2YXv'),'hGsIS':IIIl1I(0x19d,'Y^tT'),'lnFou':IIIl1I(0xf5,'@*DG'),'DtQPr':function(l11i1i,lI11I1){return l11i1i===lI11I1;},'QUuKr':IIIl1I(0xfd,'JI8F'),'uXJzF':IIIl1I(0xed,'Dfbk'),'IojQt':IIIl1I(0xa0,'4%[A'),'cKxvT':function(l1il11,IiI1){return l1il11===IiI1;},'OTPEF':IIIl1I(0xda,'pP4w'),'XIZMh':function(liI,illIli){return liI!==illIli;},'jAPpS':'RTBmW','OCKGT':'KqFBP','ohYwo':function(l11i1l,lIII11){return l11i1l===lIII11;},'QEKid':'eVUsB','rXHmm':'店铺不存在','ATpIK':IIIl1I(0x1c5,'5r52'),'fFLux':function(IiilI,ii1I11){return IiilI+ii1I11;},'nlotJ':function(liIi1,lI11II){return liIi1(lI11II);},'LBlrH':IIIl1I(0x120,'&lY6'),'sdrUi':function(l1llI1,llIIll){return l1llI1+llIIll;},'oyXqh':'30.','NOhor':function(IillIi,lii){return IillIi-lii;},'EELSN':IIIl1I(0x16d,'2NIn'),'rNUlu':function(IllI1i,i11I1l){return IllI1i-i11I1l;},'kJriE':function(lil,IllI1l){return lil||IllI1l;}};if(!activityArgv){console['log'](IIIl1I(0x15c,'o3zC'));return;}try{if(activityArgv[IIIl1I(0x131,'WSCg')](l1llII[IIIl1I(0x1b5,'YIrr')])){const {shopId:i11I1i,venderId:IillIl,vendorId:llliil}=common['parseUrlParameter'](activityArgv);$[IIIl1I(0x16a,'Q0D6')]=i11I1i,$[IIIl1I(0xe2,'R0tf')]=IillIl||llliil;}else{if(l1llII[IIIl1I(0x13f,'CpPS')](l1llII[IIIl1I(0xa6,'5r52')],l1llII[IIIl1I(0x13a,'pfKe')])){const liIl1=activityArgv[IIIl1I(0x1c0,'Dfbk')]('_');l1llII[IIIl1I(0xdf,'4%[A')](liIl1['length'],0x2)?($[IIIl1I(0x1b9,'&UUS')]=liIl1[0x0],$['venderId']=liIl1[0x1]):l1llII[IIIl1I(0x121,'unaq')](l1llII[IIIl1I(0x92,'@$J]')],l1llII['IojQt'])?(i1ll['shopId']=i1l1lI[0x0],i1iliI[IIIl1I(0x189,'$xm!')]=I1iIii[0x1]):$[IIIl1I(0xae,'h)$g')]=liIl1[0x0];}else{iIIII1[IIIl1I(0x149,'4%[A')](IIIl1I(0x13c,'l&VA'));return;}}}catch{if(l1llII[IIIl1I(0x185,'myJW')](l1llII[IIIl1I(0x1ac,'CT#2')],l1llII['OTPEF'])){console[IIIl1I(0x9c,'lYa2')](IIIl1I(0xca,'#M&S'));return;}else lI1Ili['log'](IIIl1I(0x145,'e3fX')+IliilI+IIIl1I(0x18e,'2YXv')+(i1II1[IIIl1I(0x198,'pP4w')]||iIIl11));}finally{if(l1llII['XIZMh']('STQsm',l1llII[IIIl1I(0x157,'@*DG')])){if(!$['venderId']){if(l1llII[IIIl1I(0x97,'Nnb0')](l1llII[IIIl1I(0x197,'[Too')],IIIl1I(0x170,'XbK1'))){IiilI1['log'](l1llII[IIIl1I(0x19a,'CpPS')]);return;}else{console[IIIl1I(0x149,'4%[A')](l1llII[IIIl1I(0x143,'h)$g')]);return;}}}else{IiilIi[IIIl1I(0xe0,'&It7')](l1llII[IIIl1I(0x159,'@$J]')]);return;}}const IilIll=await common[IIIl1I(0x133,'&wec')]({'venderId':$[IIIl1I(0x137,'cqT&')]}),{shopName:lI11Ii,shopId:Iiill}=IilIll?.[IIIl1I(0xb8,'YIrr')];if(!Iiill){if(l1llII['ohYwo'](l1llII[IIIl1I(0x1c7,'unaq')],l1llII[IIIl1I(0xb2,'pfKe')])){console['log'](l1llII[IIIl1I(0xe6,'myJW')]);return;}else I1i11i[IIIl1I(0x18b,'WSCg')]=!![],I1i11l[IIIl1I(0x124,'&UUS')]&&IIlil['message']['fix'](ilI1lI);}$['shopId']=Iiill,notify[IIIl1I(0x8d,'unaq')]({'title':$[IIIl1I(0xee,'5r52')]}),console[IIIl1I(0xe5,'QBG)')](IIIl1I(0x89,'CpPS')+(lI11Ii||l1llII[IIIl1I(0x161,'i8YV')])+IIIl1I(0x16f,'R0tf')+$[IIIl1I(0x11c,'JI8F')]+'&venderId='+$[IIIl1I(0x1d0,'QBG)')]);for(let IlI1Il=0x0;IlI1Il<cookiesArr[IIIl1I(0x15f,'YIrr')];IlI1Il++){$[IIIl1I(0x93,'&UUS')]=l1llII['fFLux'](IlI1Il,0x1),cookie=cookiesArr[IlI1Il],common[IIIl1I(0xfc,'!Vn$')](cookie),$[IIIl1I(0xb7,'e3fX')]=l1llII[IIIl1I(0x1c8,'o3zC')](decodeURIComponent,common['getCookieValue'](cookie,l1llII['LBlrH'])),$['UA']=common[IIIl1I(0x1b8,'@*DG')]($[IIIl1I(0x18f,'myJW')]),$[IIIl1I(0x135,'CT#2')]=notify[IIIl1I(0xde,'yjGJ')]($[IIIl1I(0xd1,'myJW')],$[IIIl1I(0xf3,'0j^o')]),$[IIIl1I(0x129,'2YXv')]='',$[IIIl1I(0x19f,'2NIn')]=l1llII[IIIl1I(0x14d,'XbK1')](l1llII[IIIl1I(0x10d,'i8YV')](l1llII[IIIl1I(0x19b,'l&VA')],Math['floor'](Math[IIIl1I(0x118,'WSCg')]()*l1llII['NOhor'](0x2710,0x1869f))),0x1869f),$['lng']=l1llII[IIIl1I(0x8b,'YIrr')](l1llII[IIIl1I(0xb3,'WSCg')],Math['floor'](Math[IIIl1I(0x1ab,'&It7')]()*l1llII['rNUlu'](0x2710,0x1869f)))+0x1869f,$['JEC']=common[IIIl1I(0xd8,'&UUS')]($[IIIl1I(0xe8,'lYa2')]),$[IIIl1I(0x13b,'lYa2')]=common[IIIl1I(0x15b,'&It7')](),console[IIIl1I(0x1a2,'pP4w')]('\x0a******开始【京东账号'+$['index']+'】'+($[IIIl1I(0xf6,'h)$g')]||$[IIIl1I(0x111,'y5B#')])+IIIl1I(0x196,'2YXv')),await Main(),common[IIIl1I(0x183,'cqT&')]();if($[IIIl1I(0x116,'CT#2')])break;await $[IIIl1I(0xbd,'sGRp')](0x3e8);}isNotify&&notify[IIIl1I(0x1af,'y5B#')]()&&(notify['updateContent'](notify['content']+(IIIl1I(0x187,'$0Vb')+l1llII[IIIl1I(0x12e,'o3zC')](lI11Ii,'未知店铺')+IIIl1I(0x13e,'w6^d')+$[IIIl1I(0x172,'WSCg')]+IIIl1I(0x1d3,'QBG)')+$[IIIl1I(0x1ca,'CpPS')])),await notify['push']());})()[IlIlll(0xf8,'unaq')](l1il1l=>$[IlIlll(0xf0,'!Vn$')](l1il1l))[IlIlll(0x9f,'WSCg')](()=>$[IlIlll(0x11b,'vPor')]());async function Main(){const iil1ii=IlIlll,liIil={'GwvSg':function(liIii,II1ll1){return liIii===II1ll1;},'qkqdV':iil1ii(0xb4,'myJW'),'WyDmJ':function(IlI1Ii,i11I1I){return IlI1Ii(i11I1I);},'dVjgW':'获取活动信息失败','QKOwJ':function(l1il1i,ll1){return l1il1i!==ll1;},'wsZyK':iil1ii(0x104,'[Too'),'ZwWOs':iil1ii(0xcb,'IN6k'),'GqOEy':'取关店铺失败','lUPne':function(iI1llI,llliii){return iI1llI(llliii);},'aMmWB':iil1ii(0xbf,'Y^tT'),'lrXaO':function(IllI11,l1llIi){return IllI11!==l1llIi;},'oHgkZ':iil1ii(0x14b,'E]V6')};$['skipRun']=![];const IllI1I=await common[iil1ii(0xbb,'pfKe')](cookie);if(!IllI1I&&liIil[iil1ii(0x18a,'RRFS')](typeof IllI1I,liIil[iil1ii(0xdd,'CT#2')])){console['log']('账号无效');return;}try{$[iil1ii(0xad,'&UUS')]='',$[iil1ii(0x88,'@$J]')]='',await liIil[iil1ii(0x103,'CT#2')](sendRequest,'getShopHomeActivityInfo');if(!$['activityInfo']){console['log'](liIil['dVjgW']),$['message'][iil1ii(0x144,'Dfbk')](liIil['dVjgW']);return;}$[iil1ii(0xc9,'WSCg')]=$[iil1ii(0x17e,'m!8P')]?.['activityId'];if(!$[iil1ii(0x1c3,'Nnb0')]){if(liIil[iil1ii(0x8e,'&It7')](liIil[iil1ii(0x154,'#M&S')],liIil['ZwWOs'])){console[iil1ii(0x10b,'&UUS')]('未查询到活动信息或已领取过奖励'),$[iil1ii(0x12a,'YIrr')][iil1ii(0xe7,'w6^d')](iil1ii(0x1c4,'0j^o'));return;}else IIli1['log'](II1liI),IlI1i1&&(llIll1[iil1ii(0xfe,'Q0D6')]=!![],Illl1l[iil1ii(0xce,'l&VA')]&&l1lIii['message'][iil1ii(0x113,'2YXv')](I11iI1));}if($[iil1ii(0x177,'Bvip')]['followed']){const i11I11=await common['followShop'](![],$[iil1ii(0x87,'lYa2')]);if(!i11I11&&liIil[iil1ii(0xcc,'@$J]')](typeof i11I11,liIil['qkqdV'])){console[iil1ii(0x122,'w6^d')](liIil['GqOEy']),$['message'][iil1ii(0xeb,'RRFS')](liIil[iil1ii(0xba,'e3fX')]);return;}}await liIil[iil1ii(0x181,'Nnb0')](sendRequest,liIil[iil1ii(0x1c6,'CT#2')]);}catch(l1llIl){if(liIil['lrXaO'](liIil[iil1ii(0xb9,'lYa2')],iil1ii(0x16c,'[Too'))){const ii1I1i=II1Ii[iil1ii(0x12b,'Bvip')]('_');ii1I1i['length']===0x2?(lI1Il1[iil1ii(0x12d,'CT#2')]=ii1I1i[0x0],lilIi1['venderId']=ii1I1i[0x1]):IiilII[iil1ii(0x9b,'yjGJ')]=ii1I1i[0x0];}else console[iil1ii(0x1d4,'E]V6')](iil1ii(0x1bc,'l&VA')+l1llIl);}}async function handleResponse(llI,llliI){const IlIlli=IlIlll,iI1li1={'StxbU':function(lllii1,liIli){return lllii1===liIli;},'axaNL':IlIlli(0xdc,'myJW'),'kYNoQ':IlIlli(0x16b,'unaq'),'jjdRo':IlIlli(0xfa,'$xm!'),'zScbF':IlIlli(0xc1,'!Vn$'),'YhMdT':'F10000','Ryjbu':'402','ZYmAL':IlIlli(0x9e,'myJW'),'AaYsS':IlIlli(0x1b0,'h)$g'),'OxPyC':IlIlli(0x1b3,'@*DG'),'zJmGv':'账号已黑','ULyxE':IlIlli(0x9d,'JI8F'),'joNHF':'未知活动状态，请查看日志','SxoOF':'GFkgM','xLILM':IlIlli(0x15a,'QBG)')};try{if(iI1li1[IlIlli(0x1d5,'4%[A')](iI1li1[IlIlli(0x1ae,'sGRp')],iI1li1['kYNoQ']))Ii1iII[IlIlli(0xd7,'[Too')]('参与活动成功，但奖品擦肩而过了~\x20('+l1i11I+')'),II11II['message'][IlIlli(0x1a4,'#M&S')](IlIlli(0x158,'lYa2'));else switch(llI){case IlIlli(0x125,'2NIn'):llliI['code']==='0'&&llliI[IlIlli(0x17d,'unaq')]&&llliI[IlIlli(0x1b4,'cqT&')]?$['activityInfo']=llliI[IlIlli(0xfb,'Dfbk')]:iI1li1[IlIlli(0xd9,'y5B#')](iI1li1[IlIlli(0x11e,'$xm!')],iI1li1[IlIlli(0xea,'RRFS')])?console[IlIlli(0x112,'XbK1')]('❓'+llI+'\x20'+JSON[IlIlli(0x1a0,'Y^tT')](llliI)):IlI1il['message']['fix'](IilliI);break;case iI1li1[IlIlli(0x1d6,'QBG)')]:if(iI1li1[IlIlli(0xd9,'y5B#')](llliI[IlIlli(0x12f,'&It7')],'0')&&llliI[IlIlli(0x11f,'JI8F')]&&llliI[IlIlli(0x168,'e3fX')]){const {followCode:iI1liI,followDesc:l1lIiI,giftCode:llliiI,giftDesc:IilIiI,alreadyReceivedGifts:i1i1I1}=llliI[IlIlli(0xb0,'XbK1')];switch(iI1liI){case iI1li1[IlIlli(0x99,'m!8P')]:switch(llliiI){case'200':for(const IlII1 of i1i1I1){let IiI11=[IlII1?.[IlIlli(0x8a,'&lY6')],IlII1?.['rearWord']][IlIlli(0x108,'sGRp')]('');switch(IlII1?.['prizeType']){case 0x1:case 0x2:case 0x3:IiI11=IlIlli(0xd0,'vPor')+IiI11,$['message']['insert'](IiI11+IlIlli(0xe1,'E]V6'));break;case 0x4:IiI11='🎉\x20'+IiI11+'\x20🐶',$[IlIlli(0xa5,'m!8P')]['insert'](IiI11+'🐶');break;case 0x6:IiI11=IlIlli(0x14e,'@*DG')+IiI11+IlIlli(0xf9,'pP4w'),$[IlIlli(0xaa,'2YXv')][IlIlli(0x142,'R0tf')](IiI11+IlIlli(0x192,'Nnb0'));break;default:$[IlIlli(0x169,'Y^tT')][IlIlli(0x11a,'4%[A')](IiI11);break;}console['log'](IiI11);}break;case iI1li1[IlIlli(0xc8,'i8YV')]:console[IlIlli(0x1cf,'mxPJ')](IilIiI);for(let lli of['抢完']){if(iI1li1['StxbU']('HoQmy',IlIlli(0xd2,'e3fX'))){if(IilIiI[IlIlli(0xd3,'o3zC')](lli)){if(iI1li1[IlIlli(0x155,'0j^o')]===iI1li1[IlIlli(0x8f,'5r52')])delete I1lliI[IlIlli(0x191,'4%[A')],delete llIllI['headers'][IlIlli(0x17c,'&lY6')];else{$['runEnd']=!![],$[IlIlli(0xce,'l&VA')][IlIlli(0xbe,'y5B#')](IilIiI);break;}}}else{const {shopId:llli1,venderId:iIli1i,vendorId:iI1lii}=II11Ii[IlIlli(0x1ce,'w6^d')](II11Il);IlI11[IlIlli(0xb5,'E]V6')]=llli1,iIIIIl[IlIlli(0x139,'RRFS')]=iIli1i||iI1lii;}}break;case iI1li1['OxPyC']:console[IlIlli(0x14a,'e3fX')](iI1li1['zJmGv']),$[IlIlli(0x178,'!Vn$')]['fix']('黑号');break;default:!i1i1I1?(console[IlIlli(0x13d,'CT#2')]('参与活动成功，但奖品擦肩而过了~\x20('+llliiI+')'),$['message']['fix'](iI1li1[IlIlli(0x1b1,'0j^o')])):(console['log'](llliI[IlIlli(0x1cd,'myJW')]),$[IlIlli(0xa8,'4%[A')][IlIlli(0x151,'vPor')]('未知奖品领取状态，请查看日志'));break;}break;case IlIlli(0x115,'e3fX'):console[IlIlli(0x149,'4%[A')](l1lIiI),$['message'][IlIlli(0x184,'Nnb0')](l1lIiI);break;default:console[IlIlli(0xd6,'h)$g')](IlIlli(0x102,'pfKe')),console[IlIlli(0x1d1,'2NIn')](JSON[IlIlli(0xb6,'y5B#')](llliI[IlIlli(0x162,'Bvip')])),$['message']['fix'](iI1li1[IlIlli(0xc4,'XbK1')]);}}else console[IlIlli(0x15d,'Nnb0')]('❓'+llI+'\x20'+JSON[IlIlli(0x165,'#M&S')](llliI));break;}}catch(IilIii){iI1li1['StxbU'](iI1li1[IlIlli(0x119,'&UUS')],iI1li1['xLILM'])?Ii1iIi['log']('❌\x20脚本运行遇到了错误\x0a'+iliIIl):console[IlIlli(0x98,'Bvip')](IlIlli(0xa1,'CT#2')+llI+IlIlli(0x147,'mxPJ')+(IilIii[IlIlli(0xab,'e3fX')]||IilIii));}}async function sendRequest(l1lIi1){const il1i1i=IlIlll,iIli1l={'uJsRL':il1i1i(0x1cc,'XbK1'),'XAgtv':'获取活动信息失败','UfHZy':il1i1i(0x10f,'Y^tT'),'AyvXc':'https://api.m.jd.com/client.action','zAWfO':il1i1i(0x10c,'Nnb0'),'sIFxJ':il1i1i(0x1aa,'pP4w'),'fCiYj':'getShopHomeActivityInfo','JXRvu':il1i1i(0xa3,'y5B#'),'CXAHU':il1i1i(0x18c,'JI8F'),'oAyih':il1i1i(0xb1,'2NIn'),'MRJmS':'gzip,\x20deflate,\x20br','uGAsj':il1i1i(0x109,'5r52'),'XXSlT':il1i1i(0x182,'l&VA'),'kwiIB':'cors','YKWcs':il1i1i(0xaf,'lYa2'),'YWCHQ':il1i1i(0x163,'&wec'),'XOFGf':function(IiI1l,illlII){return IiI1l===illlII;},'ZTHyV':'GET','eibjz':function(iIII11,IiI1i){return iIII11===IiI1i;},'EGGDS':'FvZiX','djkIO':il1i1i(0x164,'&lY6'),'tBSKt':function(llll1,lil11l){return llll1<lil11l;},'KurlB':'qAvXd','zcIdO':'MgUPU','vEAvG':function(i1i1Il,I1lIl1){return i1i1Il>I1lIl1;},'FpYaG':function(lil11i,IlIIl){return lil11i>=IlIIl;},'moqYz':il1i1i(0x150,'i8YV'),'eGzpu':il1i1i(0x1a3,'o3zC'),'oKGrH':function(lI1liI,i1i1Ii){return lI1liI===i1i1Ii;},'AoQVJ':il1i1i(0xa7,'@$J]')};if($[il1i1i(0x132,'Bvip')]||$['outFlag'])return;let i1i1II='',liiIIl=null,iil1iI=null,IlIllI=iIli1l[il1i1i(0xa2,'sGRp')],il1i1I={};switch(l1lIi1){case'getShopHomeActivityInfo':i1i1II=iIli1l[il1i1i(0x106,'pP4w')],il1i1I={'shopId':''[il1i1i(0x148,'#M&S')]($[il1i1i(0x146,'R0tf')]||''),'source':iIli1l[il1i1i(0x173,'&UUS')],'displayWidth':iIli1l['sIFxJ'],'sourceRpc':il1i1i(0x188,'cqT&'),'lng':$[il1i1i(0x1c1,'[Too')],'lat':$[il1i1i(0x12c,'sGRp')],'venderId':''[il1i1i(0x19e,'@*DG')]($['venderId']||'')},iil1iI={'functionId':il1i1i(0x1b2,'R0tf')},liiIIl=common[il1i1i(0x138,'R0tf')](await common[il1i1i(0xec,'2NIn')](iIli1l[il1i1i(0xd4,'sGRp')],il1i1I));break;case iIli1l[il1i1i(0x176,'unaq')]:i1i1II=iIli1l[il1i1i(0x141,'!Vn$')],il1i1I={'follow':0x0,'shopId':''['concat']($[il1i1i(0xe4,'RRFS')]||''),'activityId':''[il1i1i(0x8c,'cqT&')]($[il1i1i(0xc3,'4%[A')]||''),'sourceRpc':iIli1l[il1i1i(0x1d2,'mxPJ')],'venderId':''[il1i1i(0x186,'IN6k')]($[il1i1i(0xc7,'y5B#')]||'')},iil1iI={'functionId':iIli1l[il1i1i(0x134,'!Vn$')]},liiIIl=common['queryStringToObject'](await common[il1i1i(0x107,'XbK1')](iIli1l[il1i1i(0xe3,'@*DG')],il1i1I));break;default:console[il1i1i(0x180,'$0Vb')](il1i1i(0xcf,'sGRp')+l1lIi1);return;}const lI1li1={'url':i1i1II,'method':IlIllI,'headers':{'Accept':iIli1l[il1i1i(0x179,'2NIn')],'Accept-Encoding':iIli1l['MRJmS'],'Accept-Language':iIli1l[il1i1i(0x94,'myJW')],'Connection':il1i1i(0x160,'vPor'),'Content-Type':iIli1l['XXSlT'],'Cookie':cookie,'J-E-H':$[il1i1i(0x9a,'[Too')],'J-E-C':$[il1i1i(0x1bf,'!Vn$')],'Sec-Fetch-Dest':il1i1i(0x195,'$0Vb'),'Sec-Fetch-Mode':iIli1l[il1i1i(0x105,'w6^d')],'Sec-Fetch-Site':il1i1i(0x1a6,'mxPJ'),'User-Agent':$['UA'],'x-referer-package':iIli1l[il1i1i(0x1c9,'Q0D6')],'x-rp-client':iIli1l['YWCHQ']},'params':iil1iI,'data':liiIIl,'timeout':0x7530};iIli1l[il1i1i(0x1a9,'Bvip')](IlIllI,iIli1l[il1i1i(0x17a,'&lY6')])&&(iIli1l[il1i1i(0x1ba,'0j^o')](iIli1l[il1i1i(0x90,'2NIn')],iIli1l[il1i1i(0xef,'R0tf')])?i1IIl[il1i1i(0xc6,'sGRp')]('❓'+I1lll1+'\x20'+i1IIi[il1i1i(0xac,'$0Vb')](IIII1I)):(delete lI1li1[il1i1i(0x1a7,'&wec')],delete lI1li1[il1i1i(0x114,'l&VA')]['Content-Type']));const iI11II=0x1;let iIII1I=0x0,ilil1i=null,IlIIi=![];while(iIli1l[il1i1i(0xf2,'$xm!')](iIII1I,iI11II)){if(iIli1l[il1i1i(0x126,'e3fX')]===iIli1l[il1i1i(0x96,'2NIn')])lilIl1[il1i1i(0xbc,'RRFS')](i1l1ii[il1i1i(0x193,'RRFS')],iIli1l['uJsRL']),i1l1[il1i1i(0x11d,'lYa2')](0x1);else{iIli1l['vEAvG'](iIII1I,0x0)&&await $[il1i1i(0x85,'unaq')](0x3e8);const iIII1l=await common[il1i1i(0x10a,'RRFS')](lI1li1);if(!iIII1l['success']){ilil1i=il1i1i(0x18d,'R0tf')+l1lIi1+'\x20请求失败\x20➜\x20'+iIII1l[il1i1i(0x140,'e3fX')],iIII1I++;continue;}if(!iIII1l[il1i1i(0xc5,'$0Vb')]){ilil1i=il1i1i(0x1b7,'mxPJ')+l1lIi1+il1i1i(0x1bd,'2YXv'),iIII1I++;continue;}await handleResponse(l1lIi1,iIII1l[il1i1i(0x1a7,'&wec')]),IlIIi=![];break;}}if(iIli1l[il1i1i(0x117,'R0tf')](iIII1I,iI11II)){if(iIli1l['eibjz'](iIli1l[il1i1i(0x1bb,'$0Vb')],iIli1l[il1i1i(0x1ad,'pfKe')]))l1i111[il1i1i(0x180,'$0Vb')]('❓'+iliII1+'\x20'+II11I1[il1i1i(0x17f,'vPor')](Iii11I));else{console['log'](ilil1i);if(IlIIi){$['outFlag']=!![];if($['message']){if(iIli1l[il1i1i(0x136,'i8YV')]('CVRTI',iIli1l[il1i1i(0x123,'Bvip')]))$[il1i1i(0xe9,'vPor')][il1i1i(0x174,'unaq')](ilil1i);else{li1I1['log'](iIli1l[il1i1i(0x1b6,'unaq')]),i1ilil[il1i1i(0x175,'o3zC')]['fix'](iIli1l[il1i1i(0x95,'2YXv')]);return;}}}}}}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
